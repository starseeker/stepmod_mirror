<?xml version="1.0" encoding="utf-8"?>
    <!--
      This file has been auto generated by:
      ant -buildfile buildscript.xml
      
      Usage:
      ant -buildfile script.xml checks
      Generates the HTML for the modules listed in ballot_index.xml
      Errors are reported an stored in 
      stepmod/analysis_ant_check_[yyyymmdd].txt-->
<project name="ballotchecks" default="all" basedir="../../..">
      
   <target name="init">
      <tstamp/>
      <property name="BALLOTNAME" value="analysis"/>
      <dirname property="BALLOTDIR" file="ballots\ballots\${BALLOTNAME}\ballot_index.xml"/>
      <property name="MODULESDIR" value="data/modules/"/>
      <property name="RESDIR" value="data/resource_docs/"/>
      <property name="UTILSDIR" value="utils"/>
      <property name="CHECKDIR" value="${BALLOTDIR}\check_${BALLOTNAME}_${DSTAMP}"/>
      <property name="ANTERR" value="${CHECKDIR}\ant_check_${BALLOTNAME}_${DSTAMP}.txt"/>
      <property name="EXPRESSCOMP" value="C:/apps/eep/Eep.exe"/>
      <property name="EXPRESSARG1" value="-2"/>
      <property name="EXPRESSARG2" value="-i"/>
      <property name="EXPRESSARG3" value="-w"/>
      <property name="EXPRESSARG4" value=""/>
      <property name="EXPRESSDIR" value="${CHECKDIR}\express"/>
      <property name="ARMEXPRESSFILE" value="arm_${DSTAMP}v1.exp"/>
      <property name="ARMEXPRESS" value="${EXPRESSDIR}\${ARMEXPRESSFILE}"/>
      <property name="ARMERRFILE" value="arm_${DSTAMP}v1_err.txt"/>
      <property name="ARMERR" value="${EXPRESSDIR}\${ARMERRFILE}"/>
      <property name="MIMEXPRESSFILE" value="mim_resources_${DSTAMP}v1.exp"/>
      <property name="MIMEXPRESS" value="${EXPRESSDIR}\${MIMEXPRESSFILE}"/>
      <property name="MIMERRFILE" value="mim_resources_${DSTAMP}v1_err.txt"/>
      <property name="MIMERR" value="${EXPRESSDIR}\${MIMERRFILE}"/>
      <property name="RESEXPRESSFILE" value="resources_${DSTAMP}v1.exp"/>
      <property name="RESEXPRESS" value="${EXPRESSDIR}\${RESEXPRESSFILE}"/>
      <property name="RESERRFILE" value="resources_${DSTAMP}v1_err.txt"/>
      <property name="RESERR" value="${EXPRESSDIR}\${RESERRFILE}"/>
      <property name="ZIPFILE" value="${CHECKDIR}\check_${DSTAMP}.zip"/>
      <mkdir dir="${CHECKDIR}"/>
   </target>
      
   <target name="checks" depends="init">
      <echo>
	  Outputting to: ${ANTERR}
	</echo>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}analysis"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}analysis_shape"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}analysis_product_relationships"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}cfd_conditions"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}cfd_equations"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}cfd_model"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}cfd_results"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}cfd_specified_general_property"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}fea_definition_relationships"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}finite_element_analysis"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}mesh_connectivity"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}mesh_function"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}mesh_topology"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}non_manifold_surface"/>
      </ant>
      <ant dir="${UTILSDIR}" output="${ANTERR}">
         <target name="clean_module"/>
         <target name="modules"/>
         <target name="mapping"/>
         <target name="valid_modules"/>
         <property name="MODULES" value="../${MODULESDIR}product_analysis"/>
      </ant>
      <fixcrlf srcdir="${CHECKDIR}" includes="**/*.txt"/>
   </target>
   <target name="getexpress" depends="init">
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./getExpressIr.wsf"/>
         <arg value="${EXPRESSDIR}"/>
         <arg value="${BALLOTDIR}/modlist.txt"/>
         <arg value="${BALLOTDIR}/irlist.txt"/>
      </exec>
   </target>
   <target name="checkmodule" depends="init">
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="analysis"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="analysis_shape"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="analysis_product_relationships"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="cfd_conditions"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="cfd_equations"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="cfd_model"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="cfd_results"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="cfd_specified_general_property"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="fea_definition_relationships"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="finite_element_analysis"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="mesh_connectivity"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="mesh_function"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="mesh_topology"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="non_manifold_surface"/>
      </exec>
      <exec executable="cscript" failifexecutionfails="false" dir="${UTILSDIR}" output="${ANTERR}" append="true">
         <arg value="./checkModule.wsf"/>
         <arg value="product_analysis"/>
      </exec>
   </target>
   <target name="compileexpress" depends="getexpress">
      <echo>Compiling EXPRESS: ${ARMEXPRESS}</echo>
      <exec executable="${EXPRESSCOMP}" dir="${EXPRESSDIR}" output="${ARMERR}">
         <arg value="${EXPRESSARG1}"/>
         <arg value="${EXPRESSARG2}"/>
         <arg value="${EXPRESSARG3}"/>
         <arg value="${EXPRESSARG4}"/>
         <arg value="${ARMEXPRESS}"/>
      </exec>
      <copy verbose="true" overwrite="true" file="${ARMEXPRESS}" todir="${CHECKDIR}"/>
    
      <echo>Compiling EXPRESS: ${MIMEXPRESS}</echo>
      <exec executable="${EXPRESSCOMP}" dir="${EXPRESSDIR}" output="${MIMERR}">
         <arg value="${EXPRESSARG1}"/>
         <arg value="${EXPRESSARG2}"/>
         <arg value="${EXPRESSARG3}"/>
         <arg value="${EXPRESSARG4}"/>
         <arg value="${MIMEXPRESS}"/>
      </exec>
      <copy verbose="true" overwrite="true" file="${MIMEXPRESS}" todir="${CHECKDIR}"/>
    
      <fixcrlf srcdir="${CHECKDIR}" includes="*.txt, **/*.exp"/>
   </target>
      
   <target name="zip" depends="init">
      <echo>Zipping: ${ZIPFILE}</echo>
      <zip zipfile="${ZIPFILE}" basedir="${CHECKDIR}" excludes="**/*.zip, express/**" includes="ant_check*.txt, arm*.*, mim_resources*.*"/>
   </target>
      
   <target name="all" depends="checks, checkmodule, compileexpress, zip"/>
      
</project>