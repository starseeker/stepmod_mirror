(*
   $Id: arm.exp,v 1.21 2004/12/17 14:44:46 liutkus Exp $
   ISO TC184/SC4/WG12 N - ISO/CD-TS 10303-xxxx Ap210 electronic assembly interconnect and packaging design - EXPRESS ARM
*)

SCHEMA Ap210_electronic_assembly_interconnect_and_packaging_design_arm;

USE FROM Ap210_device_functional_and_physical_characterization_arm;
USE FROM Ap210_interconnect_technology_constraints_arm;
USE FROM Ap210_assembly_technology_constraints_arm;
USE FROM Ap210_assembly_functional_requirements_arm;
USE FROM Ap210_assembly_physical_requirements_arm;
USE FROM Ap210_interconnect_functional_requirements_arm;
USE FROM Ap210_interconnect_physical_requirements_arm;
USE FROM Ap210_assembly_physical_design_arm;
USE FROM Ap210_interconnect_design_arm;
USE FROM Ap210_interconnect_design_for_microwave_arm;
USE FROM Ap210_product_rule_arm;
USE FROM Ap210_functional_decomposition_arm;
USE FROM Ap210_geometric_dimensioning_and_tolerancing_arm;
USE FROM Ap210_package_functional_and_physical_characterization_arm;
USE FROM Ap210_laminate_assembly_design_arm;
USE FROM Ap210_connection_zone_based_model_extraction_arm;
USE FROM Ap210_functional_specification_arm;
USE FROM Ap210_physical_unit_physical_characterization_arm;
USE FROM Ap210_packaged_part_white_box_model_arm;
USE FROM Ap210_printed_part_functional_and_physical_characterization_arm;
USE FROM Ap210_assembly_functional_interface_requirements_arm;
USE FROM Ap210_assembly_physical_interface_requirements_arm;
USE FROM Ap210_assembly_requirement_allocation_arm;
USE FROM Ap210_interconnect_requirement_allocation_arm;
USE FROM Ap210_functional_requirement_allocation_arm;

USE FROM Datum_difference_based_model_arm; -- ????


(** Need a CC having both Assembly_2d_shape and Interconnect_2d_shape_arm *)
SUBTYPE_CONSTRAINT component_2d_location_subtypes FOR component_2d_location;         
    ONEOF (component_2d_edge_location,
 component_2d_embedded_location,
 component_2d_stacked_location,
 component_2d_surface_location);    
END_SUBTYPE_CONSTRAINT;

(** Design_specific_assignment_to_assembly_usage_view_arm, 
Design_specific_assignment_to_interconnect_usage_view_arm  and
Assembly_module_macro_definition_arm needs to be brought together for this *)  
SUBTYPE_CONSTRAINT component_feature_to_physical_usage_view_assignment_subtypes FOR component_feature_to_physical_usage_view_assignment;     
ONEOF (component_terminal_to_assembly_module_join_terminal_assignment,
 component_terminal_to_assembly_module_interface_terminal_assignment,
 component_terminal_to_interconnect_module_join_terminal_assignment,
 component_terminal_to_interconnect_module_interface_terminal_assignment,
 component_terminal_to_pca_terminal_assignment);
END_SUBTYPE_CONSTRAINT;

(** Subtypes are totally mixed and appear in various schemas - most likely this constraint will remain in some CC *)
SUBTYPE_CONSTRAINT geometric_representation_relationship_subtypes FOR Geometric_model_relationship;     
(ONEOF (non_feature_shape_composition_relationship, -- Non_feature_shape_element_arm
 reference_geometric_representation_relationship, -- layered_2d_shape
 component_part_2d_geometric_representation_relationship, -- Physical_unit_2d_design_view_arm
 component_part_2d_non_planar_geometric_representation_relationship, -- Interconnect_non_planar_shape_arm
 component_part_3d_geometric_representation_relationship, -- Physical_unit_3d_design_view_arm
 shape_definition_3d_intersection, -- layered_3d_shape
 shape_definition_3d_plane_projection -- layered_3d_shape
 ));    
END_SUBTYPE_CONSTRAINT;

(** Since this includes both pca and pca - I guess it will be it top most schema *)
SUBTYPE_CONSTRAINT part_terminal_subtypes FOR part_terminal; 
ONEOF (minimally_defined_bare_die_terminal, -- *pca*
 assembly_module_terminal, -- *pca*
 cable_terminal, -- *pca*
 interconnect_module_terminal, -- *PCB*
 packaged_part_terminal); -- *pca*
END_SUBTYPE_CONSTRAINT;

(** It most likely should be in TOP AP210 schema *)
SUBTYPE_CONSTRAINT part_design_view_subtypes FOR part_design_view;  
    ONEOF (assembly_module,
 interconnect_module);
END_SUBTYPE_CONSTRAINT;

TYPE ap210_managed_design_object = EXTENSIBLE GENERIC_ENTITY SELECT BASED_ON managed_design_object WITH 
(adjacent_stratum_surface_definition,
 adjacent_stratum_surface_embedded_component_surface_definition,
 alias_identification,
 alternate_product_relationship,
 analytical_model_definition,
 analytical_model_make_from_relationship,
 analytical_model_port,
 analytical_model_port_assignment,
 analytical_model_application,
 assembly_bond_definition,
 assembly_component,
 assembly_component_placement_link,
 assembly_component_relationship,
 assembly_item_number,
 assembly_joint,
 bond_assembly_position,
 boundary_size_characteristic,
 bus_element_link,
 bus_structural_definition,
 geometric_coordinate_space,
 certification,
 representation_item,
 component_2d_location,
 component_3d_location,
 component_external_reference,
 component_feature,
 component_feature_external_reference,
 component_feature_make_from_relationship,
 component_feature_relationship,
 component_feature_to_layout_feature_relationship,
 component_feature_to_physical_usage_view_assignment,
 component_group_assignment,
 component_make_from_relationship,
 component_mounting_clearance_relationship,
 component_non_planar_location,
 component_overlap_relationship,
 component_placement_restriction_assignment,
 component_to_physical_usage_view_assignment,
 composite_curve_segment,
 composite_signal_property_relationship,
 conductive_interconnect_element_terminal_link,
 configuration_controlled_message,
 conical_tolerance_zone_boundary_and_surface_relationship,
 conical_tolerance_zone_boundary_diametrical_size_characteristic,
 connection_zone,
 connectivity_allocation,
 connectivity_allocation_to_physical_network,
 connection_zone_bare_die_interface_plane_relationship,
 connection_zone_package_interface_plane_relationship,
 connection_zone_map_identification,
 coordinated_characteristic,
 curve_style,
 curve_style_font,
 curve_style_font_and_scaling,
 value_with_unit,
 calendar_date,
 date_time,
 datum_axis_and_tolerance_zone_orienting_relationship,
 datum_axis_related_orientation,
 datum_based_direction_vector,
 datum_based_length_measure,
 datum_based_vector_orientation,
 datum_difference_functional_unit_usage_view_terminal_assignment,
 single_datum, 
 datum, 
 datum_target_usage_in_datum_target_set_relationship,
 design_composition_path,
 design_functional_unit_allocation_to_assembly_component,
 design_functional_unit_allocation_to_assembly_joint,
 design_functional_unit_allocation_to_fabrication_joint,
 design_functional_unit_allocation_to_reference_functional_unit,
 design_intent_modification,
 design_intent_modification_sequence,
 design_intent_modification_3d_position,
 design_intent_modification_planar_position,
 design_intent_modification_styled_area_representation,
 assembly_connection_zone_position_relationship,
 interconnect_connection_zone_position_relationship,
 design_view_terminal_component_shape_relationship,
 device_2d_position,
 device_3d_position,
 device_terminal_map,
 device_terminal_map_relationship,
 geometric_dimension, 
 dimensional_characteristic_representation,
 dimension_qualifier,
 dimension_set,
 direct_stratum_component_join_implementation,
 direction,
 direction_element,
 approval,
 document_definition,
 material_identification,
 product,
 product_category,
 product_category_hierarchy,
 product_configuration,
 product_view_definition,
 product_concept,
 product_specific_parameter_value_assignment,
 product_version,
 Requirement_definition_property,
 text_representation_item,
 view_definition_relationship,
 equivalent_functional_terminals_assignment,
 equivalent_functional_unit_definition_assignment,
 evaluated_characteristic,
 externally_defined_curve_font,
 externally_defined_hatch_style,
 externally_defined_tile,
 externally_defined_tile_style,
 external_item_identification,
 fabrication_joint,
 fill_area,
 fill_area_occurrence,
 fill_area_style,
 fill_area_style_hatching,
 fill_area_style_tile,
 fill_area_style_tile_curve_with_style,
 fill_area_style_tile_solid_region,
 fill_area_style_tile_symbol_with_style,
 font_definition,
 frozen_assignment,
 functional_specification,
 functional_terminal_group,
 functional_terminal_group_assignment,
 functional_unit,
 functional_unit_network_node_definition,
 functional_unit_network_terminal_definition_bus_assignment,
 functional_unit_network_terminal_definition_node_assignment,
 functional_unit_terminal,
 functional_unit_terminal_bus_assignment,
 functional_unit_terminal_node_assignment,
 functional_unit_usage_view_terminal_definition,
 functional_usage_view_to_part_terminal_assignment,
 functional_usage_view_to_printed_part_template_terminal_assignment,
 geometric_tolerance,
 geometric_tolerance_qualifier,
 interconnect_module_product_assembly_view_fabrication_joint,
 interconnect_module_stratum_assembly_relationship,
 interface_component_allocation,
 interface_mounted_join,
 internal_stratum_access,
 inter_stratum_extent,
 inter_stratum_join_implementation,
 join_relationship,
 junction_vertex_allocation,
 Laminate_layer,
 layer_connection_point,
 layout_junction,
 layout_spacing_requirement_non_conforming_design_object,
 line_width_class,
 linear_array_placement_group_component_link,
 located_interconnect_module_thickness_requirement,
 marking,
 mating_connector_component,
 mating_connector_placement_relationship,
 mating_connector_termination,
 model_parameter,
 independent_property_relationship, 
 next_higher_assembly_interface_requirement,
 operational_requirement_occurrence_relationship,
 organization,
 package_external_reference,
 package_terminal_external_reference,
 package_terminal_occurrence,
 packaged_connector_terminal_relationship,
 parameter_assignment,
 parameter_assignment_override,
 part_connected_terminals_definition,
 part_device,
 part_device_terminal,
 part_terminal_external_reference,
 part_template_or_physical_unit_2d_shape_representation_relationship,
 part_template_or_physical_unit_3d_shape_representation_relationship,
 passage_technology,
 person,
 person_in_organization,
 physical_connectivity_abstraction_map,
 physical_connectivity_definition,
 physical_connectivity_definition_relationship,
 physical_connectivity_element,
 physical_connectivity_make_from_relationship,
 connector_based_interconnect_definition,
 Generic_physical_network,
 physical_node_requirement_to_implementing_component_allocation,
 part_definition_relationship,
 pitch_class,
 placement_group,
 placement_group_area_assignment,
 planned_characteristic,
 effectivity,
 analog_port_variable,
 positional_boundary_and_profile_boundary_member_relationship,
 positional_boundary_definition,
 positional_boundary_member_definition,
 positional_boundary_offset,
 printed_connector_template_terminal_relationship,
 printed_part_template_connected_terminals_definition,
 printed_part_template_material,
 printed_part_template_material_link,
 printed_part_template_terminal_relationship,
 product_version_relationship,
 projected_zone_and_base_relationship,
 projected_zone_height_characteristic,
 promissory_usage,
 reference_composition_path,
 reference_functional_unit_assignment_to_part,
 registered_font,
 requirement_assignment,
 requirement_collection_relationship,
 restraint_condition,
 rule_action,
 rule_complex_clause,
 rule_conclusion_definition,
 rule_function,
 rule_justification,
 rule_premise_definition,
 rule_priority,
 rule_simple_clause,
 runout_tolerance_zone_orienting_relationship,
 runout_zone_orientation,
 security_classification,
 scalar_terminal_definition_link,
 separate_geometric_tolerance_requirement,
 geometric_model,
 shape_dimension_representation,
 shape_element,
 shape_element_locating_relationship,
 shape_element_relationship,
 detailed_geometric_model_element,
 signal,
 signal_property,
 signal_specification,
 simultaneous_geometric_tolerance_requirement,
 solid_curve,
 solid_fill_style,
 specification_allocation,
 stratum_concept_relationship,
 stratum_concept_to_physical_usage_view_assignment,
 stratum_feature_in_stratum_3d_position,
 stratum_feature_in_stratum_planar_position,
 stratum_feature_shape_stratum_average_surface_shape_relationship,
 stratum_feature_shape_stratum_surface_shape_relationship,
 stratum_feature_styled_area_representation,
 stratum_interconnect_module_3d_position,
 stratum_interconnect_module_planar_position,
 stratum_average_surface,
 stratum_surface,
 stratum_surface_in_stratum_3d_position,
 stratum_technology,
 stratum_technology_link,
 structured_text,
 structured_text_id_in_document,
 styled_curve_occurrence,
 assembly_relationship_substitution,
 component_upper_level_identification,
 sub_model_placement_2d,
 sub_model_placement_3d,
 supplied_part_relationship,
 technology,
 terminal_pair_port_equivalence_relationship,
 termination_constraint,
 thermal_isolation_requirement,
 tolerance_zone_and_viewing_plane_orienting_relationship,
 tolerance_zone_definition,
 tolerance_zone_boundary_member_offset,
 tolerance_zone_definition,
 tolerance_zone_form,
 tolerance_zone_per_unit_size_specification,
 topological_junction,
 transmission_line_functional_unit_terminal_allocation,
 true_profile,
 usage_concept_usage_relationship,
 usage_view_connection_zone_terminal_shape_relationship,
 vector,
 viewing_plane_based_orientation,
 viewing_plane_definition,
 work_order,
 work_request,
 organization_or_person_in_organization_assignment
);
  END_TYPE; -- ap210_managed_design_object



------------------------------


---------------------------------------------------

  FUNCTION bag_to_set(
    the_bag : BAG OF GENERIC : intype
  ) : SET OF GENERIC : intype;

    LOCAL
      the_set : SET OF GENERIC : intype := [];
      i       : INTEGER;
    END_LOCAL;

    IF SIZEOF(the_bag) > 0 THEN
      REPEAT i := 1 TO HIINDEX(the_bag);
        the_set := the_set + the_bag[i];
      END_REPEAT;
    END_IF;
    RETURN(the_set);
  END_FUNCTION; -- bag_to_set


END_SCHEMA;
