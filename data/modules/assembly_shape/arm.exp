(*
   $Id: arm.exp,v 1.1 2012/08/27 22:23:46 lothartklein Exp $
   N - ISO/CD-TS - 10303- assembly_shape - EXPRESS ARM
*)

SCHEMA Assembly_shape_arm;

USE FROM Item_definition_structure_arm;  --        ISO/TS 10303-1345
USE FROM Part_shape_arm; 

TYPE characterized_product_definition = SELECT (
    Product_view_definition, 
    View_definition_relationship,
    Multi_level_reference_designator);
END_TYPE;

TYPE internal_or_reflected_shape_element = SELECT (
    Shape_element,
    reflected_shape_element_id);
END_TYPE;

TYPE reflected_shape_element_id = identifier;
END_TYPE;

TYPE multi_or_next_assembly_usage_occurrence = SELECT (
    Multi_level_reference_designator,
    Next_assembly_usage_occurrence);
END_TYPE;

ENTITY Assembly_shape
  SUBTYPE OF (Part_shape);
  SELF\Item_shape.described_element : Assembly_definition;
END_ENTITY;  

ENTITY Component_path_shape_element
    SUBTYPE OF (Shape_element);
    location : multi_or_next_assembly_usage_occurrence;
    component_shape_element : internal_or_reflected_shape_element;
  UNIQUE
    UR1 : location, component_shape_element;
  WHERE
    WR1: NOT('ASSEMBLY_STRUCTURE_ARM.NEXT_ASSEMBLY_USAGE_OCCURRENCE' IN TYPEOF(location)) OR
      EXISTS(location\Assembly_component_relationship.location_indicator); 
END_ENTITY;

ENTITY Multi_level_reference_designator;
  name : OPTIONAL label;
  description : OPTIONAL text; 
  location : LIST[1:?] OF UNIQUE Next_assembly_usage_occurrence;
DERIVE
  root_node : Product_view_definition := location[1]\View_definition_relationship.relating_view;
UNIQUE
  UR1 : location;
END_ENTITY;

ENTITY Part_occurrence_shape
  SUBTYPE OF (Item_shape);
  SELF\Item_shape.described_element : Definition_based_product_occurrence;
END_ENTITY;  

END_SCHEMA;
