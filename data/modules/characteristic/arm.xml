<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express description.file="arm_descriptions.xml" language_version="2" rcs.date="$Date$" rcs.revision="$Revision$" reference="ISO/TS 10303-1654">
   <application name="JSDAI" owner="LKSoft" source="characteristic_arm schema_instance" url="www.lksoft.com" version="4.0 beta"/>
   <schema name="Characteristic_arm">
      <interface kind="use" schema="Basic_data_representation_arm"/>
      <interface kind="use" schema="Document_assignment_arm"/>
      <interface kind="use" schema="Extended_measure_representation_arm"/>
      <interface kind="use" schema="External_library_arm"/>
      <interface kind="use" schema="Value_with_unit_extension_arm"/>
      <interface kind="use" schema="External_properties_arm"/>
      <interface kind="use" schema="Property_assignment_arm"/>
      <interface kind="reference" schema="Support_resource_arm">
         <interfaced.item name="bag_to_set"/>
      </interface>
      <interface kind="reference" schema="Qualified_measure_arm">
         <interfaced.item name="pre_defined_type_qualifiers"/>
      </interface>
      <type name="c_documented_element_select">
         <select basedon="documented_element_select" extensible="YES" genericentity="YES" selectitems="Property_value_representation"/>
      </type>
      <type name="characteristic">
         <select extensible="NO" genericentity="NO" selectitems="String_representation_item Numerical_item_with_unit Value_list Value_set"/>
      </type>
      <type name="characteristic_data_table_cell">
         <select extensible="NO" genericentity="NO" selectitems="Null_representation_item String_representation_item Numerical_item_with_global_unit Numerical_item_with_unit Value_list Value_set"/>
      </type>
      <type name="range_class">
         <enumeration extensible="NO" items="closed lower_open upper_open open"/>
      </type>
      <type name="scalar_or_coordinated_characteristics">
         <select extensible="NO" genericentity="NO" selectitems="Property_value_representation characteristic"/>
      </type>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Characteristic_data_column_header" supertypes="Independent_property">
         <inverse attribute="related" entity="Characteristic_data_table_header_decomposition" name="table_header_usage"/>
      <where label="IP1"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Characteristic_data_column_header_link" supertypes="Independent_property_relationship">
         <explicit name="precedent" optional="NO">
            <typename name="Characteristic_data_column_header"/>
            <redeclaration entity-ref="Independent_property_relationship" old_name="relating"/>
         </explicit>
         <explicit name="subsequent" optional="NO">
            <typename name="Characteristic_data_column_header"/>
            <redeclaration entity-ref="Independent_property_relationship" old_name="related"/>
         </explicit>
         <derived expression="'sequence'" name="relation_type">
            <builtintype fixed="NO" type="STRING"/>
            <redeclaration entity-ref="Independent_property_relationship"/>
         </derived>
         <unique label="UR1">
            <unique.attribute attribute="precedent"/>
            <unique.attribute attribute="subsequent"/>
         </unique>
         <where expression="subsequent &lt;&gt; precedent" label="WR1"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Characteristic_data_table" supertypes="Representation_item">
         <explicit name="property_value" optional="NO">
            <aggregate lower="1" optional="NO" type="LIST" unique="NO" upper="?"/>
            <typename name="Characteristic_data_table_row"/>
         </explicit>
         <where expression="SIZEOF(QUERY( pv &lt;* property_value |&#10;                  NOT (SIZEOF(pv.cell) = SIZEOF(property_value[1].cell))&#10;                  )) = 0" label="WR1"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Characteristic_data_table_header" supertypes="Independent_property">
         <inverse attribute="relating" entity="Characteristic_data_table_header_decomposition" name="column">
            <inverse.aggregate lower="2" type="SET" upper="?"/>
         </inverse>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Characteristic_data_table_header_decomposition" supertypes="Independent_property_relationship">
         <explicit name="relating" optional="NO">
            <typename name="Characteristic_data_table_header"/>
            <redeclaration entity-ref="Independent_property_relationship"/>
         </explicit>
         <explicit name="related" optional="NO">
            <typename name="Characteristic_data_column_header"/>
            <redeclaration entity-ref="Independent_property_relationship"/>
         </explicit>
         <derived expression="'decomposition'" name="relation_type">
            <builtintype fixed="NO" type="STRING"/>
            <redeclaration entity-ref="Independent_property_relationship"/>
         </derived>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Characteristic_data_table_header_usage" supertypes="Property_definition_representation">
         <explicit name="definition" optional="NO">
            <typename name="Characteristic_data_table_header"/>
            <redeclaration entity-ref="Property_definition_representation"/>
         </explicit>
         <explicit name="used_representation" optional="NO">
            <typename name="Characteristic_data_table_representation"/>
            <redeclaration entity-ref="Property_definition_representation"/>
         </explicit>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Characteristic_data_table_representation" supertypes="Property_value_representation">
         <explicit name="items" optional="NO">
            <aggregate lower="1" optional="NO" type="SET" unique="NO" upper="1"/>
            <typename name="Characteristic_data_table"/>
            <redeclaration entity-ref="Representation"/>
         </explicit>
         <inverse attribute="used_representation" entity="Characteristic_data_table_header_usage" name="header"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Characteristic_data_table_row" supertypes="Representation_item">
         <explicit name="cell" optional="NO">
            <aggregate lower="1" optional="NO" type="LIST" unique="NO" upper="?"/>
            <typename name="characteristic_data_table_cell"/>
         </explicit>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Correlated_property" supertypes="Assigned_property">
         <explicit name="correlated_properties" optional="NO">
            <aggregate lower="1" optional="NO" type="SET" unique="NO" upper="?"/>
            <typename name="Assigned_property"/>
         </explicit>
         <where expression="SIZEOF(QUERY(cp &lt;* correlated_properties | cp\Assigned_property.described_element &lt;&gt; SELF\Assigned_property.described_element)) = 0" label="WR1"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Externally_defined_type_qualifier" supertypes="Type_qualifier">
         <explicit name="external_source" optional="NO">
            <typename name="External_source"/>
         </explicit>
         <where expression="NOT(name IN pre_defined_type_qualifiers)" label="WR1"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Length_tolerance_characteristic" supertypes="Tolerance_characteristic">
         <where expression="('CHARACTERISTIC_ARM.STATISTICAL_TOLERANCE_CHARACTERISTIC' IN TYPEOF(SELF)) OR&#10;            ('CHARACTERISTIC_ARM.SYMMETRICAL_TOLERANCE_CHARACTERISTIC' IN TYPEOF(SELF)) OR&#10;            ('CHARACTERISTIC_ARM.PLUS_MINUS_TOLERANCE_CHARACTERISTIC' IN TYPEOF(SELF)) OR&#10;        (SIZEOF(QUERY(it &lt;* SELF\Representation.items |&#10;          NOT('VALUE_WITH_UNIT_EXTENSION_ARM.LENGTH_DATA_ELEMENT' IN TYPEOF(it))&#10;         )) = 0)" label="WR1"/>
         <where expression="NOT('CHARACTERISTIC_ARM.SYMMETRICAL_TOLERANCE_CHARACTERISTIC' IN TYPEOF(SELF)) OR&#10;        (SIZEOF(QUERY(it &lt;* SELF\Representation.items |&#10;        ('VALUE_WITH_UNIT_EXTENSION_ARM.LENGTH_DATA_ELEMENT' IN TYPEOF(it))&#10;           )) = 1)" label="WR2"/>
         <where expression="NOT('CHARACTERISTIC_ARM.STATISTICAL_TOLERANCE_CHARACTERISTIC' IN TYPEOF(SELF)) OR&#10;        (SIZEOF(QUERY(it &lt;* SELF\Representation.items |&#10;        ('VALUE_WITH_UNIT_EXTENSION_ARM.LENGTH_DATA_ELEMENT' IN TYPEOF(it))&#10;           )) = 1)" label="WR3"/>
         <where expression="NOT EXISTS(SELF\Representation.description)" label="WR4"/>
         <where expression="NOT('CHARACTERISTIC_ARM.PLUS_MINUS_TOLERANCE_CHARACTERISTIC' IN TYPEOF(SELF)) OR&#10;        (SIZEOF(QUERY(it &lt;* SELF\Representation.items |&#10;          NOT(('EXTENDED_MEASURE_REPRESENTATION_ARM.VALUE_WITH_TOLERANCES' IN TYPEOF(it)) AND&#10;             ('VALUE_WITH_UNIT_EXTENSION_ARM.LENGTH_DATA_ELEMENT' IN TYPEOF(it\Value_with_tolerances.item_value)))&#10;         )) = 0)" label="WR5"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Maximum_tolerance_characteristic" supertypes="Tolerance_characteristic">
         <explicit name="items" optional="NO">
            <aggregate lower="1" optional="NO" type="SET" unique="NO" upper="1"/>
            <typename name="Value_limit"/>
            <redeclaration entity-ref="Representation"/>
         </explicit>
         <where expression="SELF\Representation.items[1]\Value_limit.qualifiers[1]\Type_qualifier.name = 'maximum'" label="WR1"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Minimum_tolerance_characteristic" supertypes="Tolerance_characteristic">
         <explicit name="items" optional="NO">
            <aggregate lower="1" optional="NO" type="SET" unique="NO" upper="1"/>
            <typename name="Value_limit"/>
            <redeclaration entity-ref="Representation"/>
         </explicit>
         <where expression="SELF\Representation.items[1]\Value_limit.qualifiers[1]\Type_qualifier.name = 'minimum'" label="WR1"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Nominal_tolerance_characteristic" supertypes="Tolerance_characteristic">
         <explicit name="items" optional="NO">
            <aggregate lower="1" optional="NO" type="SET" unique="NO" upper="1"/>
            <typename name="Qualified_numerical_item_with_unit"/>
            <redeclaration entity-ref="Representation"/>
         </explicit>
         <where expression="SELF\Representation.items[1]\Qualified_representation_item.qualifiers[1]\Type_qualifier.name = 'nominal'" label="WR1"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Null_representation_item" supertypes="Representation_item"/>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Plus_minus_tolerance_characteristic" supertypes="Tolerance_characteristic">
         <explicit name="items" optional="NO">
            <aggregate lower="1" optional="NO" type="SET" unique="NO" upper="1"/>
            <typename name="Value_with_tolerances"/>
            <redeclaration entity-ref="Representation"/>
         </explicit>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Qualified_tolerance_characteristic" supertypes="Tolerance_characteristic">
         <explicit name="items" optional="NO">
            <aggregate lower="1" optional="NO" type="SET" unique="NO" upper="4"/>
            <typename name="Qualified_numerical_item_with_unit"/>
            <redeclaration entity-ref="Representation"/>
         </explicit>
         <where expression="valid_qualified_tolerance_characteristic(SELF)" label="WR1"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Range_characteristic" supertypes="Property_value_representation">
         <explicit name="items" optional="NO">
            <aggregate lower="2" optional="NO" type="SET" unique="NO" upper="2"/>
            <typename name="Numerical_item_with_unit"/>
            <redeclaration entity-ref="Representation"/>
         </explicit>
         <explicit name="range_type" optional="NO">
            <typename name="range_class"/>
         </explicit>
         <where expression="TYPEOF(SELF\Representation.items[1]) =&#10;          TYPEOF(SELF\Representation.items[2])" label="WR1"/>
         <where expression="TYPEOF(SELF\Representation.items[1]\Value_with_unit.unit) =&#10;          TYPEOF(SELF\Representation.items[2]\Value_with_unit.unit)" label="WR2"/>
         <where expression="valid_range(SELF\Representation.items[1],&#10;                      SELF\Representation.items[2])" label="WR3"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Statistical_tolerance_characteristic" supertypes="Tolerance_characteristic">
         <explicit name="items" optional="NO">
            <aggregate lower="2" optional="NO" type="SET" unique="NO" upper="?"/>
            <typename name="Numerical_item_with_unit"/>
            <redeclaration entity-ref="Representation"/>
         </explicit>
      <where label="IP1"/>
         <where label="IP2"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Symmetrical_tolerance_characteristic" supertypes="Tolerance_characteristic">
         <explicit name="items" optional="NO">
            <aggregate lower="2" optional="NO" type="SET" unique="NO" upper="2"/>
            <typename name="Numerical_item_with_unit"/>
            <redeclaration entity-ref="Representation"/>
         </explicit>
         <where expression="SIZEOF(QUERY( ri &lt;* &#10;         SELF\representation.items |&#10;        'VALUE_WITH_UNIT_EXTENSION_ARM.RATIO_DATA_ELEMENT' IN TYPEOF(ri))) = 1" label="WR1"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Text_representation_item" supertypes="String_representation_item"/>
      <entity abstract.entity="NO" abstract.supertype="YES" name="Tolerance_characteristic" super.expression="ONEOF (Maximum_tolerance_characteristic, Minimum_tolerance_characteristic, Nominal_tolerance_characteristic, Plus_minus_tolerance_characteristic, Qualified_tolerance_characteristic, Statistical_tolerance_characteristic, Symmetrical_tolerance_characteristic, Typical_tolerance_characteristic) ANDOR Length_tolerance_characteristic" supertypes="Property_value_representation">
         <where expression="SELF\Representation.context_of_items\Representation_context.id = 'tolerance values'" label="WR1"/>
         <where expression="NOT EXISTS(SELF\Representation.name)" label="WR2"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Typical_tolerance_characteristic" supertypes="Tolerance_characteristic">
         <explicit name="items" optional="NO">
            <aggregate lower="1" optional="NO" type="SET" unique="NO" upper="1"/>
            <typename name="Value_limit"/>
            <redeclaration entity-ref="Representation"/>
         </explicit>
         <where expression="SELF\Representation.items[1]\Value_limit.qualifiers[1]\Type_qualifier.name = 'typical'" label="WR1"/>
      </entity>
      <subtype.constraint abstract.supertype="NO" entity="Property_value_representation" name="exclusive_property_value_representation_characteristic" super.expression="ONEOF (Range_characteristic, Tolerance_characteristic)"/>
      <subtype.constraint abstract.supertype="NO" entity="Type_qualifier" name="type_qualifier_subtypes" super.expression="ONEOF (Externally_defined_type_qualifier, Pre_defined_type_qualifier)"/>
      <subtype.constraint abstract.supertype="NO" entity="Independent_property" name="independent_property_subtypes" super.expression="ONEOF (Characteristic_data_table_header, Characteristic_data_column_header)"/>
      <subtype.constraint abstract.supertype="NO" entity="Representation_item" name="c_representation_item_subtypes" super.expression="ONEOF (Characteristic_data_table, Characteristic_data_table_row)"/>
      <function name="valid_qualified_tolerance_characteristic">
         <parameter name="input">
            <typename name="Qualified_tolerance_characteristic"/>
         </parameter>
         <builtintype fixed="NO" type="BOOLEAN"/>
         <algorithm>LOCAL
     bag_data : BAG OF STRING := [];
     valid_set : SET OF STRING := ['nominal', 'typical' , 'maximium', 'minimum'];
  END_LOCAL;
  REPEAT i := 1 TO SIZEOF(input\Qualified_tolerance_characteristic.items);
    REPEAT j := 1 TO SIZEOF(input\Qualified_tolerance_characteristic.items[i]\Qualified_representation_item.qualifiers);
     IF 'QUALIFIED_MEASURE_ARM.TYPE_QUALIFIER' IN TYPEOF(input\Qualified_tolerance_characteristic.items[i]\Qualified_representation_item.qualifiers[j])
      THEN
        bag_data := bag_data + input\Qualified_tolerance_characteristic.items[i]\Qualified_representation_item.qualifiers[j]\Type_qualifier.name;
     END_IF;
    END_REPEAT;
  END_REPEAT;

  IF (SIZEOF(bag_to_set(bag_data)) = SIZEOF(bag_data)) AND
     (VALUE_UNIQUE(bag_data)) AND 
     (SIZEOF(valid_set * bag_data) = SIZEOF(bag_data)) 
  THEN RETURN(TRUE);
  END_IF;
    
   RETURN(FALSE);</algorithm>
      </function>
      <function name="valid_range">
         <parameter name="input1">
            <typename name="Numerical_item_with_unit"/>
         </parameter>
         <parameter name="input2">
            <typename name="Numerical_item_with_unit"/>
         </parameter>
         <builtintype fixed="NO" type="BOOLEAN"/>
         <algorithm>RETURN(TRUE);</algorithm>
      </function>
   </schema>
</express>
