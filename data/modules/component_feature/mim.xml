<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express language_version="2" rcs.date="2005-02-23T18:05:48" rcs.revision="1.0" description.file="mim_descriptions.xml">
   <application name="JSDAI" owner="LKSoft" url="www.lksoft.com" version="4.0 beta" source="component_feature_mim schema_instance"/>
   <schema name="Component_feature_mim">
      <interface kind="use" schema="Interface_component_mim"/>
      <interface kind="use" schema="Physical_unit_design_view_mim"/>
      <interface kind="use" schema="Shape_property_assignment_mim"/>
      <entity name="component_feature" supertypes="shape_aspect">
         <where label="WR1" expression="'COMPONENT_FEATURE_MIM.' +&#10;       'COMPONENT_DEFINITION' IN&#10;       TYPEOF (SELF.of_shape.definition)"/>
         <where label="WR2" expression="SIZEOF (QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'instantiated feature')) &lt;= 1"/>
      </entity>
      <entity name="component_feature_relationship" supertypes="shape_aspect shape_aspect_relationship">
         <where label="WR1" expression="SELF\shape_aspect_relationship.related_shape_aspect :&lt;&gt;:&#10;       SELF\shape_aspect_relationship.relating_shape_aspect"/>
         <where label="WR4" expression="SIZEOF(TYPEOF(SELF) - TYPEOF(SELF\shape_aspect ||&#10;       SELF\shape_aspect_relationship ||&#10;       SELF\component_feature_relationship)) = 0"/>
         <where label="WR5" expression="SELF\shape_aspect.name = ''"/>
         <where label="WR6" expression="SELF\shape_aspect_relationship.name = ''"/>
      </entity>
      <entity name="component_terminal" supertypes="component_feature">
         <where label="WR1" expression="(SELF\shape_aspect.description IN &#10;      ['assembly module component terminal', &#10;       'bare die component terminal', &#10;       'component termination passage join terminal', &#10;       'conductive interconnect element terminal', &#10;       'interconnect component join terminal', &#10;       'interconnect module component terminal', 'land join terminal', &#10;       'minimally defined component terminal',&#10;       'non functional land join terminal', &#10;       'packaged component join terminal', &#10;       'printed component join terminal', 'package terminal occurrence',&#10;       'via terminal']) OR&#10;        ('COMPONENT_FEATURE_MIM.' +&#10;       'ASSEMBLY_MODULE_MACRO_COMPONENT_JOIN_TERMINAL' IN&#10;       TYPEOF  (SELF)) OR&#10;        ('COMPONENT_FEATURE_MIM.' +&#10;       'INTERCONNECT_MODULE_MACRO_COMPONENT_JOIN_TERMINAL' IN&#10;       TYPEOF  (SELF))"/>
         <where label="WR2" expression="'COMPONENT_FEATURE_MIM.' +&#10;       'COMPONENT_DEFINITION' IN&#10;       TYPEOF  (SELF.of_shape.definition)"/>
         <where label="WR3" expression="SIZEOF (QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'instantiated feature')) &lt;= 1"/>
         <where label="WR4" expression="SIZEOF (QUERY (at &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'associated terminals') |&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PHYSICAL_CONNECTIVITY_DEFINITION' IN&#10;       TYPEOF (at.relating_shape_aspect))) &lt;= 1"/>
         <where label="WR5" expression="SIZEOF (QUERY (cr &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'connectivity requirement') |&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PHYSICAL_NETWORK' IN&#10;       TYPEOF (cr.relating_shape_aspect))) &lt;= 1"/>
         <where label="WR6" expression="SIZEOF (QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'design usage')) &lt;= 1"/>
         <where label="WR7" expression="(NOT (SELF\shape_aspect.description IN &#10;       ['assembly module component terminal', &#10;       'bare die component terminal', 'package terminal occurrence', &#10;       'packaged component join terminal', &#10;       'printed component join terminal'])) OR&#10;       (SELF.product_definitional)"/>
         <where label="WR8" expression="(NOT (SELF\shape_aspect.description = &#10;       'assembly module component terminal')) OR&#10;       ((SELF.of_shape.definition.frame_of_reference.name =&#10;       'physical occurrence') AND&#10;       (EXISTS(SELF.of_shape.definition\product_definition.name)) AND&#10;       (NOT(EXISTS(SELF.of_shape.definition\product_definition.name)) OR&#10;       (SELF.of_shape.definition\product_definition.name =&#10;       'assembly module'))&#10;       )"/>
         <where label="WR9" expression="(NOT (SELF\shape_aspect.description = &#10;       'assembly module component terminal')) OR&#10;       (SIZEOF (QUERY (i_f &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'instantiated feature') |&#10;       ('COMPONENT_FEATURE_MIM.' +&#10;       'ASSEMBLY_MODULE_TERMINAL' IN&#10;       TYPEOF (i_f.relating_shape_aspect)))) = 1)"/>
         <where label="WR10" expression="(NOT (SELF\shape_aspect.description = &#10;       'bare die component terminal')) OR&#10;       (SELF.of_shape.definition\product_definition.description = &#10;       'bare die component')"/>
         <where label="WR11" expression="(NOT (SELF\shape_aspect.description = &#10;       'bare die component terminal')) OR&#10;       (SIZEOF (QUERY (i_f &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'instantiated feature') |&#10;       ('COMPONENT_FEATURE_MIM.' +&#10;       'BARE_DIE_TERMINAL' IN&#10;       TYPEOF (i_f.relating_shape_aspect)))) = 1)"/>
         <where label="WR13" expression="(NOT (SELF\shape_aspect.description = &#10;       'component termination passage join terminal')) OR&#10;       (SIZEOF (QUERY (i_f &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'instantiated feature') |&#10;       i_f.relating_shape_aspect\shape_aspect.description =&#10;       'component termination passage template join terminal')) = 1)"/>
         <where label="WR15" expression="(NOT (SELF\shape_aspect.description IN&#10;       ['conductive interconnect element terminal',&#10;       'interconnect component join terminal',&#10;       'printed component join terminal'])) OR&#10;       (SIZEOF (QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT') |&#10;       sar.related_shape_aspect\shape_aspect.description =&#10;       'connection zone')) &lt;= 1)"/>
         <where label="WR16" expression="(NOT (SELF\shape_aspect.description =&#10;       'interconnect module component terminal')) OR&#10;   ((SELF.of_shape.definition\product_definition.frame_of_reference.name =&#10;       'physical occurrence') AND&#10;       (EXISTS(SELF.of_shape.definition\product_definition.name)) AND&#10;       (NOT(EXISTS(SELF.of_shape.definition\product_definition.name)) OR&#10;       (SELF.of_shape.definition\product_definition.name =&#10;       'interconnect module'))&#10;       )"/>
         <where label="WR17" expression="(NOT (SELF\shape_aspect.description =&#10;       'interconnect module component terminal')) OR&#10;       (SIZEOF (QUERY (i_f &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'instantiated feature') |&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'INTERCONNECT_MODULE_TERMINAL' IN&#10;       TYPEOF (i_f.relating_shape_aspect)&#10;       )) = 1)"/>
         <where label="WR18" expression="(NOT (SELF\shape_aspect.description IN&#10;       ['land join terminal', 'non functional land join terminal'])) OR&#10;       (SIZEOF (QUERY (i_f &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'instantiated feature') |&#10;       (('COMPONENT_FEATURE_MIM.' +&#10;       'LAND_TEMPLATE_TERMINAL' IN&#10;       TYPEOF (i_f.relating_shape_aspect)) AND&#10;       (TRUE)))) = 1)"/>
         <where label="WR20" expression="(NOT (SELF\shape_aspect.description = &#10;       'minimally defined terminal')) OR&#10;       (SIZEOF (QUERY (pdr&lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |&#10;       pdr.used_representation\representation.name = &#10;       'part terminal external reference')) = 1)"/>
         <where label="WR22" expression="(NOT (SELF\shape_aspect.description = &#10;       'package terminal occurrence')) OR&#10;       (SIZEOF (QUERY (ud &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'usage definition') |&#10;       ('COMPONENT_FEATURE_MIM.' +&#10;       'PACKAGE_TERMINAL' IN&#10;       TYPEOF (ud.relating_shape_aspect)))) = 1)"/>
         <where label="WR23" expression="(NOT (SELF\shape_aspect.description IN &#10;       ['package terminal occurrence',&#10;       'packaged component join terminal'])) OR&#10;       (('COMPONENT_FEATURE_MIM.' +&#10;       'PACKAGED_COMPONENT' IN&#10;       TYPEOF (SELF.of_shape.definition)) AND&#10;       (SELF.of_shape.definition\product_definition.&#10;        frame_of_reference.name = &#10;       'physical occurrence'))"/>
         <where label="WR24" expression="(NOT (SELF\shape_aspect.description = &#10;       'packaged component join terminal')) OR&#10;       (SIZEOF (QUERY (i_f &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'instantiated feature') |&#10;       ('COMPONENT_FEATURE_MIM.' +&#10;       'PACKAGED_PART_TERMINAL' IN&#10;       TYPEOF (i_f.relating_shape_aspect)) AND&#10;       (i_f.relating_shape_aspect\shape_aspect.description =&#10;       'join terminal'))) = 1)"/>
         <where label="WR25" expression="(NOT (SELF\shape_aspect.description = &#10;       'packaged component join terminal')) OR&#10;       (SIZEOF (QUERY (pd &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION.DEFINITION') |&#10;       SIZEOF (QUERY (pdr &lt;* USEDIN (pd,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |&#10;       SIZEOF (QUERY (it &lt;* pdr.used_representation.items |&#10;       SIZEOF (&#10;       ['COMPONENT_FEATURE_MIM.' +&#10;       'MEASURE_REPRESENTATION_ITEM',&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'LENGTH_MEASURE_WITH_UNIT'] *&#10;       TYPEOF (it)) = 2)) &lt;= 2)) &lt;= 1)) &lt;= 1)"/>
         <where label="WR26" expression="(NOT (SELF\shape_aspect.description = &#10;       'packaged component join terminal')) OR&#10;       (SIZEOF (QUERY (pd &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION.DEFINITION') |&#10;       SIZEOF (QUERY (pdr &lt;* USEDIN (pd,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |&#10;       SIZEOF (QUERY (lmwu &lt;* QUERY (it &lt;* pdr.used_representation.items |&#10;       SIZEOF (&#10;       ['COMPONENT_FEATURE_MIM.' +&#10;       'MEASURE_REPRESENTATION_ITEM',&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'LENGTH_MEASURE_WITH_UNIT'] *&#10;       TYPEOF (it)) = 2) |&#10;       lmwu\representation_item.name = 'maximum wire length')) &lt;= 1)) &lt;= 1)) &lt;= 1)"/>
         <where label="WR27" expression="(NOT (SELF\shape_aspect.description = &#10;       'packaged component join terminal')) OR&#10;       (SIZEOF (QUERY (pd &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION.DEFINITION') |&#10;       SIZEOF (QUERY (pdr &lt;* USEDIN (pd,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |&#10;       SIZEOF (QUERY (lmwu &lt;* QUERY (it &lt;* pdr.used_representation.items |&#10;       SIZEOF (&#10;       ['COMPONENT_FEATURE_MIM.' +&#10;       'MEASURE_REPRESENTATION_ITEM',&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'LENGTH_MEASURE_WITH_UNIT'] *&#10;       TYPEOF (it)) = 2) |&#10;       lmwu\representation_item.name = 'minimum wire length')) &lt;= 1)) &lt;= 1)) &lt;= 1)"/>
         <where label="WR28" expression="(NOT (SELF\shape_aspect.description = &#10;       'printed component join terminal')) OR&#10;       ((SELF.of_shape.definition\product_definition.&#10;       frame_of_reference.name =&#10;       'layout occurrence') AND&#10;       (SELF.of_shape.definition\product_definition.&#10;       name = 'interconnect module')&#10;       )"/>
         <where label="WR29" expression="(NOT (SELF\shape_aspect.description = &#10;       'printed component join terminal')) OR&#10;       (SIZEOF (QUERY (i_f &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'instantiated feature') |&#10;       ('COMPONENT_FEATURE_MIM.' +&#10;       'PRINTED_PART_TEMPLATE_TERMINAL' IN&#10;       TYPEOF (i_f.relating_shape_aspect)) AND&#10;       (i_f.relating_shape_aspect\shape_aspect.description =&#10;       'join terminal'))) = 1)"/>
         <where label="WR32" expression="(NOT (SELF\shape_aspect.description = 'via terminal')) OR&#10;       (SIZEOF (QUERY (i_f &lt;* QUERY (sar &lt;* USEDIN (SELF,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT') |&#10;       sar\shape_aspect_relationship.name = 'instantiated feature') |&#10;       i_f.relating_shape_aspect\shape_aspect.description =&#10;       'via template terminal')) = 1)"/>
         <where label="WR33" expression="(NOT (SELF\shape_aspect.description =&#10;       'interconnect component join terminal')) OR&#10;       ((SELF.of_shape.definition\product_definition.&#10;       frame_of_reference.name =&#10;       'physical occurrence') AND&#10;       NOT(SELF.of_shape.definition\product_definition.description &#10;       IN ['assembly module component', 'bare die component', &#10;       'interconnect module component', 'laminate component',&#10;       'packaged component']))"/>
         <where label="WR34" expression="SIZEOF(QUERY(pd &lt;* USEDIN(SELF, &#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION.DEFINITION') | SIZEOF(QUERY(pdr &lt;* USEDIN(pd,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | &#10;       SIZEOF(QUERY(dri &lt;* pdr.used_representation.items |&#10;       (dri\representation_item.name = 'global swappable') AND &#10;       (dri\descriptive_representation_item.description IN ['true', 'false']))) = 1)) = 1)) &lt;= 1"/>
         <where label="WR35" expression="SIZEOF(QUERY(pd &lt;* USEDIN(SELF, &#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION.DEFINITION') | SIZEOF(QUERY(pdr &lt;* USEDIN(pd,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | &#10;       SIZEOF(QUERY(dri &lt;* pdr.used_representation.items |&#10;       (dri\representation_item.name = 'local swappable') AND &#10;       (dri\descriptive_representation_item.description IN ['true', 'false']))) = 1)) = 1)) &lt;= 1"/>
         <where label="WR36" expression="SIZEOF(QUERY(pd &lt;* USEDIN(SELF, &#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION.DEFINITION') | SIZEOF(QUERY(pdr &lt;* USEDIN(pd,&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | &#10;       SIZEOF(QUERY(dri &lt;* pdr.used_representation.items | dri\representation_item.name = &#10;       'swap code'&#10;       )) = 1)) = 1)) &lt;= 1"/>
      </entity>
      <entity name="make_from_feature_relationship" supertypes="component_feature_relationship">
         <where label="WR1" expression="SIZEOF (['COMPONENT_FEATURE_MIM.' +&#10;       'COMPONENT_TERMINAL',&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PHYSICAL_COMPONENT_INTERFACE_TERMINAL'] *&#10;       TYPEOF (SELF.relating_shape_aspect)) = 1"/>
         <where label="WR2" expression="SIZEOF (['COMPONENT_FEATURE_MIM.' +&#10;       'COMPONENT_TERMINAL',&#10;       'COMPONENT_FEATURE_MIM.' +&#10;       'PHYSICAL_COMPONENT_INTERFACE_TERMINAL'] *&#10;       TYPEOF (SELF.related_shape_aspect)) = 1"/>
      </entity>
      <rule name="component_feature_unique_constraint" appliesto="component_terminal physical_component_interface_terminal">
         <algorithm>LOCAL
  ct : BAG OF shape_aspect := 
     QUERY( ct &lt;* component_terminal | (ct\shape_aspect.description IN 
['assembly module component terminal',
'bare die component terminal',
'interconnect component join terminal',
'interconnect module component terminal',
'interconnect module component stratum based terminal',
'minimally defined component terminal',
'packaged component join terminal']) );
  cit : BAG OF shape_aspect := 
         QUERY( cit &lt;* physical_component_interface_terminal | (
cit\shape_aspect.description IN ['interconnect component interface terminal',
'packaged connector component interface terminal']) );
  cf : BAG OF shape_aspect;
  cd_bag : BAG OF component_definition := [];
  sa_bag : BAG OF shape_aspect;
  sar_bag : BAG OF shape_aspect_relationship;
  pass : BOOLEAN := TRUE;
  def_bag : BAG OF shape_aspect;
END_LOCAL;

cf := ct + cit;
REPEAT i := 1 to SIZEOF(cf) by 1;
  IF EXISTS( cf[i].of_shape.definition ) THEN
    IF ( 'COMPONENT_FEATURE_MIM.' +
'COMPONENT_DEFINITION' IN TYPEOF(cf[i].of_shape.definition) ) THEN
      IF ( NOT ( cf[i].of_shape.definition IN cd_bag )) THEN
        cd_bag := cd_bag + cf[i].of_shape.definition;
      END_IF;
    END_IF;
  END_IF;
END_REPEAT;

REPEAT i := 1 to SIZEOF(cd_bag) by 1;
  IF ( NOT pass ) THEN ESCAPE;
  END_IF;
  def_bag := [];
  sa_bag := QUERY( sa &lt;* cf | (sa.of_shape.definition :=: cd_bag[i]) );
  REPEAT j := 1 to SIZEOF(sa_bag) by 1;
    IF ( NOT pass ) THEN ESCAPE;
    END_IF;
    sar_bag := QUERY( sar &lt;* USEDIN( sa_bag[j],
'COMPONENT_FEATURE_MIM.' +
'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT' ) | 
             (sar\shape_aspect_relationship.name = 'instantiated feature') );
    REPEAT k := 1 to SIZEOF(sar_bag) by 1;
      IF EXISTS( sar_bag[k].relating_shape_aspect ) THEN
        IF ( sar_bag[k].relating_shape_aspect IN def_bag ) THEN
          pass := FALSE;
          ESCAPE;
        ELSE
          def_bag := def_bag + sar_bag[k].relating_shape_aspect;
        END_IF;
      END_IF;
    END_REPEAT;
  END_REPEAT;
END_REPEAT;</algorithm>
         <where label="WR1" expression="pass"/>
      </rule>
   </schema>
</express>
