<?xml version="1.0"?>
<!-- $Id: arm.xml,v 1.16 2002/07/12 07:29:09 goset1 Exp $ -->
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">
<express
  language_version="2"
  description.file="arm_descriptions.xml"
  rcs.date="$Date: 2002/07/12 07:29:09 $"
  rcs.revision="$Revision: 1.16 $">

  <application
    name="express2xml.js"
    owner="Eurostep Limited"
    url="http://www.eurostep.com"
    version="1.17"
    source="../data/modules/document_properties/arm.exp"/>

  <schema name="Document_properties_arm">
    <interface
      kind="use"
      schema="Document_definition_arm">
    </interface>

    <interface
      kind="use"
      schema="File_identification_arm">
    </interface>

    <interface
      kind="use"
      schema="Foundation_representation_arm">
    </interface>

    <interface
      kind="use"
      schema="Measure_representation_arm">
    </interface>

    <interface
      kind="use"
      schema="Property_assignment_arm">
    </interface>

    <type name="document_property_item">
      <select
        basedon="property_assignment_select"
        selectitems="Document_definition File">
      </select>

    </type>
    <type name="descriptive_or_numerical">
      <select
        selectitems="Descriptive_document_property Numerical_document_property">
      </select>

    </type>
    <entity
      name="Assigned_document_property"
      supertypes="Assigned_property">
      <derived
        name="SELF\Assigned_property.name"
        expression="'document property'">
        <builtintype
          type="STRING"/>
      </derived>
      <unique
        label="UR1">
        <unique.attribute
          entity-ref="Assigned_property"
          attribute="described_element"/>
      </unique>
      <where
        label="WR1"
        expression="SIZEOF(['DOCUMENT_PROPERTIES_ARM.DOCUMENT_DEFINITION', 'DOCUMENT_PROPERTIES_ARM.FILE']*TYPEOF(SELF\Assigned_property.described_element)) = 1">
      </where>
    </entity>

    <entity
      name="Document_property_representation"
      supertypes="Representation">
      <explicit
        name="items">
        <redeclaration
          entity-ref="Representation"/>
          <aggregate
            type="SET"
            lower="1"
            upper="?"/>
          <typename
            name="descriptive_or_numerical"/>
        </explicit>
        <where
          label="WR1"
          expression="SIZEOF(QUERY( pr &lt;* USEDIN(SELF, 'DOCUMENT_PROPERTIES_ARM.PROPERTY_REPRESENTATION.REP') |    'DOCUMENT_PROPERTIES_ARM.ASSIGNED_PROPERTY' IN TYPEOF(pr.property)))&gt; 0">
        </where>
        <where
          label="WR2"
          expression="SELF\Representation.context_of_items.kind = 'document parameters'">
        </where>
        <where
          label="WR3"
          expression="valid_document_property_representation(SELF)">
        </where>
        <where
          label="WR4"
          expression="SIZEOF(QUERY(it1 &lt;* SELF\Representation.items | 	SIZEOF(QUERY(it2 &lt;* SELF\Representation.items | it1.name = it2.name)) &gt; 1	))= 0">
        </where>
      </entity>

      <entity
        name="Descriptive_document_property"
        supertypes="String_representation_item">
        <inverse
          name="valued_characteristic"
          entity="Document_property_representation"
          attribute="items">
          <inverse.aggregate
            type="SET"
            lower="1"
            upper="1"/>
        </inverse>
      </entity>

      <entity
        name="Numerical_document_property"
        supertypes="Numerical_item_with_unit">
        <inverse
          name="valued_characteristic"
          entity="Document_property_representation"
          attribute="items">
          <inverse.aggregate
            type="SET"
            lower="1"
            upper="1"/>
        </inverse>
      </entity>

      <function
        name="valid_document_property_representation">
        <parameter
          name="rep">
          <typename
            name="Document_property_representation"/>
        </parameter>
        <builtintype
          type="LOGICAL"/>
        <algorithm>

CASE rep.name OF
'document content': 
   BEGIN
RETURN (
  SIZEOF(QUERY( items &lt;* rep\Representation.items | 
  NOT (items.name IN ['detail level', 'geometry type', 'real world scale'])))= 0
 );
   END;

'document creation': 
   BEGIN
IF NOT (SIZEOF(QUERY( items &lt;* rep\Representation.items | 
  NOT (items.name IN ['creating interface', 'creating system', 'operating system'])))= 0
 ) THEN
  RETURN(FALSE);
END_IF;
IF NOT (SIZEOF(QUERY( items &lt;* rep\Representation.items | 
  NOT (items.name IN ['creating system'])))= 1
 ) THEN
  RETURN(FALSE);
ELSE
  RETURN(TRUE);
END_IF;

   END;

'document format': 
   BEGIN
RETURN (
  SIZEOF(QUERY( items &lt;* rep\Representation.items | 
  NOT (items.name IN ['character code', 'data format', 'size format', 'size format standard'])))= 0
 );
   END;

'document size': 
   BEGIN
RETURN (
  SIZEOF(QUERY( items &lt;* rep\Representation.items | 
  NOT (items.name IN ['file size', 'page count'])))= 0
 );
   END;

OTHERWISE:
  RETURN(UNKNOWN);
END_CASE;
        </algorithm>

      </function>

    </schema>

  </express>
