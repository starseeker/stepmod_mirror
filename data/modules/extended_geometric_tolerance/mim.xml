<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express language_version="2" rcs.date="2005-03-30T15:55:29" rcs.revision="1.0" description.file="mim_descriptions.xml">
   <application name="JSDAI" owner="LKSoft" url="www.lksoft.com" version="4.0 beta" source="extended_geometric_tolerance_mim schema_instance"/>
   <schema name="EXTENDED_GEOMETRIC_TOLERANCE_MIM">
      <interface kind="use" schema="DEFAULT_TOLERANCE_MIM"/>
      <interface kind="use" schema="DIMENSION_TOLERANCE_MIM"/>
      <interface kind="use" schema="GEOMETRIC_TOLERANCE_MIM"/>
      <interface kind="use" schema="LAYERED_3D_SHAPE_MIM"/>
      <interface kind="use" schema="NON_FEATURE_SHAPE_ELEMENT_MIM"/>
      <interface kind="use" schema="REQUIREMENT_DECOMPOSITION_MIM"/>
      <interface kind="use" schema="SHAPE_COMPOSITION_MIM"/>
      <interface kind="use" schema="SHAPE_PARAMETERS_MIM"/>
      <interface kind="use" schema="SHAPE_PROPERTY_ASSIGNMENT_MIM"/>
      <interface kind="use" schema="VALUE_WITH_UNIT_EXTENSION_MIM"/>
      <interface kind="use" schema="APPLICATION_CONTEXT_SCHEMA">
         <interfaced.item name="application_context_element"/>
      </interface>
      <interface kind="use" schema="MATERIAL_PROPERTY_DEFINITION_SCHEMA">
         <interfaced.item name="property_definition_relationship"/>
      </interface>
      <interface kind="use" schema="SHAPE_TOLERANCE_SCHEMA">
         <interfaced.item name="runout_zone_orientation"/>
         <interfaced.item name="tolerance_zone_form"/>
      </interface>
      <type name="egt_document_reference_item">
         <select extensible="YES" genericentity="YES" basedon="document_reference_item" selectitems="representation"/>
      </type>
      <entity name="angular_dimensional_size" supertypes="dimensional_size">
         <where label="wr1" expression=" self \ dimensional_size . name &lt;&gt; 'angular' "/>
      </entity>
      <entity name="auxiliary_characteristic_dimension_representation" supertypes="dimensional_characteristic_representation"/>
      <entity name="datum_difference" supertypes="shape_aspect shape_aspect_relationship">
         <where label="wr1" expression=" ( 'extended_geometric_tolerance_mim.' + 'physical_unit_datum' in typeof ( self \ shape_aspect_relationship . relating_shape_aspect ) ) and ( 'extended_geometric_tolerance_mim.' + 'physical_unit_datum' in typeof ( self \ shape_aspect_relationship . related_shape_aspect ) ) "/>
         <where label="wr2" expression=" self \ shape_aspect . name = self \ shape_aspect_relationship . name "/>
         <where label="wr3" expression=" self \ shape_aspect . description = self \ shape_aspect_relationship . description "/>
         <where label="wr4" expression=" self \ shape_aspect_relationship . relating_shape_aspect :&lt;&gt;: self \ shape_aspect_relationship . related_shape_aspect "/>
         <where label="wr5" expression=" sizeof ( typeof ( self ) - ( typeof ( self \ shape_aspect || self \ shape_aspect_relationship || self \ datum_difference ) ) ) = 0 "/>
      </entity>
      <entity name="datum_difference_based_characteristic" supertypes="representation_item">
         <where label="wr1" expression=" sizeof ( query ( r &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'representation.items' ) | ( sizeof ( query ( prd2 &lt;* query ( prd &lt;* usedin ( r , 'extended_geometric_tolerance_mim.' + 'property_definition_representation.used_representation' ) | ( ( ( 'extended_geometric_tolerance_mim.' + 'property_definition_representation' ) in typeof ( prd ) ) and ( ( 'extended_geometric_tolerance_mim.' + 'property_definition' ) in typeof ( prd \ property_definition_representation . definition ) ) ) ) | ( 'extended_geometric_tolerance_mim.' + 'datum_difference' in typeof ( prd2 \ property_definition_representation . definition \ property_definition . definition ) ) ) ) = 1 ) ) ) = 1 "/>
      </entity>
      <entity name="dimensional_size_property" supertypes="dimensional_size property_definition"/>
      <entity name="edge_segment_vertex" supertypes="physical_unit_datum">
         <where label="wr1" expression=" sizeof ( typeof ( self ) - typeof ( self \ physical_unit_datum || self \ edge_segment_vertex ) ) = 0 "/>
         <where label="wr2" expression=" sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | pd \ property_definition . description = 'shape element characterization' ) ) = 1 "/>
         <where label="wr3" expression=" self \ shape_aspect . of_shape \ property_definition . definition . frame_of_reference \ application_context_element . name in [ 'physical design occurrence' , 'physical design usage' ] "/>
         <where label="wr4" expression=" self \ shape_aspect . name = 'single datum' "/>
      </entity>
      <entity name="geometric_tolerance_group" supertypes="property_definition">
         <where label="wr1" expression=" self \ property_definition . description in [ 'separate requirement' , 'simultaneous requirement' ] "/>
         <where label="wr3" expression=" ( not ( self \ property_definition . description = 'simultaneous requirement' ) ) or ( sizeof ( query ( pdr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( ( 'extended_geometric_tolerance_mim.' + 'physical_unit_geometric_tolerance' in typeof ( pdr . related_property_definition ) ) and ( pdr \ property_definition_relationship . name = 'group geometric tolerance' ) ) ) ) &gt;= 2 ) "/>
         <where label="wr4" expression=" ( not ( self \ property_definition . description = 'separate requirement' ) ) or ( sizeof ( query ( pdr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( ( 'extended_geometric_tolerance_mim.' + 'linear_profile_tolerance' in typeof ( pdr . related_property_definition ) ) and ( pdr . related_property_definition \ property_definition . name = 'linear profile refinement' ) and ( pdr \ property_definition_relationship . name = 'group geometric tolerance' ) ) ) ) = 0 ) "/>
         <where label="wr5" expression=" ( not ( self \ property_definition . description = 'separate requirement' ) ) or ( sizeof ( query ( pdr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( ( 'extended_geometric_tolerance_mim.' + 'surface_profile_tolerance' in typeof ( pdr . related_property_definition ) ) and ( pdr . related_property_definition \ property_definition . name = 'surface profile refinement' ) and ( pdr \ property_definition_relationship . name = 'group geometric tolerance' ) ) ) ) = 0 ) "/>
         <where label="wr6" expression=" ( not ( self \ property_definition . description = 'separate requirement' ) ) or ( sizeof ( query ( pdr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( ( 'extended_geometric_tolerance_mim.' + 'position_tolerance' in typeof ( pdr . related_property_definition ) ) and ( pdr . related_property_definition \ property_definition . name = 'feature relating position' ) and ( pdr \ property_definition_relationship . name = 'group geometric tolerance' ) ) ) ) = 0 ) "/>
         <where label="wr7" expression=" ( not ( self \ property_definition . description = 'separate requirement' ) ) or ( sizeof ( query ( pdr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( pdr \ property_definition_relationship . name = 'group geometric tolerance' ) and ( sizeof ( [ 'extended_geometric_tolerance_mim.' + 'linear_profile_tolerance' , 'extended_geometric_tolerance_mim.' + 'surface_profile_tolerance' , 'extended_geometric_tolerance_mim.' + 'position_tolerance' ] * typeof ( pdr . related_property_definition ) ) &gt; 0 ) ) ) = 0 ) "/>
      </entity>
      <entity name="linear_profile_tolerance" supertypes="physical_unit_geometric_tolerance">
         <where label="wr1" expression=" ( not ( self \ geometric_tolerance . name = 'linear profile refinement' ) ) or ( sizeof ( query ( gtr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'geometric_tolerance_relationship.related_geometric_tolerance' ) | ( ( 'extended_geometric_tolerance_mim.' + 'linear_profile_tolerance' in typeof ( gtr . relating_geometric_tolerance ) ) and ( gtr \ geometric_tolerance_relationship . name = 'linear profile refining control' ) and ( ( gtr . relating_geometric_tolerance \ geometric_tolerance . name = 'linear profile locating' ) or ( gtr . relating_geometric_tolerance \ geometric_tolerance . name = 'linear profile refinement' ) ) ) ) ) = 1 ) "/>
         <where label="wr2" expression=" ( not ( self \ geometric_tolerance . name = 'linear profile locating' ) ) or ( sizeof ( query ( gtr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'geometric_tolerance_relationship.related_geometric_tolerance' ) | ( ( 'extended_geometric_tolerance_mim.' + 'linear_profile_tolerance' in typeof ( gtr . relating_geometric_tolerance ) ) and ( gtr . relating_geometric_tolerance \ geometric_tolerance . name = 'linear profile refinement' ) ) and ( gtr \ geometric_tolerance_relationship . name = 'linear profile refining control' ) ) ) = 1 ) "/>
         <where label="wr4" expression=" ( not ( self \ geometric_tolerance . name = 'linear profile refinement' ) ) or ( sizeof ( query ( gtr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'geometric_tolerance_relationship.relating_geometric_tolerance' ) | ( ( 'extended_geometric_tolerance_mim.' + 'linear_profile_tolerance' in typeof ( gtr . relating_geometric_tolerance ) ) and ( gtr . related_geometric_tolerance \ geometric_tolerance . name = 'linear profile refinement' ) and ( gtr \ geometric_tolerance_relationship . name = 'linear profile refining control' ) ) ) ) &lt;= 1 ) "/>
         <where label="wr5" expression=" not ( 'extended_geometric_tolerance_mim.' + 'modified_geometric_tolerance' in typeof ( self ) ) "/>
      </entity>
      <entity name="opposing_boundary_dimensional_size" supertypes="dimensional_size">
         <where label="wr1" expression=" self \ dimensional_size . name in [ 'angular' , 'linear' ] "/>
      </entity>
      <entity name="physical_unit_datum" supertypes="shape_aspect" super.expression="edge_segment_vertex">
         <where label="wr1" expression=" self \ shape_aspect . description in [ 'axis' , 'plane' , 'point' , '' ] "/>
         <where label="wr2" expression=" self \ shape_aspect . product_definitional = false "/>
         <where label="wr3" expression=" self \ shape_aspect . name in [ 'single datum' , 'common datum' , '' ] "/>
         <where label="wr4" expression=" ( not ( self \ shape_aspect . name = 'common datum' ) ) or ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( sar \ shape_aspect_relationship . name = 'datum feature usage in datum system' ) and ( 'extended_geometric_tolerance_mim.' + 'datum_system' in typeof ( sar ) ) ) ) &gt;= 1 ) "/>
         <where label="wr5" expression=" ( not ( self \ shape_aspect . name = 'common datum' ) ) or ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( sar \ shape_aspect_relationship . name = 'datum feature usage in common datum' ) and ( 'extended_geometric_tolerance_mim.' + 'datum_system' in typeof ( sar ) ) ) ) &gt;= 2 ) "/>
         <where label="wr6" expression=" ( not ( ( self \ shape_aspect . description = 'axis' ) and ( self \ shape_aspect . name in [ 'common datum' , 'single datum' ] ) ) ) or ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.related_shape_aspect' ) | not ( sar \ shape_aspect_relationship . name = 'reference axis' ) and ( 'extended_geometric_tolerance_mim.' + 'datum_reference_frame' in typeof ( sar ) ) ) ) = 1 ) "/>
         <where label="wr7" expression=" ( not ( ( self \ shape_aspect . description = 'plane' ) and ( self \ shape_aspect . name in [ 'common datum' , 'single datum' ] ) ) ) or ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.related_shape_aspect' ) | not ( sar \ shape_aspect_relationship . name = 'reference plane' ) and ( 'extended_geometric_tolerance_mim.' + 'datum_reference_frame' in typeof ( sar ) ) ) ) = 1 ) "/>
         <where label="wr8" expression=" ( not ( ( self \ shape_aspect . description = 'point' ) and ( self \ shape_aspect . name in [ 'common datum' , 'single datum' ] ) ) ) or ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.related_shape_aspect' ) | not ( sar \ shape_aspect_relationship . name = 'reference origin' ) and ( 'extended_geometric_tolerance_mim.' + 'datum_reference_frame' in typeof ( sar ) ) ) ) = 1 ) "/>
         <where label="wr9" expression=" ( not ( self \ shape_aspect . name = 'single datum' ) ) or ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( sar \ shape_aspect_relationship . name = 'datum usage in datum system' ) and ( 'extended_geometric_tolerance_mim.' + 'datum_system' in typeof ( sar ) ) ) ) &gt;= 1 ) "/>
         <where label="wr10" expression=" ( not ( self \ shape_aspect . name = 'single datum' ) ) or ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( sar \ shape_aspect_relationship . name = 'datum feature usage in single datum' ) and ( true ) ) ) &lt;= 1 ) "/>
         <where label="wr11" expression=" not ( ( self \ shape_aspect . name in [ '' ] ) and ( self \ shape_aspect . description in [ '' ] ) ) "/>
         <where label="wr12" expression=" ( not ( self \ shape_aspect . description = 'plane' ) ) or ( sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | pd \ property_definition . description = 'datum direction property' ) ) &lt;= 2 ) "/>
      </entity>
      <entity name="physical_unit_datum_feature" supertypes="shape_aspect">
         <where label="wr1" expression=" ( sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.' + 'definition' ) | ( pd \ property_definition . description = 'datum feature identification' ) ) ) ) = 1 "/>
         <where label="wr2" expression=" ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.related_shape_aspect' ) | sar \ shape_aspect_relationship . name in [ 'datum feature usage in common datum' , 'datum feature usage in single datum' ] ) ) &gt;= 1 ) "/>
         <where label="wr3" expression=" ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.related_shape_aspect' ) | sar \ shape_aspect_relationship . name = 'datum feature usage in single datum' ) ) &lt;= 1 ) "/>
      </entity>
      <entity name="physical_unit_datum_target_set" supertypes="physical_unit_datum_feature">
         <where label="wr1" expression=" ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | sar \ shape_aspect_relationship . name = 'datum target usage' ) ) &gt;= 1 ) "/>
         <where label="wr2" expression=" ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.related_shape_aspect' ) | sar \ shape_aspect_relationship . name = 'constituent' ) ) = 0 ) "/>
      </entity>
      <entity name="physical_unit_geometric_tolerance" supertypes="geometric_tolerance property_definition">
         <where label="wr1" expression=" self \ geometric_tolerance . name = self \ property_definition . name "/>
         <where label="wr2" expression=" self \ geometric_tolerance . toleranced_shape_aspect = self \ property_definition . definition "/>
         <where label="wr4" expression=" ( not ( self \ geometric_tolerance . name = 'circularity' ) ) or ( not ( 'extended_geometric_tolerance_mim.' + 'modified_geometric_tolerance' in typeof ( self ) ) ) "/>
         <where label="wr5" expression=" ( not ( self \ geometric_tolerance . name = 'cylindricity' ) ) or ( not ( 'extended_geometric_tolerance_mim.' + 'modified_geometric_tolerance' in typeof ( self ) ) ) "/>
         <where label="wr6" expression=" ( not ( self \ geometric_tolerance . name = 'flatness' ) ) or ( not ( 'extended_geometric_tolerance_mim.' + 'modified_geometric_tolerance' in typeof ( self ) ) ) "/>
         <where label="wr7" expression=" ( sizeof ( query ( pugt &lt;* query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.related_shape_aspect' ) | sar \ shape_aspect_relationship . name = 'group geometric tolerance' ) | pugt . relating_shape_aspect \ shape_aspect . description = 'simultaneous requirement' ) ) &lt;= 1 ) "/>
      </entity>
      <entity name="positional_boundary" supertypes="shape_aspect">
         <where label="wr1" expression=" self \ shape_aspect . description in [ 'dimension related positional boundary' , 'profile related positional boundary' ] "/>
         <where label="wr2" expression=" self \ shape_aspect . product_definitional = false "/>
         <where label="wr3" expression=" ( not ( self \ shape_aspect . description = 'dimension related positional boundary' ) ) or ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( 'extended_geometric_tolerance_mim.' + 'positional_boundary_member' in typeof ( sar . related_shape_aspect ) ) and ( sar \ shape_aspect_relationship . name = 'boundary member' ) ) ) &gt;= 1 ) "/>
         <where label="wr5" expression=" ( not ( self \ shape_aspect . description = 'dimension related positional boundary' ) ) or ( sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | ( pd \ property_definition . description = 'dimension related positional boundary property' ) ) ) = 1 ) "/>
         <where label="wr6" expression=" ( not ( self \ shape_aspect . description = 'profile related positional boundary' ) ) or ( sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | ( pd \ property_definition . description = 'profile related positional boundary property' ) ) ) = 1 ) "/>
         <where label="wr7" expression=" ( not ( self \ shape_aspect . description = 'profile related positional boundary' ) ) or ( sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( 'extended_geometric_tolerance_mim.' + 'positional_boundary_member' in typeof ( sar . related_shape_aspect ) ) and ( sar \ shape_aspect_relationship . name = 'positional boundary and profile boundary member' ) ) ) = 1 ) "/>
      </entity>
      <entity name="positional_boundary_member" supertypes="shape_aspect">
         <where label="wr1" expression=" self \ shape_aspect . product_definitional = false "/>
         <where label="wr2" expression=" sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | ( pd \ property_definition . description = 'positional boundary member property' ) ) ) = 1 "/>
         <where label="wr3" expression=" sizeof ( query ( sar &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.related_shape_aspect' ) | ( sar \ shape_aspect_relationship . name = 'boundary member' ) and ( 'extended_geometric_tolerance_mim.' + 'positional_boundary' in typeof ( sar . relating_shape_aspect ) ) and ( sar . relating_shape_aspect \ shape_aspect . description = 'dimension related positional boundary' ) ) ) = 1 "/>
      </entity>
      <entity name="statistical_dimensional_location" supertypes="dimensional_location"/>
      <entity name="statistical_dimensional_size" supertypes="dimensional_size_property">
         <where label="wr1" expression=" sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( 'extended_geometric_tolerance_mim.' + 'dimensional_size' in typeof ( pdr . related_property_definition ) ) and ( pdr \ property_definition_relationship . name = 'substitutable dimension' ) ) ) &lt;= 1 ) ) ) &lt;= 1 "/>
         <where label="wr2" expression=" sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( 'extended_geometric_tolerance_mim.' + 'requirements_property' in typeof ( pdr . related_property_definition ) ) and ( pdr \ property_definition_relationship . name = 'dimensional tolerance statistical control requirement' ) ) ) &lt;= 1 ) ) ) &lt;= 1 "/>
         <where label="wr3" expression=" ( not ( sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( 'extended_geometric_tolerance_mim.' + 'dimensional_size' in typeof ( pdr . related_property_definition ) ) and ( pdr \ property_definition_relationship . name = 'substitutable dimension' ) ) ) &lt;= 1 ) ) ) &lt;= 1 ) ) or ( not ( sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( 'extended_geometric_tolerance_mim.' + 'dimensional_size' in typeof ( pdr . related_property_definition ) ) and ( not ( 'extended_geometric_tolerance_mim.' + 'statistical_dimensional_size' in typeof ( pdr . related_property_definition ) ) ) and ( pdr \ property_definition_relationship . name = 'substitutable dimension' ) ) ) &lt;= 1 ) ) ) &lt;= 1 ) ) "/>
      </entity>
      <entity name="statistical_geometric_tolerance" supertypes="physical_unit_geometric_tolerance">
         <where label="wr1" expression=" sizeof ( query ( gtr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'geometric_tolerance_relationship.related_geometric_tolerance' ) | ( 'extended_geometric_tolerance_mim.' + 'physical_unit_geometric_tolerance' in typeof ( gtr . relating_geometric_tolerance ) ) and ( gtr \ geometric_tolerance_relationship . name = 'substitutable geometric tolerance' ) ) ) &lt;= 1 "/>
         <where label="wr2" expression=" sizeof ( query ( pdr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( 'extended_geometric_tolerance_mim.' + 'requirements_property' in typeof ( pdr . related_property_definition ) ) and ( pdr \ property_definition_relationship . name = 'geometric tolerance statistical control requirement' ) ) ) = 1 "/>
         <where label="wr3" expression=" sizeof ( query ( gtr &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'geometric_tolerance_relationship.related_geometric_tolerance' ) | ( 'extended_geometric_tolerance_mim.' + 'statistical_geometric_tolerance' in typeof ( gtr . relating_geometric_tolerance ) ) and ( gtr \ geometric_tolerance_relationship . name = 'substitutable geometric tolerance' ) ) ) &lt;= 0 "/>
      </entity>
      <entity name="tolerance_zone_boundary" supertypes="shape_aspect">
         <where label="wr1" expression=" ( not ( self \ shape_aspect . description = 'conical' ) ) or ( not ( ( 'extended_geometric_tolerance_mim.' + 'tolerance_zone_explicit_opposing_boundary_set' in typeof ( self ) ) or ( 'extended_geometric_tolerance_mim.' + 'tolerance_zone_implicit_opposing_boundary_set' in typeof ( self ) ) ) ) "/>
         <where label="wr2" expression=" ( not ( self \ shape_aspect . description = 'circular or cylindrical or spherical' ) ) or ( not ( ( 'extended_geometric_tolerance_mim.' + 'tolerance_zone_explicit_opposing_boundary_set' in typeof ( self ) ) or ( 'extended_geometric_tolerance_mim.' + 'tolerance_zone_implicit_opposing_boundary_set' in typeof ( self ) ) ) ) "/>
         <where label="wr3" expression=" self \ shape_aspect . product_definitional = false "/>
         <where label="wr4" expression=" not ( ( 'extended_geometric_tolerance_mim.' + 'tolerance_zone_explicit_opposing_boundary_set' in typeof ( self ) ) and ( 'extended_geometric_tolerance_mim.' + 'tolerance_zone_implicit_opposing_boundary_set' in typeof ( self ) ) ) "/>
         <where label="wr5" expression=" sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | ( pd \ property_definition . description = 'boundary zone definition with specified size' ) or ( pd \ property_definition . description = 'conical tolerance zone boundary' ) ) ) = 1 "/>
         <where label="wr6" expression=" sizeof ( usedin ( self , 'extended_geometric_tolerance_mim.' + 'tolerance_zone_definition.boundaries' ) ) = 1 "/>
      </entity>
      <entity name="tolerance_zone_explicit_opposing_boundary_set" supertypes="tolerance_zone_boundary"/>
      <entity name="tolerance_zone_implicit_opposing_boundary_set" supertypes="tolerance_zone_boundary"/>
      <entity name="viewing_plane" supertypes="shape_aspect">
         <where label="wr1" expression=" self \ shape_aspect . description = 'affected plane' "/>
         <where label="wr2" expression=" ( sizeof ( query ( pd &lt;* usedin ( self , 'extended_geometric_tolerance_mim.' + 'property_definition.' + 'definition' ) | ( pd \ property_definition . description = 'viewing plane property' ) ) ) ) = 1 "/>
         <where label="wr3" expression=" not self \ shape_aspect . product_definitional "/>
      </entity>
      <rule name="boundary_size_characteristic_constraint" appliesto="representation">
         <where label="wr1" expression=" sizeof ( query ( rep &lt;* representation | ( ( rep \ representation . name = 'diametrical boundary size' ) or ( rep \ representation . name = 'opposing boundary set size' ) ) and ( not ( sizeof ( query ( lmwu &lt;* rep . items | ( lmwu \ representation_item . name = 'tolerance value' ) ) ) = 1 ) ) ) ) = 0 "/>
      </rule>
      <rule name="directed_axis_constraint" appliesto="derived_shape_aspect">
         <where label="wr1" expression=" sizeof ( query ( dsa &lt;* derived_shape_aspect | ( dsa \ shape_aspect . description = 'directed axis' ) and not ( sizeof ( query ( sar &lt;* usedin ( dsa , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( sar \ shape_aspect_relationship . name = 'derived axis' ) and ( 'extended_geometric_tolerance_mim.' + 'centre_of_symmetry' in typeof ( sar \ shape_aspect_relationship . related_shape_aspect ) ) and ( sar \ shape_aspect_relationship . related_shape_aspect \ shape_aspect . description = 'axis' ) ) ) = 1 ) ) ) = 0 "/>
         <where label="wr2" expression=" sizeof ( query ( dsa &lt;* derived_shape_aspect | ( dsa \ shape_aspect . description = 'directed axis' ) and not ( sizeof ( query ( sar &lt;* usedin ( dsa , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( sar \ shape_aspect_relationship . name = 'end shape aspect' ) and ( 'extended_geometric_tolerance_mim.' + 'shape_aspect' in typeof ( sar \ shape_aspect_relationship . related_shape_aspect ) ) ) ) = 1 ) ) ) = 0 "/>
         <where label="wr3" expression=" sizeof ( query ( dsa &lt;* derived_shape_aspect | ( dsa \ shape_aspect . description = 'directed axis' ) and not ( sizeof ( query ( sar &lt;* usedin ( dsa , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( sar \ shape_aspect_relationship . name = 'start shape aspect' ) and ( 'extended_geometric_tolerance_mim.' + 'shape_aspect' in typeof ( sar \ shape_aspect_relationship . related_shape_aspect ) ) ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="directed_axis_unique_constraint" appliesto="derived_shape_aspect">
         <algorithm> local da : bag of derived_shape_aspect := query ( r &lt;* derived_shape_aspect | ( r \ shape_aspect . description = 'directed axis' ) ) ; sar_bag : bag of shape_aspect_relationship ; cos_bag : bag of centre_of_symmetry := [ ] ; sar2_bag : bag of shape_aspect_relationship ; pass : boolean := true ; sa_bag : bag of shape_aspect ; end_local ; repeat i := 1 to sizeof ( da ) by 1 ; sar_bag := query ( sar &lt;* usedin ( da [ i ] , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( ( sar \ shape_aspect_relationship . name = 'derived axis' ) and ( sar . related_shape_aspect \ shape_aspect . description = 'axis' ) and ( 'extended_geometric_tolerance_mim.' + 'centre_of_symmetry' in typeof ( sar . related_shape_aspect ) ) ) ) ; repeat j := 1 to sizeof ( sar_bag ) by 1 ; if exists ( sar_bag [ j ] . related_shape_aspect ) then if ( not ( sar_bag [ j ] . related_shape_aspect in cos_bag ) ) then cos_bag := cos_bag + sar_bag [ j ] . related_shape_aspect ; end_if ; end_if ; end_repeat ; end_repeat ; repeat i := 1 to sizeof ( cos_bag ) by 1 ; if ( not pass ) then escape ; end_if ; sa_bag := [ ] ; sar_bag := query ( sar &lt;* usedin ( cos_bag [ i ] , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.related_shape_aspect' ) | ( ( sar \ shape_aspect_relationship . name = 'derived axis' ) and ( sar . relating_shape_aspect in da ) ) ) ; repeat j := 1 to sizeof ( sar_bag ) by 1 ; if ( not pass ) then escape ; end_if ; sar2_bag := query ( sar &lt;* usedin ( sar_bag [ j ] . relating_shape_aspect , 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship.relating_shape_aspect' ) | ( sar \ shape_aspect_relationship . name = 'start shape aspect' ) ) ; repeat k := 1 to sizeof ( sar2_bag ) by 1 ; if exists ( sar2_bag [ k ] . related_shape_aspect ) then if ( sar2_bag [ k ] . related_shape_aspect in sa_bag ) then pass := false ; escape ; else sa_bag := sa_bag + sar2_bag [ k ] . related_shape_aspect ; end_if ; end_if ; end_repeat ; end_repeat ; end_repeat ; </algorithm>
         <where label="wr1" expression=" pass "/>
      </rule>
      <rule name="direction_element_constraint" appliesto="property_definition">
         <where label="wr1" expression=" sizeof ( query ( pd &lt;* property_definition | ( pd \ property_definition . description = 'direction element' ) and not ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( pdr \ property_definition_relationship . name = 'element direction vector' ) and ( 'extended_geometric_tolerance_mim.' + 'property_definition' in typeof ( pdr . related_property_definition ) ) and ( pdr . related_property_definition \ property_definition . description = 'datum direction_property' ) ) ) = 1 ) ) ) = 0 "/>
         <where label="wr2" expression=" sizeof ( query ( pd &lt;* property_definition | ( pd \ property_definition . description = 'direction element' ) and not ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( pdr \ property_definition_relationship . name = 'half datum plane direction vector' ) and ( 'extended_geometric_tolerance_mim.' + 'property_definition' in typeof ( pdr . related_property_definition ) ) and ( pdr . related_property_definition \ property_definition . description = 'datum direction_property' ) ) ) = 1 ) ) ) = 0 "/>
         <where label="wr3" expression=" sizeof ( query ( pd &lt;* property_definition | ( pd \ property_definition . description = 'direction element' ) and not ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( pdr \ property_definition_relationship . name = 'direction component' ) and ( 'extended_geometric_tolerance_mim.' + 'property_definition' in typeof ( pdr . related_property_definition ) ) and ( pdr . related_property_definition \ property_definition . description = 'datum based vector orientation' ) ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="edge_segment_vertex_constraint" appliesto="shape_aspect_relationship edge_segment_vertex">
         <algorithm> local sar : bag of shape_aspect_relationship := [ ] ; esv : bag of edge_segment_vertex := edge_segment_vertex ; pass : boolean := true ; end_local ; repeat i := 1 to sizeof ( esv ) by 1 ; if ( not pass ) then escape ; end_if ; sar := query ( sar &lt;* shape_aspect_relationship | esv [ i ] = sar \ shape_aspect_relationship . related_shape_aspect ) ; pass := ( sizeof ( sar ) = 2 ) ; repeat j := 2 to sizeof ( sar ) by 1 ; if ( not pass ) then escape ; end_if ; pass := ( ( sar [ j ] ) :&lt;&gt;: ( sar [ j - 1 ] ) ) ; if ( not pass ) then escape ; end_if ; pass := ( typeof ( sar [ j ] ) = typeof ( sar [ j - 1 ] ) ) ; if ( not pass ) then escape ; end_if ; pass := ( sar [ j ] . relating_shape_aspect :=: sar [ j - 1 ] . relating_shape_aspect ) ; end_repeat ; end_repeat ; </algorithm>
         <where label="wr1" expression=" pass "/>
      </rule>
      <rule name="edge_segment_vertex_unique_constraint" appliesto="edge_segment_vertex">
         <algorithm> local esv : bag of edge_segment_vertex := query ( r &lt;* edge_segment_vertex | ( r \ shape_aspect . name = 'single datum' ) ) ; pd_bag : bag of property_definition ; pdr_bag : bag of property_definition_representation ; pass : boolean := true ; desc_bag : bag of string := [ ] ; end_local ; repeat i := 1 to sizeof ( esv ) by 1 ; if ( not pass ) then escape ; end_if ; pd_bag := query ( pd &lt;* usedin ( esv [ i ] , 'extended_geometric_tolerance_mim.' + 'property_definition.definition' ) | ( pd \ property_definition . description = 'shape element characterization' ) ) ; repeat j := 1 to sizeof ( pd_bag ) by 1 ; if ( not pass ) then escape ; end_if ; pdr_bag := usedin ( pd_bag [ j ] , 'extended_geometric_tolerance_mim.' + 'property_definition_representation.definition' ) ; repeat k := 1 to sizeof ( pdr_bag ) by 1 ; if ( not pass ) then escape ; end_if ; if ( ( pdr_bag [ k ] . used_representation \ representation . name = 'shape element characterization' ) and ( 'extended_geometric_tolerance_mim.' + 'descriptive_representation_item' in typeof ( pdr_bag [ k ] . used_representation . items [ 1 ] ) ) ) then if exists ( pdr_bag [ k ] . used_representation . items [ 1 ] \ descriptive_representation_item . description ) then if ( pdr_bag [ k ] . used_representation . items [ 1 ] \ descriptive_representation_item . description in desc_bag ) then pass := false ; escape ; else desc_bag := desc_bag + pdr_bag [ k ] . used_representation . items [ 1 ] \ descriptive_representation_item . description ; end_if ; end_if ; end_if ; end_repeat ; end_repeat ; end_repeat ; </algorithm>
         <where label="wr1" expression=" pass "/>
      </rule>
      <rule name="geometric_tolerance_qualifier_constraint" appliesto="measure_qualification">
         <where label="wr1" expression=" sizeof ( query ( mq &lt;* measure_qualification | ( ( mq \ measure_qualification . name = 'predefined geometric tolerance qualifier' ) or ( mq \ measure_qualification . name = 'user defined geometric tolerance qualifier' ) ) and not ( ( 'extended_geometric_tolerance_mim.' + 'measure_with_unit' in typeof ( mq . qualified_measure ) ) and ( sizeof ( query ( pugt &lt;* usedin ( mq . qualified_measure , 'extended_geometric_tolerance_mim.' + 'geometric_tolerance.magnitude' ) | ( 'extended_geometric_tolerance_mim.' + 'physical_unit_geometric_tolerance' in typeof ( pugt ) ) ) ) = 0 ) ) ) ) = 0 "/>
      </rule>
      <rule name="positional_boundary_member_definition_constraint" appliesto="property_definition">
         <where label="wr1" expression=" sizeof ( query ( pd &lt;* property_definition | ( pd \ property_definition . description = 'positional boundary member property' ) and not ( ( 'extended_geometric_tolerance_mim.' + 'positional_boundary_member' in typeof ( pd . definition ) ) ) ) ) = 0 "/>
         <where label="wr2" expression=" sizeof ( query ( pd &lt;* property_definition | ( pd \ property_definition . description = 'positional boundary member property' ) and not ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( 'extended_geometric_tolerance_mim.' + 'dimensional_size_property' in typeof ( pdr . related_property_definition ) ) and ( pdr \ property_definition_relationship . name = 'boundary member associated dimension' ) ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="positional_boundary_offset_constraint" appliesto="property_definition">
         <where label="wr1" expression=" sizeof ( query ( pd &lt;* property_definition | ( pd \ property_definition . description = 'positional boundary offset' ) and not ( ( 'extended_geometric_tolerance_mim.' + 'shape_aspect_relationship' in typeof ( pd . definition ) ) and ( pd . definition \ shape_aspect_relationship . name = 'positional boundary and profile boundary member' ) ) ) ) = 0 "/>
         <where label="wr2" expression=" sizeof ( query ( pd &lt;* property_definition | ( pd \ property_definition . description = 'positional boundary offset' ) and not ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.related_property_definition' ) | ( pdr \ property_definition_relationship . name = 'boundary offset' ) and ( pdr . relating_property_definition \ property_definition . name = 'profile related positional boundary property' ) ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="profile_related_positional_boundary_definition_constraint" appliesto="property_definition">
         <where label="wr1" expression=" sizeof ( query ( pd &lt;* property_definition | ( pd \ property_definition . description = 'profile related positional boundary property' ) and not ( ( 'extended_geometric_tolerance_mim.' + 'positional_boundary' in typeof ( pd . definition ) ) and ( pd . definition \ shape_aspect . description = 'profile related positional boundary' ) ) ) ) = 0 "/>
         <where label="wr2" expression=" sizeof ( query ( pd &lt;* property_definition | ( pd \ property_definition . description = 'profile related positional boundary property' ) and not ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( pdr . related_property_definition \ property_definition . description = 'positional boundary offset' ) and ( pdr \ property_definition_relationship . name = 'boundary offset' ) ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="projected_zone_and_base_relationship_constraint" appliesto="projected_zone_definition">
         <where label="wr1" expression=" sizeof ( query ( pzd &lt;* projected_zone_definition | not ( ( 'extended_geometric_tolerance_mim.' + 'part_template_definition' in typeof ( pzd . projection_end ) ) or ( pzd . projection_end . product_definitional = true ) ) ) ) = 0 "/>
      </rule>
      <rule name="projected_zone_height_characteristic_constraint" appliesto="projected_zone_definition">
         <where label="wr1" expression=" sizeof ( query ( pzd &lt;* projected_zone_definition | not ( 'extended_geometric_tolerance_mim.' + 'length_measure_with_unit' in typeof ( pzd . projected_length ) ) ) ) = 0 "/>
      </rule>
      <rule name="restraint_condition_constraint" appliesto="property_definition">
         <where label="wr1" expression=" sizeof ( query ( pd &lt;* property_definition | ( ( pd \ property_definition . description = 'restraint' ) or ( pd \ property_definition . description = 'tolerance specific restraint' ) ) and ( sizeof ( query ( pdr &lt;* usedin ( pd , 'extended_geometric_tolerance_mim.' + 'property_definition_relationship.relating_property_definition' ) | ( 'extended_geometric_tolerance_mim.' + 'requirements_property' in typeof ( pdr . related_property_definition ) ) and ( pdr \ property_definition_relationship . name = 'restraint description' ) ) ) = 0 ) ) ) = 0 "/>
      </rule>
      <rule name="shape_element_deriving_relationship_unique_constraint" appliesto="shape_aspect_deriving_relationship">
         <algorithm> local sa_bag : bag of shape_aspect := [ ] ; sadr_bag : bag of shape_aspect_deriving_relationship ; pass : boolean := true ; rsa_bag : bag of shape_aspect ; end_local ; repeat i := 1 to sizeof ( shape_aspect_deriving_relationship ) by 1 ; if exists ( shape_aspect_deriving_relationship [ i ] . relating_shape_aspect ) then if ( not ( shape_aspect_deriving_relationship [ i ] . relating_shape_aspect in sa_bag ) ) then sa_bag := sa_bag + shape_aspect_deriving_relationship [ i ] . relating_shape_aspect ; end_if ; end_if ; end_repeat ; repeat i := 1 to sizeof ( sa_bag ) by 1 ; if ( not pass ) then escape ; end_if ; sadr_bag := query ( r &lt;* shape_aspect_deriving_relationship | ( r . relating_shape_aspect :=: sa_bag [ i ] ) ) ; rsa_bag := [ ] ; repeat j := 1 to sizeof ( sadr_bag ) by 1 ; if exists ( sadr_bag [ j ] . related_shape_aspect ) then if ( sadr_bag [ j ] . related_shape_aspect in rsa_bag ) then pass := false ; escape ; else rsa_bag := rsa_bag + sadr_bag [ j ] . related_shape_aspect ; end_if ; end_if ; end_repeat ; end_repeat ; </algorithm>
         <where label="wr1" expression=" pass "/>
      </rule>
      <rule name="subtype_exclusive_dimensional_location" appliesto="dimensional_location">
         <where label="wr1" expression=" sizeof ( query ( dl &lt;* dimensional_location | not ( sizeof ( [ 'extended_geometric_tolerance_mim.' + 'angular_dimension_with_orientation' , 'extended_geometric_tolerance_mim.' + 'dimensional_location' , 'extended_geometric_tolerance_mim.' + 'dimensional_location_with_path' ] * typeof ( dl ) ) &lt;= 1 ) ) ) = 0 "/>
      </rule>
      <rule name="subtype_exclusive_dimensional_size" appliesto="dimensional_size">
         <where label="wr1" expression=" sizeof ( query ( ds &lt;* dimensional_size | not ( sizeof ( [ 'extended_geometric_tolerance_mim.' + 'curve_dimension_two' , 'extended_geometric_tolerance_mim.' + 'angular_size' ] * typeof ( ds ) ) &lt;= 1 ) or not ( sizeof ( [ 'extended_geometric_tolerance_mim.' + 'curve_dimension_two' , 'extended_geometric_tolerance_mim.' + 'opposing_boundary_dimensional_size' ] * typeof ( ds ) ) &lt;= 1 ) ) ) = 0 "/>
      </rule>
      <rule name="subtype_mandatory_extended_geometric_tolerance" appliesto="geometric_tolerance">
         <where label="wr1" expression=" sizeof ( query ( gt &lt;* geometric_tolerance | not ( sizeof ( [ 'extended_geometric_tolerance_mim.' + 'physical_unit_geometric_tolerance' ] * typeof ( gt ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="subtype_mandatory_runout_zone_orientation" appliesto="runout_zone_orientation">
         <where label="wr1" expression=" sizeof ( query ( rzo &lt;* runout_zone_orientation | not ( sizeof ( [ 'extended_geometric_tolerance_mim.' + 'runout_zone_orientation_reference_direction' ] * typeof ( rzo ) ) = 1 ) ) ) = 0 "/>
      </rule>
   </schema>
</express>
