<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express language_version="2" rcs.date="2005-04-26T19:01:08" rcs.revision="1.0" description.file="mim_descriptions.xml">
   <application name="JSDAI" owner="LKSoft" url="www.lksoft.com" version="4.0 beta" source="extended_geometric_tolerance_mim schema_instance"/>
   <schema name="Extended_geometric_tolerance_mim">
      <interface kind="use" schema="Requirement_decomposition_mim"/>
      <interface kind="use" schema="Default_tolerance_mim"/>
      <interface kind="use" schema="Dimension_tolerance_mim"/>
      <interface kind="use" schema="Geometric_tolerance_mim"/>
      <interface kind="use" schema="Layered_3d_shape_mim"/>
      <interface kind="use" schema="application_context_schema">
         <interfaced.item name="application_context_element"/>
      </interface>
      <interface kind="use" schema="material_property_definition_schema">
         <interfaced.item name="property_definition_relationship"/>
      </interface>
      <interface kind="use" schema="shape_tolerance_schema">
         <interfaced.item name="runout_zone_orientation"/>
         <interfaced.item name="tolerance_zone_form"/>
      </interface>
      <type name="egt_document_reference_item">
         <select extensible="YES" genericentity="YES" basedon="document_reference_item" selectitems="representation"/>
      </type>
      <type name="egt_external_identification_item">
         <select extensible="YES" genericentity="YES" basedon="external_identification_item" selectitems="shape_dimension_representation"/>
      </type>
      <type name="egt_requirement_assigned_item">
         <select extensible="YES" genericentity="YES" basedon="requirement_assigned_item" selectitems="statistical_geometric_tolerance statistical_dimensional_size statistical_dimensional_location property_definition"/>
      </type>
      <entity name="auxiliary_characteristic_dimension_representation" supertypes="dimensional_characteristic_representation"/>
      <entity name="datum_difference" supertypes="shape_aspect shape_aspect_relationship">
         <where label="WR1" expression=" ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PHYSICAL_UNIT_DATUM' IN TYPEOF ( SELF \ shape_aspect_relationship . relating_shape_aspect ) ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PHYSICAL_UNIT_DATUM' IN TYPEOF ( SELF \ shape_aspect_relationship . related_shape_aspect ) ) "/>
         <where label="WR2" expression=" SELF \ shape_aspect . name = SELF \ shape_aspect_relationship . name "/>
         <where label="WR3" expression=" SELF \ shape_aspect . description = SELF \ shape_aspect_relationship . description "/>
         <where label="WR4" expression=" SELF \ shape_aspect_relationship . relating_shape_aspect :&lt;&gt;: SELF \ shape_aspect_relationship . related_shape_aspect "/>
         <where label="WR5" expression=" SIZEOF ( TYPEOF ( SELF ) - ( TYPEOF ( SELF \ shape_aspect || SELF \ shape_aspect_relationship || SELF \ datum_difference ) ) ) = 0 "/>
      </entity>
      <entity name="datum_difference_based_characteristic" supertypes="representation_item">
         <where label="WR1" expression=" SIZEOF ( QUERY ( r &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'REPRESENTATION.ITEMS' ) | ( SIZEOF ( QUERY ( prd2 &lt;* QUERY ( prd &lt;* USEDIN ( r , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_REPRESENTATION.USED_REPRESENTATION' ) | ( ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_REPRESENTATION' ) IN TYPEOF ( prd ) ) AND ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION' ) IN TYPEOF ( prd \ property_definition_representation . definition ) ) ) ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DATUM_DIFFERENCE' IN TYPEOF ( prd2 \ property_definition_representation . definition \ property_definition . definition ) ) ) ) = 1 ) ) ) = 1 "/>
      </entity>
      <entity name="dimensional_size_property" supertypes="dimensional_size property_definition"/>
      <entity name="edge_segment_vertex" supertypes="physical_unit_datum">
         <where label="WR1" expression=" SIZEOF ( TYPEOF ( SELF ) - TYPEOF ( SELF \ physical_unit_datum || SELF \ edge_segment_vertex ) ) = 0 "/>
         <where label="WR2" expression=" SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | pd \ property_definition . description = 'shape element characterization' ) ) = 1 "/>
         <where label="WR3" expression=" SELF \ shape_aspect . of_shape \ property_definition . definition . frame_of_reference \ application_context_element . name IN [ 'physical design occurrence' , 'physical design usage' ] "/>
         <where label="WR4" expression=" SELF \ shape_aspect . name = 'single datum' "/>
      </entity>
      <entity name="geometric_tolerance_group" supertypes="property_definition">
         <where label="WR1" expression=" SELF \ property_definition . description IN [ 'separate requirement' , 'simultaneous requirement' ] "/>
         <where label="WR3" expression=" ( NOT ( SELF \ property_definition . description = 'simultaneous requirement' ) ) OR ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PHYSICAL_UNIT_GEOMETRIC_TOLERANCE' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr \ property_definition_relationship . name = 'group geometric tolerance' ) ) ) ) &gt;= 2 ) "/>
         <where label="WR4" expression=" ( NOT ( SELF \ property_definition . description = 'separate requirement' ) ) OR ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'LINEAR_PROFILE_TOLERANCE' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr . related_property_definition \ property_definition . name = 'linear profile refinement' ) AND ( pdr \ property_definition_relationship . name = 'group geometric tolerance' ) ) ) ) = 0 ) "/>
         <where label="WR5" expression=" ( NOT ( SELF \ property_definition . description = 'separate requirement' ) ) OR ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SURFACE_PROFILE_TOLERANCE' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr . related_property_definition \ property_definition . name = 'surface profile refinement' ) AND ( pdr \ property_definition_relationship . name = 'group geometric tolerance' ) ) ) ) = 0 ) "/>
         <where label="WR6" expression=" ( NOT ( SELF \ property_definition . description = 'separate requirement' ) ) OR ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'POSITION_TOLERANCE' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr . related_property_definition \ property_definition . name = 'feature relating position' ) AND ( pdr \ property_definition_relationship . name = 'group geometric tolerance' ) ) ) ) = 0 ) "/>
         <where label="WR7" expression=" ( NOT ( SELF \ property_definition . description = 'separate requirement' ) ) OR ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( pdr \ property_definition_relationship . name = 'group geometric tolerance' ) AND ( SIZEOF ( [ 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'LINEAR_PROFILE_TOLERANCE' , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SURFACE_PROFILE_TOLERANCE' , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'POSITION_TOLERANCE' ] * TYPEOF ( pdr . related_property_definition ) ) &gt; 0 ) ) ) = 0 ) "/>
      </entity>
      <entity name="linear_profile_tolerance" supertypes="physical_unit_geometric_tolerance">
         <where label="WR1" expression=" ( NOT ( SELF \ geometric_tolerance . name = 'linear profile refinement' ) ) OR ( SIZEOF ( QUERY ( gtr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'GEOMETRIC_TOLERANCE_RELATIONSHIP.RELATED_GEOMETRIC_TOLERANCE' ) | ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'LINEAR_PROFILE_TOLERANCE' IN TYPEOF ( gtr . relating_geometric_tolerance ) ) AND ( gtr \ geometric_tolerance_relationship . name = 'linear profile refining control' ) AND ( ( gtr . relating_geometric_tolerance \ geometric_tolerance . name = 'linear profile locating' ) OR ( gtr . relating_geometric_tolerance \ geometric_tolerance . name = 'linear profile refinement' ) ) ) ) ) = 1 ) "/>
         <where label="WR2" expression=" ( NOT ( SELF \ geometric_tolerance . name = 'linear profile locating' ) ) OR ( SIZEOF ( QUERY ( gtr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'GEOMETRIC_TOLERANCE_RELATIONSHIP.RELATED_GEOMETRIC_TOLERANCE' ) | ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'LINEAR_PROFILE_TOLERANCE' IN TYPEOF ( gtr . relating_geometric_tolerance ) ) AND ( gtr . relating_geometric_tolerance \ geometric_tolerance . name = 'linear profile refinement' ) ) AND ( gtr \ geometric_tolerance_relationship . name = 'linear profile refining control' ) ) ) = 1 ) "/>
         <where label="WR4" expression=" ( NOT ( SELF \ geometric_tolerance . name = 'linear profile refinement' ) ) OR ( SIZEOF ( QUERY ( gtr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'GEOMETRIC_TOLERANCE_RELATIONSHIP.RELATING_GEOMETRIC_TOLERANCE' ) | ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'LINEAR_PROFILE_TOLERANCE' IN TYPEOF ( gtr . relating_geometric_tolerance ) ) AND ( gtr . related_geometric_tolerance \ geometric_tolerance . name = 'linear profile refinement' ) AND ( gtr \ geometric_tolerance_relationship . name = 'linear profile refining control' ) ) ) ) &lt;= 1 ) "/>
         <where label="WR5" expression=" NOT ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'MODIFIED_GEOMETRIC_TOLERANCE' IN TYPEOF ( SELF ) ) "/>
      </entity>
      <entity name="opposing_boundary_dimensional_size" supertypes="dimensional_size">
         <where label="WR1" expression=" SELF \ dimensional_size . name IN [ 'angular' , 'linear' ] "/>
      </entity>
      <entity name="physical_unit_datum" supertypes="shape_aspect" super.expression="edge_segment_vertex">
         <where label="WR1" expression=" SELF \ shape_aspect . description IN [ 'axis' , 'plane' , 'point' , '' ] "/>
         <where label="WR2" expression=" SELF \ shape_aspect . product_definitional = False "/>
         <where label="WR3" expression=" SELF \ shape_aspect . name IN [ 'single datum' , 'common datum' , '' ] "/>
         <where label="WR4" expression=" ( NOT ( SELF \ shape_aspect . name = 'common datum' ) ) OR ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( sar \ shape_aspect_relationship . name = 'datum feature usage in datum system' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DATUM_SYSTEM' IN TYPEOF ( SAR ) ) ) ) &gt;= 1 ) "/>
         <where label="WR5" expression=" ( NOT ( SELF \ shape_aspect . name = 'common datum' ) ) OR ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( sar \ shape_aspect_relationship . name = 'datum feature usage in common datum' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DATUM_SYSTEM' IN TYPEOF ( SAR ) ) ) ) &gt;= 2 ) "/>
         <where label="WR6" expression=" ( NOT ( ( SELF \ shape_aspect . description = 'axis' ) AND ( SELF \ shape_aspect . name IN [ 'common datum' , 'single datum' ] ) ) ) OR ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT' ) | NOT ( sar \ shape_aspect_relationship . name = 'reference axis' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DATUM_REFERENCE_FRAME' IN TYPEOF ( SAR ) ) ) ) = 1 ) "/>
         <where label="WR7" expression=" ( NOT ( ( SELF \ shape_aspect . description = 'plane' ) AND ( SELF \ shape_aspect . name IN [ 'common datum' , 'single datum' ] ) ) ) OR ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT' ) | NOT ( sar \ shape_aspect_relationship . name = 'reference plane' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DATUM_REFERENCE_FRAME' IN TYPEOF ( SAR ) ) ) ) = 1 ) "/>
         <where label="WR8" expression=" ( NOT ( ( SELF \ shape_aspect . description = 'point' ) AND ( SELF \ shape_aspect . name IN [ 'common datum' , 'single datum' ] ) ) ) OR ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT' ) | NOT ( sar \ shape_aspect_relationship . name = 'reference origin' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DATUM_REFERENCE_FRAME' IN TYPEOF ( SAR ) ) ) ) = 1 ) "/>
         <where label="WR9" expression=" ( NOT ( SELF \ shape_aspect . name = 'single datum' ) ) OR ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( sar \ shape_aspect_relationship . name = 'datum usage in datum system' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DATUM_SYSTEM' IN TYPEOF ( SAR ) ) ) ) &gt;= 1 ) "/>
         <where label="WR10" expression=" ( NOT ( SELF \ shape_aspect . name = 'single datum' ) ) OR ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( sar \ shape_aspect_relationship . name = 'datum feature usage in single datum' ) AND ( TRUE ) ) ) &lt;= 1 ) "/>
         <where label="WR11" expression=" NOT ( ( SELF \ shape_aspect . name IN [ '' ] ) AND ( SELF \ shape_aspect . description IN [ '' ] ) ) "/>
         <where label="WR12" expression=" ( NOT ( SELF \ shape_aspect . description = 'plane' ) ) OR ( SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | pd \ property_definition . description = 'datum direction property' ) ) &lt;= 2 ) "/>
      </entity>
      <entity name="physical_unit_datum_feature" supertypes="shape_aspect">
         <where label="WR1" expression=" ( SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.' + 'DEFINITION' ) | ( pd \ property_definition . description = 'datum feature identification' ) ) ) ) = 1 "/>
         <where label="WR2" expression=" ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT' ) | sar \ shape_aspect_relationship . name IN [ 'datum feature usage in common datum' , 'datum feature usage in single datum' ] ) ) &gt;= 1 ) "/>
         <where label="WR3" expression=" ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT' ) | sar \ shape_aspect_relationship . name = 'datum feature usage in single datum' ) ) &lt;= 1 ) "/>
      </entity>
      <entity name="physical_unit_datum_target_set" supertypes="physical_unit_datum_feature">
         <where label="WR1" expression=" ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | sar \ shape_aspect_relationship . name = 'datum target usage' ) ) &gt;= 1 ) "/>
         <where label="WR2" expression=" ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT' ) | sar \ shape_aspect_relationship . name = 'constituent' ) ) = 0 ) "/>
      </entity>
      <entity name="physical_unit_geometric_tolerance" supertypes="geometric_tolerance property_definition">
         <where label="WR1" expression=" SELF \ geometric_tolerance . name = SELF \ property_definition . name "/>
         <where label="WR2" expression=" SELF \ geometric_tolerance . toleranced_shape_aspect = SELF \ property_definition . definition "/>
         <where label="WR4" expression=" ( NOT ( SELF \ geometric_tolerance . name = 'circularity' ) ) OR ( NOT ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'MODIFIED_GEOMETRIC_TOLERANCE' IN TYPEOF ( SELF ) ) ) "/>
         <where label="WR5" expression=" ( NOT ( SELF \ geometric_tolerance . name = 'cylindricity' ) ) OR ( NOT ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'MODIFIED_GEOMETRIC_TOLERANCE' IN TYPEOF ( SELF ) ) ) "/>
         <where label="WR6" expression=" ( NOT ( SELF \ geometric_tolerance . name = 'flatness' ) ) OR ( NOT ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'MODIFIED_GEOMETRIC_TOLERANCE' IN TYPEOF ( SELF ) ) ) "/>
         <where label="WR7" expression=" ( SIZEOF ( QUERY ( pugt &lt;* QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT' ) | sar \ shape_aspect_relationship . name = 'group geometric tolerance' ) | pugt . relating_shape_aspect \ shape_aspect . description = 'simultaneous requirement' ) ) &lt;= 1 ) "/>
      </entity>
      <entity name="positional_boundary" supertypes="shape_aspect">
         <where label="WR1" expression=" SELF \ shape_aspect . description IN [ 'dimension related positional boundary' , 'profile related positional boundary' ] "/>
         <where label="WR2" expression=" SELF \ shape_aspect . product_definitional = False "/>
         <where label="WR3" expression=" ( NOT ( SELF \ shape_aspect . description = 'dimension related positional boundary' ) ) OR ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'POSITIONAL_BOUNDARY_MEMBER' IN TYPEOF ( sar . related_shape_aspect ) ) AND ( sar \ shape_aspect_relationship . name = 'boundary member' ) ) ) &gt;= 1 ) "/>
         <where label="WR5" expression=" ( NOT ( SELF \ shape_aspect . description = 'dimension related positional boundary' ) ) OR ( SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | ( pd \ property_definition . description = 'dimension related positional boundary property' ) ) ) = 1 ) "/>
         <where label="WR6" expression=" ( NOT ( SELF \ shape_aspect . description = 'profile related positional boundary' ) ) OR ( SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | ( pd \ property_definition . description = 'profile related positional boundary property' ) ) ) = 1 ) "/>
         <where label="WR7" expression=" ( NOT ( SELF \ shape_aspect . description = 'profile related positional boundary' ) ) OR ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'POSITIONAL_BOUNDARY_MEMBER' IN TYPEOF ( sar . related_shape_aspect ) ) AND ( sar \ shape_aspect_relationship . name = 'positional boundary and profile boundary member' ) ) ) = 1 ) "/>
      </entity>
      <entity name="positional_boundary_member" supertypes="shape_aspect">
         <where label="WR1" expression=" SELF \ shape_aspect . product_definitional = False "/>
         <where label="WR2" expression=" SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | ( pd \ property_definition . description = 'positional boundary member property' ) ) ) = 1 "/>
         <where label="WR3" expression=" SIZEOF ( QUERY ( sar &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT' ) | ( sar \ shape_aspect_relationship . name = 'boundary member' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'POSITIONAL_BOUNDARY' IN TYPEOF ( sar . relating_shape_aspect ) ) AND ( sar . relating_shape_aspect \ shape_aspect . description = 'dimension related positional boundary' ) ) ) = 1 "/>
      </entity>
      <entity name="statistical_dimensional_location" supertypes="dimensional_location"/>
      <entity name="statistical_dimensional_size" supertypes="dimensional_size_property">
         <where label="WR1" expression=" SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DIMENSIONAL_SIZE' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr \ property_definition_relationship . name = 'substitutable dimension' ) ) ) &lt;= 1 ) ) ) &lt;= 1 "/>
         <where label="WR2" expression=" SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'REQUIREMENTS_PROPERTY' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr \ property_definition_relationship . name = 'dimensional tolerance statistical control requirement' ) ) ) &lt;= 1 ) ) ) &lt;= 1 "/>
         <where label="WR3" expression=" ( NOT ( SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DIMENSIONAL_SIZE' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr \ property_definition_relationship . name = 'substitutable dimension' ) ) ) &lt;= 1 ) ) ) &lt;= 1 ) ) OR ( NOT ( SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DIMENSIONAL_SIZE' IN TYPEOF ( pdr . related_property_definition ) ) AND ( NOT ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'STATISTICAL_DIMENSIONAL_SIZE' IN TYPEOF ( pdr . related_property_definition ) ) ) AND ( pdr \ property_definition_relationship . name = 'substitutable dimension' ) ) ) &lt;= 1 ) ) ) &lt;= 1 ) ) "/>
      </entity>
      <entity name="statistical_geometric_tolerance" supertypes="physical_unit_geometric_tolerance">
         <where label="WR1" expression=" SIZEOF ( QUERY ( gtr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'GEOMETRIC_TOLERANCE_RELATIONSHIP.RELATED_GEOMETRIC_TOLERANCE' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PHYSICAL_UNIT_GEOMETRIC_TOLERANCE' IN TYPEOF ( gtr . relating_geometric_tolerance ) ) AND ( gtr \ geometric_tolerance_relationship . name = 'substitutable geometric tolerance' ) ) ) &lt;= 1 "/>
         <where label="WR2" expression=" SIZEOF ( QUERY ( pdr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'REQUIREMENTS_PROPERTY' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr \ property_definition_relationship . name = 'geometric tolerance statistical control requirement' ) ) ) = 1 "/>
         <where label="WR3" expression=" SIZEOF ( QUERY ( gtr &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'GEOMETRIC_TOLERANCE_RELATIONSHIP.RELATED_GEOMETRIC_TOLERANCE' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'STATISTICAL_GEOMETRIC_TOLERANCE' IN TYPEOF ( gtr . relating_geometric_tolerance ) ) AND ( gtr \ geometric_tolerance_relationship . name = 'substitutable geometric tolerance' ) ) ) &lt;= 0 "/>
      </entity>
      <entity name="tolerance_zone_boundary" supertypes="shape_aspect">
         <where label="WR1" expression=" ( NOT ( SELF \ shape_aspect . description = 'conical' ) ) OR ( NOT ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'TOLERANCE_ZONE_EXPLICIT_OPPOSING_BOUNDARY_SET' IN TYPEOF ( SELF ) ) OR ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'TOLERANCE_ZONE_IMPLICIT_OPPOSING_BOUNDARY_SET' IN TYPEOF ( SELF ) ) ) ) "/>
         <where label="WR2" expression=" ( NOT ( SELF \ shape_aspect . description = 'circular or cylindrical or spherical' ) ) OR ( NOT ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'TOLERANCE_ZONE_EXPLICIT_OPPOSING_BOUNDARY_SET' IN TYPEOF ( SELF ) ) OR ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'TOLERANCE_ZONE_IMPLICIT_OPPOSING_BOUNDARY_SET' IN TYPEOF ( SELF ) ) ) ) "/>
         <where label="WR3" expression=" SELF \ shape_aspect . product_definitional = False "/>
         <where label="WR4" expression=" NOT ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'TOLERANCE_ZONE_EXPLICIT_OPPOSING_BOUNDARY_SET' IN TYPEOF ( SELF ) ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'TOLERANCE_ZONE_IMPLICIT_OPPOSING_BOUNDARY_SET' IN TYPEOF ( SELF ) ) ) "/>
         <where label="WR5" expression=" SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | ( pd \ property_definition . description = 'boundary zone definition with specified size' ) OR ( pd \ property_definition . description = 'conical tolerance zone boundary' ) ) ) = 1 "/>
         <where label="WR6" expression=" SIZEOF ( USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'TOLERANCE_ZONE_DEFINITION.BOUNDARIES' ) ) = 1 "/>
      </entity>
      <entity name="tolerance_zone_explicit_opposing_boundary_set" supertypes="tolerance_zone_boundary"/>
      <entity name="tolerance_zone_implicit_opposing_boundary_set" supertypes="tolerance_zone_boundary"/>
      <entity name="viewing_plane" supertypes="shape_aspect">
         <where label="WR1" expression=" SELF \ shape_aspect . description = 'affected plane' "/>
         <where label="WR2" expression=" ( SIZEOF ( QUERY ( pd &lt;* USEDIN ( SELF , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.' + 'DEFINITION' ) | ( pd \ property_definition . description = 'viewing plane property' ) ) ) ) = 1 "/>
         <where label="WR3" expression=" NOT SELF \ shape_aspect . product_definitional "/>
      </entity>
      <rule name="boundary_size_characteristic_constraint" appliesto="representation">
         <where label="WR1" expression=" SIZEOF ( QUERY ( rep &lt;* representation | ( ( rep \ representation . name = 'diametrical boundary size' ) OR ( rep \ representation . name = 'opposing boundary set size' ) ) AND ( NOT ( SIZEOF ( QUERY ( lmwu &lt;* rep . items | ( lmwu \ representation_item . name = 'tolerance value' ) ) ) = 1 ) ) ) ) = 0 "/>
      </rule>
      <rule name="directed_axis_constraint" appliesto="derived_shape_aspect">
         <where label="WR1" expression=" SIZEOF ( QUERY ( dsa &lt;* derived_shape_aspect | ( dsa \ shape_aspect . description = 'directed axis' ) AND NOT ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( dsa , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( sar \ shape_aspect_relationship . name = 'derived axis' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'CENTRE_OF_SYMMETRY' IN TYPEOF ( sar \ shape_aspect_relationship . related_shape_aspect ) ) AND ( sar \ shape_aspect_relationship . related_shape_aspect \ shape_aspect . description = 'axis' ) ) ) = 1 ) ) ) = 0 "/>
         <where label="WR2" expression=" SIZEOF ( QUERY ( dsa &lt;* derived_shape_aspect | ( dsa \ shape_aspect . description = 'directed axis' ) AND NOT ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( dsa , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( sar \ shape_aspect_relationship . name = 'end shape aspect' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT' IN TYPEOF ( sar \ shape_aspect_relationship . related_shape_aspect ) ) ) ) = 1 ) ) ) = 0 "/>
         <where label="WR3" expression=" SIZEOF ( QUERY ( dsa &lt;* derived_shape_aspect | ( dsa \ shape_aspect . description = 'directed axis' ) AND NOT ( SIZEOF ( QUERY ( sar &lt;* USEDIN ( dsa , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( sar \ shape_aspect_relationship . name = 'start shape aspect' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT' IN TYPEOF ( sar \ shape_aspect_relationship . related_shape_aspect ) ) ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="directed_axis_unique_constraint" appliesto="derived_shape_aspect">
         <algorithm> LOCAL da : BAG OF derived_shape_aspect := QUERY ( r &lt;* derived_shape_aspect | ( r \ shape_aspect . description = 'directed axis' ) ) ; sar_bag : BAG OF shape_aspect_relationship ; cos_bag : BAG OF centre_of_symmetry := [ ] ; sar2_bag : BAG OF shape_aspect_relationship ; pass : BOOLEAN := TRUE ; sa_bag : BAG OF shape_aspect ; END_LOCAL ; REPEAT i := 1 to SIZEOF ( da ) by 1 ; sar_bag := QUERY ( sar &lt;* USEDIN ( da [ i ] , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( ( sar \ shape_aspect_relationship . name = 'derived axis' ) AND ( sar . related_shape_aspect \ shape_aspect . description = 'axis' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'CENTRE_OF_SYMMETRY' IN TYPEOF ( sar . related_shape_aspect ) ) ) ) ; REPEAT j := 1 to SIZEOF ( sar_bag ) by 1 ; IF EXISTS ( sar_bag [ j ] . related_shape_aspect ) THEN IF ( NOT ( sar_bag [ j ] . related_shape_aspect IN cos_bag ) ) THEN cos_bag := cos_bag + sar_bag [ j ] . related_shape_aspect ; END_IF ; END_IF ; END_REPEAT ; END_REPEAT ; REPEAT i := 1 to SIZEOF ( cos_bag ) by 1 ; IF ( NOT pass ) THEN ESCAPE ; END_IF ; sa_bag := [ ] ; sar_bag := QUERY ( sar &lt;* USEDIN ( cos_bag [ i ] , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATED_SHAPE_ASPECT' ) | ( ( sar \ shape_aspect_relationship . name = 'derived axis' ) AND ( sar . relating_shape_aspect IN da ) ) ) ; REPEAT j := 1 to SIZEOF ( sar_bag ) by 1 ; IF ( NOT pass ) THEN ESCAPE ; END_IF ; sar2_bag := QUERY ( sar &lt;* USEDIN ( sar_bag [ j ] . relating_shape_aspect , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT' ) | ( sar \ shape_aspect_relationship . name = 'start shape aspect' ) ) ; REPEAT k := 1 to SIZEOF ( sar2_bag ) by 1 ; IF EXISTS ( sar2_bag [ k ] . related_shape_aspect ) THEN IF ( sar2_bag [ k ] . related_shape_aspect IN sa_bag ) THEN pass := FALSE ; ESCAPE ; ELSE sa_bag := sa_bag + sar2_bag [ k ] . related_shape_aspect ; END_IF ; END_IF ; END_REPEAT ; END_REPEAT ; END_REPEAT ; </algorithm>
         <where label="WR1" expression=" pass "/>
      </rule>
      <rule name="direction_element_constraint" appliesto="property_definition">
         <where label="WR1" expression=" SIZEOF ( QUERY ( pd &lt;* property_definition | ( pd \ property_definition . description = 'direction element' ) AND NOT ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( pdr \ property_definition_relationship . name = 'element direction vector' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr . related_property_definition \ property_definition . description = 'datum direction_property' ) ) ) = 1 ) ) ) = 0 "/>
         <where label="WR2" expression=" SIZEOF ( QUERY ( pd &lt;* property_definition | ( pd \ property_definition . description = 'direction element' ) AND NOT ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( pdr \ property_definition_relationship . name = 'half datum plane direction vector' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr . related_property_definition \ property_definition . description = 'datum direction_property' ) ) ) = 1 ) ) ) = 0 "/>
         <where label="WR3" expression=" SIZEOF ( QUERY ( pd &lt;* property_definition | ( pd \ property_definition . description = 'direction element' ) AND NOT ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( pdr \ property_definition_relationship . name = 'direction component' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr . related_property_definition \ property_definition . description = 'datum based vector orientation' ) ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="edge_segment_vertex_constraint" appliesto="shape_aspect_relationship edge_segment_vertex">
         <algorithm> LOCAL sar : BAG OF shape_aspect_relationship := [ ] ; esv : BAG OF edge_segment_vertex := edge_segment_vertex ; pass : BOOLEAN := TRUE ; END_LOCAL ; REPEAT i := 1 to SIZEOF ( esv ) by 1 ; IF ( NOT pass ) THEN ESCAPE ; END_IF ; sar := QUERY ( sar &lt;* shape_aspect_relationship | esv [ i ] = sar \ shape_aspect_relationship . related_shape_aspect ) ; pass := ( SIZEOF ( sar ) = 2 ) ; REPEAT j := 2 to SIZEOF ( sar ) by 1 ; IF ( NOT pass ) THEN ESCAPE ; END_IF ; pass := ( ( sar [ j ] ) :&lt;&gt;: ( sar [ j - 1 ] ) ) ; IF ( NOT pass ) THEN ESCAPE ; END_IF ; pass := ( TYPEOF ( sar [ j ] ) = TYPEOF ( sar [ j - 1 ] ) ) ; IF ( NOT pass ) THEN ESCAPE ; END_IF ; pass := ( sar [ j ] . relating_shape_aspect :=: sar [ j - 1 ] . relating_shape_aspect ) ; END_REPEAT ; END_REPEAT ; </algorithm>
         <where label="WR1" expression=" pass "/>
      </rule>
      <rule name="edge_segment_vertex_unique_constraint" appliesto="edge_segment_vertex">
         <algorithm> LOCAL esv : BAG OF edge_segment_vertex := QUERY ( r &lt;* edge_segment_vertex | ( r \ shape_aspect . name = 'single datum' ) ) ; pd_bag : BAG OF property_definition ; pdr_bag : BAG OF property_definition_representation ; pass : BOOLEAN := TRUE ; desc_bag : BAG OF STRING := [ ] ; END_LOCAL ; REPEAT i := 1 to SIZEOF ( esv ) by 1 ; IF ( NOT pass ) THEN ESCAPE ; END_IF ; pd_bag := QUERY ( pd &lt;* USEDIN ( esv [ i ] , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION.DEFINITION' ) | ( pd \ property_definition . description = 'shape element characterization' ) ) ; REPEAT j := 1 to SIZEOF ( pd_bag ) by 1 ; IF ( NOT pass ) THEN ESCAPE ; END_IF ; pdr_bag := USEDIN ( pd_bag [ j ] , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION' ) ; REPEAT k := 1 to SIZEOF ( pdr_bag ) by 1 ; IF ( NOT pass ) THEN ESCAPE ; END_IF ; IF ( ( pdr_bag [ k ] . used_representation \ representation . name = 'shape element characterization' ) AND ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DESCRIPTIVE_REPRESENTATION_ITEM' IN TYPEOF ( pdr_bag [ k ] . used_representation . items [ 1 ] ) ) ) THEN IF EXISTS ( pdr_bag [ k ] . used_representation . items [ 1 ] \ descriptive_representation_item . description ) THEN IF ( pdr_bag [ k ] . used_representation . items [ 1 ] \ descriptive_representation_item . description IN desc_bag ) THEN pass := FALSE ; ESCAPE ; ELSE desc_bag := desc_bag + pdr_bag [ k ] . used_representation . items [ 1 ] \ descriptive_representation_item . description ; END_IF ; END_IF ; END_IF ; END_REPEAT ; END_REPEAT ; END_REPEAT ; </algorithm>
         <where label="WR1" expression=" pass "/>
      </rule>
      <rule name="geometric_tolerance_qualifier_constraint" appliesto="measure_qualification">
         <where label="WR1" expression=" SIZEOF ( QUERY ( mq &lt;* measure_qualification | ( ( mq \ measure_qualification . name = 'predefined geometric tolerance qualifier' ) OR ( mq \ measure_qualification . name = 'user defined geometric tolerance qualifier' ) ) AND NOT ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'MEASURE_WITH_UNIT' IN TYPEOF ( mq . qualified_measure ) ) AND ( SIZEOF ( QUERY ( pugt &lt;* USEDIN ( mq . qualified_measure , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'GEOMETRIC_TOLERANCE.MAGNITUDE' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PHYSICAL_UNIT_GEOMETRIC_TOLERANCE' IN TYPEOF ( pugt ) ) ) ) = 0 ) ) ) ) = 0 "/>
      </rule>
      <rule name="positional_boundary_member_definition_constraint" appliesto="property_definition">
         <where label="WR1" expression=" SIZEOF ( QUERY ( pd &lt;* property_definition | ( pd \ property_definition . description = 'positional boundary member property' ) AND NOT ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'POSITIONAL_BOUNDARY_MEMBER' IN TYPEOF ( pd . definition ) ) ) ) ) = 0 "/>
         <where label="WR2" expression=" SIZEOF ( QUERY ( pd &lt;* property_definition | ( pd \ property_definition . description = 'positional boundary member property' ) AND NOT ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DIMENSIONAL_SIZE_PROPERTY' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr \ property_definition_relationship . name = 'boundary member associated dimension' ) ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="positional_boundary_offset_constraint" appliesto="property_definition">
         <where label="WR1" expression=" SIZEOF ( QUERY ( pd &lt;* property_definition | ( pd \ property_definition . description = 'positional boundary offset' ) AND NOT ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'SHAPE_ASPECT_RELATIONSHIP' IN TYPEOF ( pd . definition ) ) AND ( pd . definition \ shape_aspect_relationship . name = 'positional boundary and profile boundary member' ) ) ) ) = 0 "/>
         <where label="WR2" expression=" SIZEOF ( QUERY ( pd &lt;* property_definition | ( pd \ property_definition . description = 'positional boundary offset' ) AND NOT ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATED_PROPERTY_DEFINITION' ) | ( pdr \ property_definition_relationship . name = 'boundary offset' ) AND ( pdr . relating_property_definition \ property_definition . name = 'profile related positional boundary property' ) ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="profile_related_positional_boundary_definition_constraint" appliesto="property_definition">
         <where label="WR1" expression=" SIZEOF ( QUERY ( pd &lt;* property_definition | ( pd \ property_definition . description = 'profile related positional boundary property' ) AND NOT ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'POSITIONAL_BOUNDARY' IN TYPEOF ( pd . definition ) ) AND ( pd . definition \ shape_aspect . description = 'profile related positional boundary' ) ) ) ) = 0 "/>
         <where label="WR2" expression=" SIZEOF ( QUERY ( pd &lt;* property_definition | ( pd \ property_definition . description = 'profile related positional boundary property' ) AND NOT ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( pdr . related_property_definition \ property_definition . description = 'positional boundary offset' ) AND ( pdr \ property_definition_relationship . name = 'boundary offset' ) ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="projected_zone_and_base_relationship_constraint" appliesto="projected_zone_definition">
         <where label="WR1" expression=" SIZEOF ( QUERY ( pzd &lt;* projected_zone_definition | NOT ( ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PART_TEMPLATE_DEFINITION' IN TYPEOF ( pzd . projection_end ) ) OR ( pzd . projection_end . product_definitional = TRUE ) ) ) ) = 0 "/>
      </rule>
      <rule name="projected_zone_height_characteristic_constraint" appliesto="projected_zone_definition">
         <where label="WR1" expression=" SIZEOF ( QUERY ( pzd &lt;* projected_zone_definition | NOT ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'LENGTH_MEASURE_WITH_UNIT' IN TYPEOF ( pzd . projected_length ) ) ) ) = 0 "/>
      </rule>
      <rule name="restraint_condition_constraint" appliesto="property_definition">
         <where label="WR1" expression=" SIZEOF ( QUERY ( pd &lt;* property_definition | ( ( pd \ property_definition . description = 'restraint' ) OR ( pd \ property_definition . description = 'tolerance specific restraint' ) ) AND ( SIZEOF ( QUERY ( pdr &lt;* USEDIN ( pd , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PROPERTY_DEFINITION_RELATIONSHIP.RELATING_PROPERTY_DEFINITION' ) | ( 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'REQUIREMENTS_PROPERTY' IN TYPEOF ( pdr . related_property_definition ) ) AND ( pdr \ property_definition_relationship . name = 'restraint description' ) ) ) = 0 ) ) ) = 0 "/>
      </rule>
      <rule name="shape_element_deriving_relationship_unique_constraint" appliesto="shape_aspect_deriving_relationship">
         <algorithm> LOCAL sa_bag : BAG OF shape_aspect := [ ] ; sadr_bag : BAG OF shape_aspect_deriving_relationship ; pass : BOOLEAN := TRUE ; rsa_bag : BAG OF shape_aspect ; END_LOCAL ; REPEAT i := 1 to SIZEOF ( shape_aspect_deriving_relationship ) by 1 ; IF EXISTS ( shape_aspect_deriving_relationship [ i ] . relating_shape_aspect ) THEN IF ( NOT ( shape_aspect_deriving_relationship [ i ] . relating_shape_aspect IN sa_bag ) ) THEN sa_bag := sa_bag + shape_aspect_deriving_relationship [ i ] . relating_shape_aspect ; END_IF ; END_IF ; END_REPEAT ; REPEAT i := 1 to SIZEOF ( sa_bag ) by 1 ; IF ( NOT pass ) THEN ESCAPE ; END_IF ; sadr_bag := QUERY ( r &lt;* shape_aspect_deriving_relationship | ( r . relating_shape_aspect :=: sa_bag [ i ] ) ) ; rsa_bag := [ ] ; REPEAT j := 1 to SIZEOF ( sadr_bag ) by 1 ; IF EXISTS ( sadr_bag [ j ] . related_shape_aspect ) THEN IF ( sadr_bag [ j ] . related_shape_aspect IN rsa_bag ) THEN pass := FALSE ; ESCAPE ; ELSE rsa_bag := rsa_bag + sadr_bag [ j ] . related_shape_aspect ; END_IF ; END_IF ; END_REPEAT ; END_REPEAT ; </algorithm>
         <where label="WR1" expression=" pass "/>
      </rule>
      <rule name="subtype_exclusive_dimensional_location" appliesto="dimensional_location">
         <where label="WR1" expression=" SIZEOF ( QUERY ( dl &lt;* dimensional_location | NOT ( SIZEOF ( [ 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'ANGULAR_DIMENSION_WITH_ORIENTATION' , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DIMENSIONAL_LOCATION' , 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'DIMENSIONAL_LOCATION_WITH_PATH' ] * TYPEOF ( dl ) ) &lt;= 1 ) ) ) = 0 "/>
      </rule>
      <rule name="subtype_mandatory_extended_geometric_tolerance" appliesto="geometric_tolerance">
         <where label="WR1" expression=" SIZEOF ( QUERY ( gt &lt;* geometric_tolerance | NOT ( SIZEOF ( [ 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'PHYSICAL_UNIT_GEOMETRIC_TOLERANCE' ] * TYPEOF ( gt ) ) = 1 ) ) ) = 0 "/>
      </rule>
      <rule name="subtype_mandatory_runout_zone_orientation" appliesto="runout_zone_orientation">
         <where label="WR1" expression=" SIZEOF ( QUERY ( rzo &lt;* runout_zone_orientation | NOT ( SIZEOF ( [ 'EXTENDED_GEOMETRIC_TOLERANCE_MIM.' + 'RUNOUT_ZONE_ORIENTATION_REFERENCE_DIRECTION' ] * TYPEOF ( rzo ) ) = 1 ) ) ) = 0 "/>
      </rule>
   </schema>
</express>
