<?xml version='1.0' encoding='UTF-8'?>
<!-- $Id: express2xml.js,v 1.36 2004/05/25 20:27:05 thendrix Exp $ -->
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">
<express
  language_version="2"
  description.file="mim_descriptions.xml"
  rcs.date="$Date: $"
  rcs.revision="$Revision: $">

  <application
    name="express2xml2.js"
    owner="Eurostep Limited"
    url="http://www.eurostep.com"
    version="1.36"
    source="../data/modules/extended_measure_representation/mim.exp"/>

  <schema name="Extended_measure_representation_mim">

    <interface
      kind="use"
      schema="Measure_representation_mim">
    </interface>
    <interface
      kind="use"
      schema="qualified_measure_schema">
      <interfaced.item
        name="measure_representation_item"/>
      <interfaced.item
        name="precision_qualifier"/>
      <interfaced.item
        name="qualified_representation_item"/>
      <interfaced.item
        name="standard_uncertainty"/>
      <interfaced.item
        name="type_qualifier"/>
      <interfaced.item
        name="uncertainty_qualifier"/>
    </interface>
    <interface
      kind="use"
      schema="representation_schema">
      <interfaced.item
        name="compound_representation_item"/>
    </interface>
    <interface
      kind="use"
      schema="Value_with_unit_mim">
    </interface>
    <interface
      kind="reference"
      schema="support_resource_schema">
    </interface>
    <entity
      name="value_range"
      supertypes="compound_representation_item">
      <where
        label="WR1"
        expression="('REPRESENTATION_SCHEMA.'+ 'SET_REPRESENTATION_ITEM' IN TYPEOF (item_element)) AND value_range_wr1 (item_element)">
      </where>
      <where
        label="WR2"
        expression="value_range_wr2 (item_element)">
      </where>
      <where
        label="WR3"
        expression="value_range_wr3 (item_element)">
      </where>
    </entity>

    <function
      name="value_range_wr1">
      <parameter
        name="agg">
        <aggregate
          type="AGGREGATE"/>
        <typename
          name="AGGREGATE"/>
      </parameter>
      <builtintype
        type="BOOLEAN"/>
      <algorithm>
BEGIN
IF (SIZEOF(agg) = 2) AND ((SIZEOF(QUERY (i1 &lt;* agg | (
'QUALIFIED_MEASURE_SCHEMA.MEASURE_REPRESENTATION_ITEM' IN TYPEOF
(i1)))) = 2) OR
(SIZEOF(QUERY (i2 &lt;* agg | (
'REPRESENTATION_SCHEMA.VALUE_REPRESENTATION_ITEM' IN TYPEOF
(i2)))) = 2)) THEN
RETURN(TRUE);
ELSE
RETURN(FALSE);
END_IF;
END;
      </algorithm>
    </function>

    <function
      name="value_range_wr2">
      <parameter
        name="agg">
        <aggregate
          type="AGGREGATE"/>
        <typename
          name="AGGREGATE"/>
      </parameter>
      <builtintype
        type="BOOLEAN"/>
      <algorithm>
BEGIN
IF (SIZEOF(QUERY (i &lt;* agg | (i.name = 'upper limit'))) = 1)
AND (SIZEOF(QUERY (i &lt;* agg | (i.name = 'lower limit'))) = 1)
THEN
RETURN(TRUE);
ELSE
RETURN(FALSE);
END_IF;
END;
      </algorithm>
    </function>

    <function
      name="value_range_wr3">
      <parameter
        name="agg">
        <aggregate
          type="AGGREGATE"/>
        <typename
          name="AGGREGATE"/>
      </parameter>
      <builtintype
        type="BOOLEAN"/>
      <algorithm>
BEGIN
IF (SIZEOF(QUERY(i1 &lt;* agg |
('QUALIFIED_MEASURE_SCHEMA.MEASURE_REPRESENTATION_ITEM' IN TYPEOF (i1)) AND
(SIZEOF (QUERY (i2 &lt;* agg |
('QUALIFIED_MEASURE_SCHEMA.MEASURE_REPRESENTATION_ITEM' IN TYPEOF (i2)) AND
(i1 :&lt;&gt;: i2) AND (i1\measure_with_unit.unit_component :=: i2\measure_with_unit.unit_component))) = 1))) = 2)
THEN
RETURN (TRUE);
ELSE
RETURN (FALSE);
END_IF;
END;
      </algorithm>
    </function>

    <rule
      name="subtype_exclusiveness_representation_item"
      appliesto="representation_item">
      <where
        label="WR1"
        expression="SIZEOF(QUERY (cri &lt;* representation_item | NOT (type_check_function(cri,['QUALIFIED_MEASURE_SCHEMA.MEASURE_REPRESENTATION_ITEM','REPRESENTATION_SCHEMA.VALUE_REPRESENTATION_ITEM','REPRESENTATION_SCHEMA.COMPOUND_REPRESENTATION_ITEM'] , 3)))) = 0">
      </where>
    </rule>

  </schema>
</express>
