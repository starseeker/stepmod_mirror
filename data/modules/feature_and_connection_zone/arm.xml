<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express description.file="arm_descriptions.xml" language_version="2" rcs.date="$Date$" rcs.revision="$Revision$" reference="ISO/TS 10303-1671">
   <application name="JSDAI" owner="LKSoft" source="feature_and_connection_zone_arm schema_instance" url="www.lksoft.com" version="4.0 beta"/>
   <schema name="Feature_and_connection_zone_arm">
      <interface kind="use" schema="Shape_feature_arm"/>
      <interface kind="use" schema="Surface_conditions_arm"/>
      <interface kind="reference" schema="Support_resource_arm">
         <interfaced.item name="bag_to_set"/>
      </interface>
      <entity abstract.entity="NO" abstract.supertype="YES" name="Connection_zone" supertypes="Shape_element">
         <derived expression="bag_to_set(USEDIN(SELF,'SURFACE_CONDITIONS_ARM.SURFACE_CONDITION_ASSOCIATION.DESCRIBED_ELEMENT'))" name="surface_conditions">
            <aggregate lower="0" optional="NO" type="SET" unique="NO" upper="?"/>
            <typename name="Surface_condition"/>
         </derived>
         <where expression="(SIZEOF(USEDIN(SELF, 'FEATURE_AND_CONNECTION_ZONE_ARM.FEATURE_DEFINITION_WITH_CONNECTION_AREA.CONNECTION_AREA')) +&#10;         SIZEOF(USEDIN(SELF, 'FEATURE_AND_CONNECTION_ZONE_ARM.SHAPE_FEATURE.CONNECTION_AREA')))&#10;         = 1" label="WR1"/>
         <where expression="NOT EXISTS (SELF\Shape_element.description)" label="WR2"/>
         <where expression="NOT EXISTS (SELF\Shape_element.element_name)" label="WR3"/>
      <where label="IP1"/>
         <where label="IP2"/>
         <where label="IP3"/>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="YES" name="Definitional_shape_element" supertypes="Shape_element">
         <explicit name="connection_area" optional="YES">
            <aggregate lower="1" optional="NO" type="SET" unique="NO" upper="?"/>
            <typename name="Connection_zone"/>
         </explicit>
         <derived expression="facz_get_sc(SELF)" name="surface_conditions">
            <aggregate lower="0" optional="NO" type="SET" unique="NO" upper="?"/>
            <typename name="Surface_condition"/>
         </derived>
         <unique label="UR1">
            <unique.attribute attribute="SELF\Shape_element.element_name"/>
            <unique.attribute attribute="SELF\Shape_element.containing_shape"/>
         </unique>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Feature_definition_with_connection_area" supertypes="Shape_feature_definition">
         <explicit name="connection_area" optional="YES">
            <aggregate lower="1" optional="NO" type="SET" unique="NO" upper="?"/>
            <typename name="Connection_zone"/>
         </explicit>
      </entity>
      <entity abstract.entity="NO" abstract.supertype="NO" name="Non_definitional_shape_element" supertypes="Shape_element"/>
      <subtype.constraint abstract.supertype="NO" entity="Shape_element" name="fac_shape_element" super.expression="(ONEOF (Instanced_feature, Placed_feature) ANDOR ONEOF (Definitional_shape_element, Non_definitional_shape_element))"/>
      <function name="facz_get_sc">
         <parameter name="input">
            <typename name="Definitional_shape_element"/>
         </parameter>
         <aggregate lower="0" optional="NO" type="SET" unique="NO" upper="?"/>
         <typename name="Surface_condition"/>
         <algorithm>LOCAL
    sca : SET OF Surface_condition_association := 
	         bag_to_set(USEDIN(input,'SURFACE_CONDITIONS_ARM.SURFACE_CONDITION_ASSOCIATION.DESCRIBED_ELEMENT'));
	sc  : SET OF Surface_condition := [];       
  END_LOCAL;
   REPEAT i := 1 TO HIINDEX(sca);
     sc := sc + sca[i]\Surface_condition_association.used_representation;
   END_REPEAT;
   RETURN (sc);</algorithm>
      </function>
   </schema>
</express>
