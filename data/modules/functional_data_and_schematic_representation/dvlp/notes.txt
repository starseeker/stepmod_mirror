The SHTOLO algorithm leaves an empty select:

TYPE characterized_definition = SELECT 
  ();
END_TYPE;

so replace with

TYPE characterized_definition = SELECT 
  (characterized_product_definition);
END_TYPE;

TYPE characterized_product_definition = SELECT
   (product_definition);
END_TYPE; 
