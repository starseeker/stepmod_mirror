<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express description.file="arm_descriptions.xml" language_version="2" rcs.date="$Date$" rcs.revision="$Revision$" reference="">
   <application name="JSDAI" owner="LKSoft" source="general_design_connectivity_arm schema_instance" url="www.lksoft.com" version="4.0 beta"/>
   <schema name="General_design_connectivity_arm">
      <interface kind="use" schema="Assembly_constraints_arm"/>
      <interface kind="use" schema="Design_product_data_management_arm"/>
      <interface kind="use" schema="Item_definition_structure_arm"/>
      <interface kind="use" schema="Part_shape_arm"/>
      <interface kind="use" schema="Shape_feature_arm"/>
      <type name="assembly_constraint_select">
         <select selectitems="Binary_assembly_constraint Fixed_constituent_assembly_constraint"/>
      </type>
      <type name="assembly_constraint_type_enumeration">
         <enumeration extensible="YES" items="coaxial_assembly_constraint complex dimensioned_angle_assembly_constraint dimensioned_parallel_assembly_constraint dimensioned_surface_distance_assembly_constraint fixed_constituent_assembly_constraint incidence_assembly_constraint parallel_assembly_constraint perpendicular_assembly_constraint tangent_assembly_constraint"/>
      </type>
      <type name="assembly_definition_or_assembly_shape_constraint">
         <select selectitems="Assembly_definition Assembly_shape_constraint"/>
      </type>
      <type name="assembly_definition_or_assembly_shape_joint">
         <select selectitems="Assembly_definition Assembly_shape_joint"/>
      </type>
      <type name="connected_terminal_select">
         <select selectitems="General_part_terminal Occurrence_terminal"/>
      </type>
      <type name="gdc_shapeable_item">
         <select basedon="shapeable_item" selectitems="Shape_element"/>
      </type>
      <type name="general_assembly_joint_type_enumeration">
         <enumeration extensible="YES"/>
      </type>
      <type name="general_part_terminal_associated_definition_select">
         <select selectitems="General_part_terminal Part_view_definition"/>
      </type>
      <type name="general_terminal_joint_type_enumeration">
         <enumeration extensible="YES"/>
      </type>
      <type name="join_or_interface_terminal_enumeration">
         <enumeration items="interface_terminal join_terminal"/>
      </type>
      <type name="occurrence_contact_feature_associated_definition_select">
         <select selectitems="Occurrence_contact_feature Product_occurrence"/>
      </type>
      <type name="occurrence_contact_feature_definition_select">
         <select selectitems="Occurrence_contact_feature Part_contact_feature Contact_feature_definition"/>
      </type>
      <type name="occurrence_shape_element_associated_definition_select">
         <select selectitems="Occurrence_shape_element Product_occurrence"/>
      </type>
      <type name="occurrence_shape_element_definition_select">
         <select selectitems="Occurrence_shape_element Part_shape_element Shape_feature_definition"/>
      </type>
      <type name="occurrence_shape_feature_associated_definition_select">
         <select selectitems="Occurrence_shape_feature Product_occurrence"/>
      </type>
      <type name="occurrence_shape_feature_definition_select">
         <select selectitems="General_part_feature Occurrence_shape_feature Shape_feature_definition"/>
      </type>
      <type name="occurrence_terminal_associated_definition_select">
         <select selectitems="Occurrence_terminal Product_occurrence"/>
      </type>
      <type name="occurrence_terminal_definition_select">
         <select selectitems="Contact_feature_definition General_part_terminal Occurrence_terminal"/>
      </type>
      <type name="occurrence_transport_feature_associated_definition_select">
         <select selectitems="Occurrence_transport_feature Product_occurrence"/>
      </type>
      <type name="part_contact_feature_associated_definition_select">
         <select selectitems="Part_view_definition Part_contact_feature"/>
      </type>
      <type name="part_transport_feature_associated_definition_select">
         <select selectitems="Part_transport_feature Part_view_definition"/>
      </type>
      <type name="shape_feature_definition_or_relationship_select">
         <select selectitems="Contact_feature_definition_fit_relationship Shape_feature_definition"/>
      </type>
      <type name="transport_feature_type_enumeration">
         <enumeration extensible="YES" items="electrical thermal optical magnetic matter"/>
      </type>
      <entity name="Assembly_shape_constraint" supertypes="Part_shape_element">
         <explicit name="associated_definition">
            <typename name="assembly_definition_or_assembly_shape_constraint"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="definition" optional="YES">
            <typename name="shape_feature_definition_or_relationship_select"/>
            <redeclaration entity-ref="Part_shape_element"/>
         </explicit>
         <explicit name="identified_item" optional="YES">
            <typename name="assembly_constraint_select"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="constraint_type" optional="YES">
            <typename name="assembly_constraint_type_enumeration"/>
         </explicit>
      </entity>
      <entity name="Assembly_shape_constraint_item_relationship" supertypes="Shape_element_relationship">
         <explicit name="relating">
            <typename name="Assembly_shape_constraint"/>
            <redeclaration entity-ref="Shape_element_relationship"/>
         </explicit>
         <explicit name="related">
            <typename name="Occurrence_shape_feature"/>
            <redeclaration entity-ref="Shape_element_relationship"/>
         </explicit>
         <where expression="main_associated_definition(relating\Assembly_shape_constraint.associated_definition) &#10;       IN &#10;       main_upper_usage( main_associated_definition(related))/Product_occurrence.occurrence_contexts" label="WR1"/>
      </entity>
      <entity name="Assembly_shape_joint" supertypes="Part_shape_element">
         <explicit name="associated_definition">
            <typename name="assembly_definition_or_assembly_shape_joint"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="definition" optional="YES">
            <typename name="shape_feature_definition_or_relationship_select"/>
            <redeclaration entity-ref="Part_shape_element"/>
         </explicit>
         <explicit name="joint_type" optional="YES">
            <typename name="general_assembly_joint_type_enumeration"/>
         </explicit>
      </entity>
      <entity name="Assembly_shape_joint_item_relationship" supertypes="Shape_element_relationship">
         <explicit name="relating">
            <typename name="Assembly_shape_joint"/>
            <redeclaration entity-ref="Shape_element_relationship"/>
         </explicit>
         <explicit name="related">
            <typename name="Occurrence_shape_feature"/>
            <redeclaration entity-ref="Shape_element_relationship"/>
         </explicit>
         <where expression="main_associated_definition(relating\Assembly_shape_joint.associated_definition) &#10;       IN &#10;       main_upper_usage( main_associated_definition(related))/Product_occurrence.occurrence_contexts" label="WR1"/>
      </entity>
      <entity name="Contact_feature_definition" supertypes="Shape_feature_definition"/>
      <entity name="Contact_feature_definition_fit_relationship" supertypes="Shape_feature_definition_relationship">
         <explicit name="relating">
            <typename name="Contact_feature_definition"/>
            <redeclaration entity-ref="Shape_feature_definition_relationship"/>
         </explicit>
         <explicit name="related">
            <typename name="Contact_feature_definition"/>
            <redeclaration entity-ref="Shape_feature_definition_relationship"/>
         </explicit>
         <explicit name="joint_type" optional="YES">
            <typename name="general_assembly_joint_type_enumeration"/>
         </explicit>
      </entity>
      <entity name="General_part_terminal" supertypes="Part_contact_feature">
         <explicit name="associated_definition">
            <typename name="general_part_terminal_associated_definition_select"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="associated_transport_feature" optional="YES">
            <typename name="Part_transport_feature"/>
         </explicit>
         <explicit name="intended_joint_type" optional="YES">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="general_terminal_joint_type_enumeration"/>
         </explicit>
         <explicit name="join_or_interface_terminal" optional="YES">
            <typename name="join_or_interface_terminal_enumeration"/>
         </explicit>
         <where expression="main_associated_definition(SELF) :=: main_associated_definition(associated_transport_feature)" label="WR1"/>
      </entity>
      <entity name="Occurrence_contact_feature" super.expression="Occurrence_terminal" supertypes="Occurrence_shape_feature">
         <explicit name="associated_definition">
            <typename name="occurrence_contact_feature_associated_definition_select"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="definition" optional="YES">
            <typename name="occurrence_contact_feature_definition_select"/>
            <redeclaration entity-ref="Occurrence_shape_feature"/>
         </explicit>
      </entity>
      <entity name="Occurrence_shape_element" supertypes="Shape_element">
         <explicit name="associated_definition">
            <typename name="occurrence_shape_element_associated_definition_select"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="definition" optional="YES">
            <typename name="occurrence_shape_element_definition_select"/>
         </explicit>
         <unique label="UR1">
            <unique.attribute attribute="definition"/>
            <unique.attribute attribute="associated_definition"/>
         </unique>
         <unique label="UR2">
            <unique.attribute attribute="SELF\Shape_element.element_name"/>
            <unique.attribute attribute="associated_definition"/>
         </unique>
         <where expression="acyclic_occurrence_shape_element(SELF,definition)" label="WR1"/>
      </entity>
      <entity name="Occurrence_shape_feature" super.expression="ONEOF (Occurrence_contact_feature, Occurrence_transport_feature)" supertypes="Occurrence_shape_element">
         <explicit name="associated_definition">
            <typename name="occurrence_shape_feature_associated_definition_select"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="definition" optional="YES">
            <typename name="occurrence_shape_feature_definition_select"/>
            <redeclaration entity-ref="Occurrence_shape_element"/>
         </explicit>
         <derived expression="TRUE" name="product_definitional">
            <builtintype type="BOOLEAN"/>
            <redeclaration entity-ref="Shape_element"/>
         </derived>
      </entity>
      <entity name="Occurrence_terminal" supertypes="Occurrence_contact_feature">
         <explicit name="associated_definition">
            <typename name="occurrence_terminal_associated_definition_select"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="definition">
            <typename name="occurrence_terminal_definition_select"/>
            <redeclaration entity-ref="Occurrence_shape_element"/>
         </explicit>
         <explicit name="associated_transport_feature" optional="YES">
            <typename name="Occurrence_transport_feature"/>
         </explicit>
         <where expression="main_associated_definition(associated_transport_feature.associated_definition) :=: main_associated_definition(associated_definition)" label="WR1"/>
      </entity>
      <entity name="Occurrence_transport_feature" supertypes="Occurrence_shape_feature">
         <explicit name="associated_definition">
            <typename name="occurrence_transport_feature_associated_definition_select"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="definition" optional="YES">
            <typename name="Part_transport_feature"/>
            <redeclaration entity-ref="Occurrence_shape_element"/>
         </explicit>
         <explicit name="transport_feature_type" optional="YES">
            <typename name="transport_feature_type_enumeration"/>
         </explicit>
      </entity>
      <entity name="Part_connectivity_definition" supertypes="Part_shape_element">
         <explicit name="connected_terminals">
            <aggregate lower="2" type="SET" upper="?"/>
            <typename name="connected_terminal_select"/>
         </explicit>
         <where expression="terminal_usage_check( main_associated_definition(associated_definition), connected_terminals)" label="WR1"/>
      </entity>
      <entity name="Part_contact_feature" supertypes="General_part_feature">
         <explicit name="associated_definition" optional="YES">
            <typename name="part_contact_feature_associated_definition_select"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="definition" optional="YES">
            <typename name="Contact_feature_definition"/>
            <redeclaration entity-ref="Part_shape_element"/>
         </explicit>
      </entity>
      <entity name="Part_contact_feature_fit_relationship" supertypes="Part_shape_element_relationship">
         <explicit name="relating">
            <typename name="Part_contact_feature"/>
            <redeclaration entity-ref="Shape_element_relationship"/>
         </explicit>
         <explicit name="related">
            <typename name="Part_contact_feature"/>
            <redeclaration entity-ref="Shape_element_relationship"/>
         </explicit>
         <explicit name="definition" optional="YES">
            <typename name="Contact_feature_definition_fit_relationship"/>
         </explicit>
         <explicit name="sub_relationships" optional="YES">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="Part_contact_feature_fit_relationship"/>
         </explicit>
      </entity>
      <entity name="Part_transport_feature" supertypes="General_part_feature">
         <explicit name="associated_definition" optional="YES">
            <typename name="part_transport_feature_associated_definition_select"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
         <explicit name="transport_feature_type" optional="YES">
            <typename name="transport_feature_type_enumeration"/>
         </explicit>
      </entity>
      <entity name="Shape_feature_definition_relationship">
         <explicit name="name">
            <typename name="label"/>
         </explicit>
         <explicit name="description" optional="YES">
            <typename name="text"/>
         </explicit>
         <explicit name="relating">
            <typename name="Shape_feature_definition"/>
         </explicit>
         <explicit name="related">
            <typename name="Shape_feature_definition"/>
         </explicit>
      </entity>
      <subtype.constraint entity="General_part_feature" name="gdc_general_part_feature_subtypes" super.expression="ONEOF (Part_transport_feature, Part_contact_feature)"/>
      <subtype.constraint entity="Part_shape_element" name="gdc_part_shape_element_subtypes" super.expression="ONEOF (Assembly_shape_constraint, Assembly_shape_joint, Part_connectivity_definition)"/>
      <subtype.constraint entity="Shape_element" name="gdc_shape_element_subtypes" super.expression="ONEOF (Part_shape_element, Occurrence_shape_element)"/>
      <rule appliesto="Shape_element" name="shape_elements_are_acyclic">
         <where expression="SIZEOF(QUERY(se &lt;* Shape_element | NOT acyclic_shape_element(se, se.associated_definition) )) = 0" label="WR1"/>
      </rule>
      <function name="acyclic_occurrence_shape_element">
         <parameter name="sao">
            <typename name="Occurrence_shape_element"/>
         </parameter>
         <parameter name="definition">
            <typename name="occurrence_shape_element_definition_select"/>
         </parameter>
         <builtintype type="BOOLEAN"/>
         <algorithm>IF NOT (('GENERAL_DESIGN_CONNECTIVITY_ARM.OCCURRENCE_SHAPE_ELEMENT') IN TYPEOF(definition)) THEN
      RETURN  (TRUE);
    END_IF;
    IF  (definition :=: sao) THEN
      RETURN  (FALSE);
    ELSE 
      RETURN(acyclic_occurrence_shape_element(sao, definition\Occurrence_shape_element.definition));
    END_IF;</algorithm>
      </function>
      <function name="acyclic_shape_element">
         <parameter name="se">
            <typename name="Shape_element"/>
         </parameter>
         <parameter name="associated_definition">
            <typename name="occurrence_shape_element_definition_select"/>
         </parameter>
         <builtintype type="BOOLEAN"/>
         <algorithm>IF NOT (('SHAPE_PROPERTY_ASSIGNMENT_ARM.SHAPE_ELEMENT') IN TYPEOF(associated_definition)) THEN
      RETURN  (TRUE);
    END_IF;
    IF  (associated_definition :=: se) THEN
      RETURN  (FALSE);
    ELSE 
      RETURN(acyclic_shape_element(se, associated_definition\Shape_element.associated_definition));
    END_IF;</algorithm>
      </function>
      <function name="main_associated_definition">
         <parameter name="se">
            <typename name="Shape_element"/>
         </parameter>
         <typename name="shapeable_item"/>
         <algorithm>IF NOT (('GENERAL_DESIGN_CONNECTIVITY_ARM.SHAPE_ELEMENT') IN TYPEOF(se.associated_definition)) THEN
      RETURN  (se.associated_definition);
    ELSE 
      RETURN(main_associated_definition(se.associated_definition));
    END_IF;</algorithm>
      </function>
      <function name="main_upper_usage">
         <parameter name="po">
            <typename name="Product_occurrence"/>
         </parameter>
         <typename name="Product_occurrence"/>
         <algorithm>IF NOT (('PRODUCT_OCCURRENCE_ARM.SPECIFIED_OCCURRENCE') IN TYPEOF(po)) THEN
      RETURN  (po);
    ELSE 
      RETURN(main_upper_usage(po\Specified_occurrence.upper_usage));
    END_IF;</algorithm>
      </function>
      <function name="terminal_usage_check">
         <parameter name="p">
            <typename name="Part_view_definition"/>
         </parameter>
         <parameter name="terminals">
            <aggregate lower="0" type="SET" upper="?"/>
            <typename name="connected_terminal_select"/>
         </parameter>
         <builtintype type="BOOLEAN"/>
         <algorithm>REPEAT i := 1 TO HIINDEX(terminals) BY 1;
		IF 'GENERAL_DESIGN_CONNECTIVITY_ARM.GENERAL_PART_TERMINAL' IN TYPEOF(terminals[i]) THEN
			IF p :&lt;&gt;: terminals[i]\General_part_terminal.associated_definition THEN
				RETURN(FALSE);
			END_IF;
		ELSE 
			IF 'GENERAL_DESIGN_CONNECTIVITY_ARM.OCCURRENCE_TERMINAL' IN TYPEOF(terminals[i]) THEN
				IF NOT(p IN main_upper_usage( main_associated_definition(terminals[i]))/Product_occurrence.occurrence_contexts) THEN
					RETURN(FALSE);
				END_IF;
			ELSE
				RETURN (FALSE);
			END_IF;
		END_IF;
	END_REPEAT;
	RETURN(TRUE);</algorithm>
      </function>
   </schema>
</express>
