<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express description.file="arm_descriptions.xml" language_version="2" rcs.date="$Date$" rcs.revision="$Revision$" reference="ISO/TS 10303-1051">
   <application name="JSDAI" owner="LKSoft" source="geometric_tolerance_arm schema_instance" url="www.lksoft.com" version="4.0 beta"/>
   <schema name="Geometric_tolerance_arm">
      <interface kind="use" schema="Derived_shape_element_arm"/>
      <interface kind="use" schema="Measure_representation_arm"/>
      <interface kind="use" schema="Value_with_unit_extension_arm"/>
      <interface kind="use" schema="Support_resource_arm"/>
      <interface kind="use" schema="Shape_composition_arm"/>
      <interface kind="use" schema="Dimension_tolerance_arm"/>
      <interface kind="use" schema="Feature_and_connection_zone_arm"/>
      <type name="area_unit_type">
         <enumeration extensible="YES" items="circular square rectangular"/>
      </type>
      <type name="collection_plane_orientation">
         <enumeration extensible="YES" items="perpendicular parallel"/>
      </type>
      <type name="common_datum_list">
         <aggregate lower="1" type="LIST" upper="?"/>
         <typename name="Datum_reference_element"/>
      </type>
      <type name="datum_or_common_datum">
         <select selectitems="common_datum_list Datum"/>
      </type>
      <type name="datum_reference_modifier">
         <select extensible="YES" selectitems="Datum_reference_modifier_with_value simple_datum_reference_modifier"/>
      </type>
      <type name="datum_reference_modifier_type">
         <enumeration extensible="YES" items="circular_or_cylindrical spherical distance projected"/>
      </type>
      <type name="directed_or_oriented_geometric_tolerance_select">
         <select selectitems="Line_profile_tolerance Parallelism_tolerance Perpendicularity_tolerance Position_tolerance Straightness_tolerance Symmetry_tolerance"/>
      </type>
      <type name="directed_tolerance_zone_type">
         <enumeration items="perpendicular parallel including"/>
      </type>
      <type name="geometric_tolerance_modifier">
         <enumeration extensible="YES" items="maximum_material_requirement least_material_requirement reciprocity_requirement any_cross_section free_state common_zone minor_diameter major_diameter pitch_diameter line_element not_convex statistical_tolerance tangent_plane each_radial_element separate_requirement"/>
      </type>
      <type name="geometric_tolerance_target">
         <select extensible="YES" genericentity="YES" selectitems="Dimensional_location Dimensional_size"/>
      </type>
      <type name="oriented_tolerance_zone_type">
         <enumeration items="perpendicular parallel angular"/>
      </type>
      <type name="simple_datum_reference_modifier">
         <enumeration extensible="YES" items="free_state basic translation least_material_requirement maximum_material_requirement point line plane orientation any_cross_section any_longitudinal_section contacting_feature distance_variable degree_of_freedom_constraint_x degree_of_freedom_constraint_y degree_of_freedom_constraint_z degree_of_freedom_constraint_u degree_of_freedom_constraint_v degree_of_freedom_constraint_w minor_diameter major_diameter pitch_diameter"/>
      </type>
      <type name="tolerance_zone_target">
         <select selectitems="Dimensional_location Dimensional_size General_datum_reference Geometric_tolerance"/>
      </type>
      <type name="tolerance_zone_type">
         <enumeration items="within_a_circle between_two_concentric_circles between_two_equidistant_curves within_a_cylinder between_two_coaxial_cylinders between_two_equidistant_surfaces non_uniform cylindrical_or_circular spherical not_known"/>
      </type>
      <entity name="Affected_plane_tolerance_zone" supertypes="Directed_or_oriented_tolerance_zone">
         <explicit name="affected_plane">
            <typename name="Axis_placement_shape_element"/>
         </explicit>
      </entity>
      <entity name="All_around_shape_element" supertypes="Continuous_shape_element"/>
      <entity name="All_around_shape_element_along_collection_plane" supertypes="All_around_shape_element">
         <explicit name="base">
            <typename name="Datum_system"/>
         </explicit>
         <explicit name="orientation">
            <typename name="collection_plane_orientation"/>
         </explicit>
      </entity>
      <entity name="Angularity_tolerance" supertypes="Geometric_tolerance">
         <explicit name="datum_system">
            <typename name="Datum_system"/>
         </explicit>
      </entity>
      <entity name="Axis_placement_shape_element" supertypes="Shape_element">
         <explicit name="identified_item">
            <typename name="Axis_placement"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
      </entity>
      <entity name="Between_shape_element" supertypes="Continuous_shape_element">
         <explicit name="start_features">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="Shape_element"/>
         </explicit>
         <explicit name="end_features">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="Shape_element"/>
         </explicit>
         <where expression="SIZEOF(QUERY(s &lt;* start_features | NOT (s.product_definitional = TRUE))) = 0" label="WR1"/>
         <where expression="SIZEOF(QUERY(s &lt;* end_features | NOT (s.product_definitional = TRUE))) = 0" label="WR2"/>
      </entity>
      <entity name="Circular_runout_tolerance" supertypes="Geometric_tolerance">
         <explicit name="angle" optional="YES">
            <builtintype type="REAL"/>
         </explicit>
         <explicit name="datum_system">
            <typename name="Datum_system"/>
         </explicit>
      </entity>
      <entity name="Coaxiality_tolerance" supertypes="Geometric_tolerance">
         <explicit name="datum_system">
            <typename name="Datum_system"/>
         </explicit>
      </entity>
      <entity name="Concentricity_tolerance" supertypes="Geometric_tolerance">
         <explicit name="datum_system">
            <typename name="Datum_system"/>
         </explicit>
      </entity>
      <entity name="Contacting_feature" supertypes="Shape_element">
         <derived expression="FALSE" name="product_definitional">
            <builtintype type="BOOLEAN"/>
            <redeclaration entity-ref="Shape_element"/>
         </derived>
      </entity>
      <entity name="Continuous_shape_element" super.expression="ONEOF (Between_shape_element, All_around_shape_element)" supertypes="Composite_shape_element"/>
      <entity name="Cylindricity_tolerance" supertypes="Geometric_tolerance"/>
      <entity name="Datum" supertypes="Shape_element">
         <explicit name="identification">
            <typename name="identifier"/>
         </explicit>
      </entity>
      <entity name="Datum_feature" super.expression="ONEOF (Dimensional_location_with_datum_feature, Dimensional_size_with_datum_feature)" supertypes="Shape_element">
         <explicit name="of_datum">
            <typename name="Datum"/>
         </explicit>
         <derived expression="TRUE" name="product_definitional">
            <builtintype type="BOOLEAN"/>
            <redeclaration entity-ref="Shape_element"/>
         </derived>
         <unique label="UR1">
            <unique.attribute attribute="of_datum"/>
         </unique>
      </entity>
      <entity name="Datum_reference_compartment" supertypes="General_datum_reference">
         <explicit name="point_situation_feature" optional="YES">
            <typename name="Point_shape_element"/>
         </explicit>
         <explicit name="plane_situation_feature" optional="YES">
            <typename name="Plane_shape_element"/>
         </explicit>
         <explicit name="straight_line_situation_feature" optional="YES">
            <typename name="Axis_placement_shape_element"/>
         </explicit>
         <inverse attribute="constituents" entity="Datum_system" name="owner"/>
      </entity>
      <entity name="Datum_reference_element" supertypes="General_datum_reference">
         <derived expression="sts_get_general_datum_reference(SELF)" name="usage">
            <typename name="General_datum_reference"/>
         </derived>
         <where expression="SELF &lt;&gt; usage" label="WR1"/>
         <where expression="EXISTS(usage)" label="WR2"/>
      </entity>
      <entity name="Datum_reference_modifier_with_value">
         <explicit name="modifier_type">
            <typename name="datum_reference_modifier_type"/>
         </explicit>
         <explicit name="modifier_value">
            <typename name="Length_data_element"/>
         </explicit>
      </entity>
      <entity name="Datum_system" supertypes="Shape_element">
         <explicit name="constituents">
            <aggregate lower="1" type="LIST" unique="YES" upper="3"/>
            <typename name="Datum_reference_compartment"/>
         </explicit>
         <derived expression="FALSE" name="product_definitional">
            <builtintype type="BOOLEAN"/>
            <redeclaration entity-ref="Shape_element"/>
         </derived>
      </entity>
      <entity name="Datum_system_with_associated_model_coordinate_system" supertypes="Axis_placement_shape_element Datum_system"/>
      <entity abstract.supertype="YES" name="Datum_target" super.expression="ONEOF (Placed_target, Target_area, Target_curve)" supertypes="Shape_element">
         <explicit name="target_id">
            <builtintype type="STRING"/>
         </explicit>
         <explicit name="movement_direction" optional="YES">
            <typename name="Direction"/>
         </explicit>
         <explicit name="of_datum">
            <typename name="Datum"/>
         </explicit>
         <explicit name="target_feature" optional="YES">
            <typename name="Shape_element"/>
         </explicit>
         <unique label="UR1">
            <unique.attribute attribute="of_datum"/>
            <unique.attribute attribute="target_id"/>
         </unique>
      </entity>
      <entity name="Dimensional_location_with_datum_feature" supertypes="Datum_feature Dimensional_location"/>
      <entity name="Dimensional_size_with_datum_feature" supertypes="Datum_feature Dimensional_size"/>
      <entity abstract.supertype="YES" name="Directed_or_oriented_tolerance_zone" super.expression="ONEOF (Tolerance_zone_with_datum, Affected_plane_tolerance_zone)" supertypes="Tolerance_zone">
         <explicit name="zone_for">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="directed_or_oriented_geometric_tolerance_select"/>
            <redeclaration entity-ref="Tolerance_zone"/>
         </explicit>
      </entity>
      <entity name="Directed_tolerance_zone" supertypes="Tolerance_zone_with_datum">
         <explicit name="direction">
            <typename name="directed_tolerance_zone_type"/>
         </explicit>
      </entity>
      <entity name="Flatness_tolerance" supertypes="Geometric_tolerance"/>
      <entity abstract.supertype="YES" name="General_datum_reference" super.expression="ONEOF (Datum_reference_compartment, Datum_reference_element)" supertypes="Shape_element">
         <explicit name="base">
            <typename name="datum_or_common_datum"/>
         </explicit>
         <explicit name="modifiers" optional="YES">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="datum_reference_modifier"/>
         </explicit>
         <derived expression="FALSE" name="product_definitional">
            <builtintype type="BOOLEAN"/>
            <redeclaration entity-ref="Shape_element"/>
         </derived>
      </entity>
      <entity abstract.supertype="YES" name="Geometric_tolerance" super.expression="ONEOF (Angularity_tolerance, Circular_runout_tolerance, Coaxiality_tolerance, Concentricity_tolerance, Cylindricity_tolerance, Flatness_tolerance, Line_profile_tolerance, Parallelism_tolerance, Perpendicularity_tolerance, Position_tolerance, Roundness_tolerance, Straightness_tolerance, Surface_profile_tolerance, Symmetry_tolerance, Total_runout_tolerance)">
         <explicit name="id" optional="YES">
            <typename name="identifier"/>
         </explicit>
         <explicit name="name" optional="YES">
            <typename name="label"/>
         </explicit>
         <explicit name="applied_to">
            <typename name="geometric_tolerance_target"/>
         </explicit>
         <explicit name="modifiers">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="geometric_tolerance_modifier"/>
         </explicit>
         <explicit name="qualifying_note" optional="YES">
            <builtintype type="STRING"/>
         </explicit>
         <explicit name="first_unit_size" optional="YES">
            <typename name="Length_data_element"/>
         </explicit>
         <explicit name="area_unit_type" optional="YES">
            <typename name="area_unit_type"/>
         </explicit>
         <explicit name="second_unit_size" optional="YES">
            <typename name="Length_data_element"/>
         </explicit>
         <explicit name="tolerance_value">
            <typename name="Value_with_unit"/>
         </explicit>
         <explicit name="unequally_disposed_tolerance_zone_displacement" optional="YES">
            <typename name="Length_data_element"/>
         </explicit>
         <where expression="(NOT (EXISTS(first_unit_size))) OR ('GEOMETRIC_TOLERANCE_ARM.LENGTH_MEASURE' IN TYPEOF(first_unit_size.value_component))" label="WR1"/>
      </entity>
      <entity name="Geometric_tolerance_relationship">
         <explicit name="relation_type">
            <builtintype type="STRING"/>
         </explicit>
         <explicit name="relating">
            <typename name="Geometric_tolerance"/>
         </explicit>
         <explicit name="related">
            <typename name="Geometric_tolerance"/>
         </explicit>
      </entity>
      <entity name="Line_profile_tolerance" supertypes="Geometric_tolerance">
         <explicit name="datum_system" optional="YES">
            <typename name="Datum_system"/>
         </explicit>
         <inverse attribute="zone_for" entity="Directed_or_oriented_tolerance_zone" name="directed_or_oriented_tolerance_zone">
            <inverse.aggregate lower="0" type="SET" upper="1"/>
         </inverse>
      </entity>
      <entity name="Non_uniform_zone_definition" supertypes="Tolerance_zone_definition"/>
      <entity name="Oriented_tolerance_zone" supertypes="Tolerance_zone_with_datum">
         <explicit name="orientation">
            <typename name="oriented_tolerance_zone_type"/>
         </explicit>
         <explicit name="angle" optional="YES">
            <typename name="Angle_data_element"/>
         </explicit>
         <where expression="(orientation &lt;&gt; oriented_tolerance_zone_type.angular) XOR EXISTS(angle)" label="WR1"/>
      </entity>
      <entity name="Parallelism_tolerance" supertypes="Geometric_tolerance">
         <explicit name="datum_system">
            <typename name="Datum_system"/>
         </explicit>
         <inverse attribute="zone_for" entity="Directed_or_oriented_tolerance_zone" name="directed_or_oriented_tolerance_zone">
            <inverse.aggregate lower="0" type="SET" upper="1"/>
         </inverse>
      </entity>
      <entity name="Perpendicularity_tolerance" supertypes="Geometric_tolerance">
         <explicit name="datum_system" optional="YES">
            <typename name="Datum_system"/>
         </explicit>
         <inverse attribute="zone_for" entity="Directed_or_oriented_tolerance_zone" name="directed_or_oriented_tolerance_zone">
            <inverse.aggregate lower="0" type="SET" upper="1"/>
         </inverse>
      </entity>
      <entity abstract.supertype="YES" name="Placed_target" super.expression="ONEOF (Target_circle, Target_circular_curve, Target_point, Target_rectangle, Target_straight_line)" supertypes="Datum_target">
         <explicit name="defined_in">
            <typename name="Geometric_coordinate_space"/>
         </explicit>
         <explicit name="parameter_reference">
            <typename name="Axis_placement"/>
         </explicit>
      </entity>
      <entity name="Plane_shape_element" supertypes="Shape_element">
         <explicit name="identified_item">
            <typename name="Plane"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
      </entity>
      <entity name="Point_shape_element" supertypes="Shape_element">
         <explicit name="identified_item">
            <typename name="Point"/>
            <redeclaration entity-ref="Shape_element"/>
         </explicit>
      </entity>
      <entity name="Position_tolerance" supertypes="Geometric_tolerance">
         <explicit name="datum_system">
            <typename name="Datum_system"/>
         </explicit>
         <inverse attribute="zone_for" entity="Directed_or_oriented_tolerance_zone" name="directed_or_oriented_tolerance_zone">
            <inverse.aggregate lower="0" type="SET" upper="1"/>
         </inverse>
      </entity>
      <entity name="Projected_zone_definition" supertypes="Tolerance_zone_definition">
         <explicit name="projection_end">
            <typename name="Shape_element"/>
         </explicit>
         <explicit name="projection_length">
            <typename name="Length_data_element"/>
         </explicit>
      </entity>
      <entity name="Projected_zone_definition_with_offset" supertypes="Projected_zone_definition">
         <explicit name="offset">
            <typename name="Length_data_element"/>
         </explicit>
      </entity>
      <entity name="Roundness_tolerance" supertypes="Geometric_tolerance"/>
      <entity name="Runout_zone_definition" supertypes="Tolerance_zone_definition">
         <explicit name="angle">
            <typename name="Angle_data_element"/>
         </explicit>
         <explicit name="orientation_defining_relationship" optional="YES">
            <typename name="Shape_element_relationship"/>
         </explicit>
      </entity>
      <entity name="Straightness_tolerance" supertypes="Geometric_tolerance">
         <inverse attribute="zone_for" entity="Directed_or_oriented_tolerance_zone" name="directed_or_oriented_tolerance_zone">
            <inverse.aggregate lower="0" type="SET" upper="1"/>
         </inverse>
      </entity>
      <entity name="Surface_profile_tolerance" supertypes="Geometric_tolerance">
         <explicit name="datum_system" optional="YES">
            <typename name="Datum_system"/>
         </explicit>
      </entity>
      <entity name="Symmetry_tolerance" supertypes="Geometric_tolerance">
         <explicit name="datum_system">
            <typename name="Datum_system"/>
         </explicit>
         <inverse attribute="zone_for" entity="Directed_or_oriented_tolerance_zone" name="directed_or_oriented_tolerance_zone">
            <inverse.aggregate lower="0" type="SET" upper="1"/>
         </inverse>
      </entity>
      <entity name="Target_area" supertypes="Datum_target">
         <explicit name="is_defined_by">
            <typename name="Shape_element"/>
         </explicit>
      </entity>
      <entity name="Target_circle" supertypes="Placed_target">
         <explicit name="diameter">
            <typename name="Numerical_item_with_unit"/>
         </explicit>
      </entity>
      <entity name="Target_circular_curve" supertypes="Placed_target">
         <explicit name="diameter">
            <typename name="Numerical_item_with_unit"/>
         </explicit>
      </entity>
      <entity name="Target_curve" supertypes="Datum_target">
         <explicit name="is_defined_by">
            <typename name="Shape_element"/>
         </explicit>
      </entity>
      <entity name="Target_point" supertypes="Placed_target"/>
      <entity name="Target_rectangle" supertypes="Placed_target">
         <explicit name="target_length">
            <typename name="Numerical_item_with_unit"/>
         </explicit>
         <explicit name="target_width">
            <typename name="Numerical_item_with_unit"/>
         </explicit>
      </entity>
      <entity name="Target_straight_line" supertypes="Placed_target">
         <explicit name="target_length">
            <typename name="Numerical_item_with_unit"/>
         </explicit>
      </entity>
      <entity name="Tolerance_zone" supertypes="Shape_element">
         <explicit name="form_type">
            <typename name="tolerance_zone_type"/>
         </explicit>
         <explicit name="zone_for">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="tolerance_zone_target"/>
         </explicit>
      </entity>
      <entity name="Tolerance_zone_definition" super.expression="ONEOF (Projected_zone_definition, Non_uniform_zone_definition, Runout_zone_definition)">
         <explicit name="zone">
            <typename name="Tolerance_zone"/>
         </explicit>
         <explicit name="boundaries">
            <aggregate lower="0" type="SET" upper="?"/>
            <typename name="Shape_element"/>
         </explicit>
      </entity>
      <entity name="Tolerance_zone_with_datum" super.expression="ONEOF (Directed_tolerance_zone, Oriented_tolerance_zone)" supertypes="Directed_or_oriented_tolerance_zone">
         <explicit name="datum_reference">
            <typename name="Datum_system"/>
         </explicit>
      </entity>
      <entity name="Total_runout_tolerance" supertypes="Geometric_tolerance">
         <explicit name="angle">
            <typename name="Angle_data_element"/>
         </explicit>
         <explicit name="datum_system">
            <typename name="Datum_system"/>
         </explicit>
      </entity>
      <subtype.constraint entity="Composite_shape_element" name="composite_shape_element_subtypes" super.expression="ONEOF (Continuous_shape_element, Composite_group_shape_element)"/>
      <subtype.constraint entity="Shape_element" name="gl_shape_element_subtypes" super.expression="ONEOF (Datum, Datum_feature, Datum_target, Tolerance_zone, Contacting_feature, Datum_system, General_datum_reference, Axis_placement_shape_element, Plane_shape_element, Point_shape_element)"/>
      <function name="sts_get_general_datum_reference">
         <parameter name="input">
            <typename name="Datum_reference_element"/>
         </parameter>
         <typename name="General_datum_reference"/>
         <algorithm>LOCAL
      general_datum_reference_bag : BAG OF General_datum_reference :=
      (USEDIN(input, 'GEOMETRIC_TOLERANCE_ARM.' + 'GENERAL_DATUM_REFERENCE.' + 'BASE'));
    END_LOCAL;

    IF SIZEOF(general_datum_reference_bag) = 1 THEN
      RETURN (general_datum_reference_bag[1]);
    ELSE
      RETURN (?);
    END_IF;</algorithm>
      </function>
   </schema>
</express>
