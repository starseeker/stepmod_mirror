<?xml version="1.0"?>
<!-- $Id: express2xml.js,v 1.25 2002/11/06 00:59:57 thendrix Exp $ -->
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">
<express
  language_version="2"
  description.file="mim_descriptions.xml"
  rcs.date="$Date: $"
  rcs.revision="$Revision: $">

  <application
    name="express2xml.js"
    owner="Eurostep Limited"
    url="http://www.eurostep.com"
    version="1.25"
    source="../data/modules/geometric_tolerance/mim.exp"/>

  <schema name="Geometric_tolerance_mim">
    <interface
      kind="use"
      schema="Derived_shape_element_mim">
    </interface>

    <interface
      kind="use"
      schema="Elemental_geometric_shape_mim">
    </interface>

    <interface
      kind="use"
      schema="Measure_representation_mim">
    </interface>

    <interface
      kind="use"
      schema="Shape_property_assignment_mim">
    </interface>

    <interface
      kind="use"
      schema="Value_with_unit_mim">
    </interface>

    <interface
      kind="use"
      schema="aic_geometric_tolerances">
    </interface>

    <entity
      name="placed_datum_target_feature"
      supertypes="datum_target">
      <where
        label="WR1"
        expression="SELF.description IN ['point','line','rectangle','circle', 'circular line']">
      </where>
      <where
        label="WR2"
        expression="SIZEOF (QUERY (pdr &lt;* get_shape_aspect_property_definition_representations(SELF) |              'GEOMETRIC_TOLERANCE_MIM.SHAPE_REPRESENTATION_WITH_PARAMETERS'               IN TYPEOF (pdr.used_representation)              )) = 1">
      </where>
      <where
        label="WR3"
        expression="SIZEOF( QUERY( pdr &lt;* get_shape_aspect_property_definition_representations(SELF) |             ('GEOMETRIC_TOLERANCE_MIM.SHAPE_REPRESENTATION_WITH_PARAMETERS' IN               TYPEOF(pdr.used_representation)) AND             (SIZEOF( QUERY( i &lt;* pdr.used_representation.items |               (i.name='orientation') AND               ('GEOMETRIC_TOLERANCE_MIM.PLACEMENT' IN TYPEOF(i))              )) = 1)             )) = 1">
      </where>
      <where
        label="WR4"
        expression="(SELF.description &lt;&gt; 'point') OR             (SIZEOF( QUERY( pdr &lt;* get_shape_aspect_property_definition_representations(SELF) |              ('GEOMETRIC_TOLERANCE_MIM.SHAPE_REPRESENTATION_WITH_PARAMETERS' IN                TYPEOF(pdr.used_representation)) AND              (SIZEOF(pdr.used_representation.items)                = 1)              )) = 1)">
      </where>
      <where
        label="WR5"
        expression="(SELF.description &lt;&gt; 'circle') OR             (SIZEOF( QUERY( pdr &lt;* get_shape_aspect_property_definition_representations(SELF) |              ('GEOMETRIC_TOLERANCE_MIM.SHAPE_REPRESENTATION_WITH_PARAMETERS' IN                TYPEOF(pdr.used_representation)) AND              (SIZEOF(pdr.used_representation.items)                = 2)              )) = 1)">
      </where>
      <where
        label="WR6"
        expression="(SELF.description &lt;&gt; 'rectangle') OR             (SIZEOF( QUERY( pdr &lt;* get_shape_aspect_property_definition_representations(SELF) |              ('GEOMETRIC_TOLERANCE_MIM.SHAPE_REPRESENTATION_WITH_PARAMETERS' IN                TYPEOF(pdr.used_representation)) AND              (SIZEOF(pdr.used_representation.items)                = 3)              )) = 1)">
      </where>
      <where
        label="WR7"
        expression="(SELF.description &lt;&gt; 'circle') OR             (SIZEOF( QUERY( pdr &lt;* get_shape_aspect_property_definition_representations(SELF) |              ('GEOMETRIC_TOLERANCE_MIM.SHAPE_REPRESENTATION_WITH_PARAMETERS' IN                TYPEOF(pdr.used_representation)) AND              (SIZEOF( QUERY( i &lt;* pdr.used_representation.items |                (i.name='target diameter') AND                (SIZEOF(['GEOMETRIC_TOLERANCE_MIM.MEASURE_REPRESENTATION_ITEM','GEOMETRIC_TOLERANCE_MIM.LENGTH_MEASURE_WITH_UNIT']*TYPEOF(i)                 ) = 2)               )) = 1)              )) = 1)">
      </where>
      <where
        label="WR8"
        expression="(SELF.description &lt;&gt; 'line') OR             (SIZEOF( QUERY( pdr &lt;* get_shape_aspect_property_definition_representations(SELF) |              ('GEOMETRIC_TOLERANCE_MIM.SHAPE_REPRESENTATION_WITH_PARAMETERS' IN                TYPEOF(pdr.used_representation)) AND              (SIZEOF( QUERY( i &lt;* pdr.used_representation.items |                (i.name='target length') AND                (SIZEOF(['GEOMETRIC_TOLERANCE_MIM.MEASURE_REPRESENTATION_ITEM','GEOMETRIC_TOLERANCE_MIM.LENGTH_MEASURE_WITH_UNIT']*TYPEOF(i)                 ) = 2)               )) = 1)              )) = 1)">
      </where>
      <where
        label="WR9"
        expression="(SELF.description &lt;&gt; 'rectangle') OR             (SIZEOF( QUERY( pdr &lt;* get_shape_aspect_property_definition_representations(SELF) |              ('GEOMETRIC_TOLERANCE_MIM.SHAPE_REPRESENTATION_WITH_PARAMETERS' IN                TYPEOF(pdr.used_representation)) AND              (SIZEOF( QUERY( i &lt;* pdr.used_representation.items |                (i.name='target length') AND                (SIZEOF(['GEOMETRIC_TOLERANCE_MIM.MEASURE_REPRESENTATION_ITEM','GEOMETRIC_TOLERANCE_MIM.LENGTH_MEASURE_WITH_UNIT']*TYPEOF(i)                 ) = 2)               )) = 1)              )) = 1)">
      </where>
      <where
        label="WR10"
        expression="(SELF.description &lt;&gt; 'rectangle') OR              (SIZEOF( QUERY( pdr &lt;* get_shape_aspect_property_definition_representations(SELF) |               ('GEOMETRIC_TOLERANCE_MIM.SHAPE_REPRESENTATION_WITH_PARAMETERS' IN                 TYPEOF(pdr.used_representation)) AND               (SIZEOF( QUERY( i &lt;* pdr.used_representation.items |                 (i.name='target width') AND                 (SIZEOF(['GEOMETRIC_TOLERANCE_MIM.MEASURE_REPRESENTATION_ITEM', 'GEOMETRIC_TOLERANCE_MIM.LENGTH_MEASURE_WITH_UNIT']*TYPEOF(i)                  ) = 2)                )) = 1)               )) = 1)">
      </where>
    </entity>

    <rule
      name="subtype_exclusiveness_geometric_tolerance"
      appliesto="geometric_tolerance">
      <algorithm>
      </algorithm>

      <where
        label="WR1"
        expression="SIZEOF(QUERY (gt &lt;* geometric_tolerance |                    NOT (type_check_function(gt,                    ['GEOMETRIC_TOLERANCE_MIM.ANGULARITY_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.CIRCULAR_RUNOUT_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.COAXIALITY_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.CONCENTRICITY_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.CYLINDRICITY_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.FLATNESS_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.LINE_PROFILE_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.PARALLELISM_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.PERPENDICULARITY_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.POSITION_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.ROUNDNESS_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.STRAIGHTNESS_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.SURFACE_PROFILE_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.SYMMETRY_TOLERANCE',                     'GEOMETRIC_TOLERANCE_MIM.TOTAL_RUNOUT_TOLERANCE'] , 3 )               ))) = 0">
      </where>
      <where
        label="END_RULE"
        expression="END_RULE">
      </where>
      <where
        label="RULE"
        expression="RULE subtype_mandatory_geometric_tolerance FOR    (geometric_tolerance)">
      </where>
      <where
        label="WHERE"
        expression="SIZEOF(QUERY ( gt &lt;* geometric_tolerance |                         NOT (type_check_function(gt,                       ['GEOMETRIC_TOLERANCE_MIM.ANGULARITY_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.CIRCULAR_RUNOUT_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.COAXIALITY_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.CONCENTRICITY_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.CYLINDRICITY_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.FLATNESS_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.LINE_PROFILE_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.PARALLELISM_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.PERPENDICULARITY_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.POSITION_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.ROUNDNESS_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.STRAIGHTNESS_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.SURFACE_PROFILE_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.SYMMETRY_TOLERANCE',                        'GEOMETRIC_TOLERANCE_MIM.TOTAL_RUNOUT_TOLERANCE'] , 0)                    ))) = 0">
      </where>

    </rule>

  </schema>

</express>
