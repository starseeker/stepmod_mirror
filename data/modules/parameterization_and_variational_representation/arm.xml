<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express description.file="arm_descriptions.xml" language_version="2" rcs.date="$Date$" rcs.revision="$Revision$" reference="ISO/TS 10303-1790">
   <application name="JSDAI" owner="LKSoft" source="parameterization_and_variational_representation_arm schema_instance" url="www.lksoft.com" version="4.0 beta"/>
   <schema name="Parameterization_and_variational_representation_arm">
      <interface kind="use" schema="Elemental_geometric_shape_arm"/>
      <interface kind="use" schema="Maths_space_arm"/>
      <interface kind="reference" schema="Foundation_representation_arm"/>
      <type name="attribute_identifier">
         <builtintype type="STRING"/>
         <where expression="validate_attribute_id(SELF)" label="WR1"/>
      </type>
      <entity name="Auxiliary_geometric_representation_item" supertypes="Detailed_geometric_model_element Variational_representation_item"/>
      <entity name="Bound_parameter_environment">
         <explicit name="syntactic_representation">
            <typename name="Bound_variational_parameter"/>
         </explicit>
         <explicit name="semantics">
            <typename name="Instance_attribute_reference"/>
         </explicit>
      </entity>
      <entity name="Bound_variational_parameter" supertypes="Variational_representation_item Maths_variable">
         <explicit name="parameter_description" optional="YES">
            <builtintype type="STRING"/>
         </explicit>
         <derived expression="SELF\Representation_item.name" name="name">
            <builtintype type="STRING"/>
            <redeclaration entity-ref="Maths_variable"/>
         </derived>
         <inverse attribute="syntactic_representation" entity="Bound_parameter_environment" name="interpretation"/>
      </entity>
      <entity name="Fixed_instance_attribute_set" supertypes="Variational_representation_item">
         <explicit name="fixed_attributes">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="Instance_attribute_reference"/>
         </explicit>
         <where expression="SIZEOF(QUERY(q &lt;* using_representations(SELF) | &#10;    SIZEOF(QUERY(r &lt;* q.items |&#10;    'PARAMETERIZATION_AND_VARIATIONAL_REPRESENTATION_ARM.FIXED_INSTANCE_ATTRIBUTE_SET' &#10;    IN TYPEOF(r))) &gt; 1)) = 0" label="WR1"/>
      </entity>
      <entity name="Generated_finite_numeric_space" supertypes="Maths_space">
         <explicit name="start_value">
            <builtintype type="NUMBER"/>
         </explicit>
         <explicit name="increment_value">
            <builtintype type="NUMBER"/>
         </explicit>
         <explicit name="increments">
            <typename name="maths_integer"/>
         </explicit>
         <derived expression="make_numeric_set(start_value, increment_value, increments)" name="members">
            <aggregate lower="2" type="SET" upper="?"/>
            <builtintype type="NUMBER"/>
         </derived>
         <where expression="increment_value &lt;&gt; 0.0" label="WR1"/>
         <where expression="increments &gt; 0" label="WR2"/>
      </entity>
      <entity name="Instance_attribute_reference">
         <explicit name="attribute_name">
            <typename name="attribute_identifier"/>
         </explicit>
         <explicit name="owning_instance">
            <typename name="Representation_item"/>
         </explicit>
      </entity>
      <entity name="Maths_variable">
         <explicit name="name">
            <builtintype type="STRING"/>
         </explicit>
         <explicit name="values_space">
            <typename name="Maths_space"/>
         </explicit>
      </entity>
      <entity name="Unbound_parameter_environment">
         <explicit name="syntactic_representation">
            <typename name="Unbound_variational_parameter"/>
         </explicit>
         <explicit name="semantics">
            <typename name="Unbound_variational_parameter_semantics"/>
         </explicit>
      </entity>
      <entity name="Unbound_variational_parameter" supertypes="Variational_representation_item Maths_variable">
         <explicit name="parameter_description" optional="YES">
            <builtintype type="STRING"/>
         </explicit>
         <explicit name="parameter_current_value">
            <typename name="maths_value"/>
         </explicit>
         <derived expression="SELF\Representation_item.name" name="name">
            <builtintype type="STRING"/>
            <redeclaration entity-ref="Maths_variable"/>
         </derived>
         <inverse attribute="syntactic_representation" entity="Unbound_parameter_environment" name="interpretation"/>
      </entity>
      <entity name="Unbound_variational_parameter_semantics"/>
      <entity name="Variational_current_representation_relationship" supertypes="Representation_relationship">
         <explicit name="rep_1">
            <typename name="Variational_representation"/>
            <redeclaration entity-ref="Representation_relationship"/>
         </explicit>
         <explicit name="current_result">
            <typename name="Representation"/>
         </explicit>
         <unique label="UR1">
            <unique.attribute attribute="current_result"/>
         </unique>
         <where expression="QUERY(q &lt;* SELF\Representation_relationship.rep_1.items | NOT&#10;    ('PARAMETERIZATION_AND_VARIATIONAL_REPRESENTATION_ARM.VARIATIONAL_REPRESENTATION_ITEM'&#10;    IN TYPEOF(q))) = SELF\Representation_relationship.rep_2.items" label="WR1"/>
         <where expression="SELF\Representation_relationship.rep_1.context_of_items :=:&#10;    SELF\Representation_relationship.rep_2.context_of_items" label="WR2"/>
         <where expression="SIZEOF(QUERY(q &lt;* SELF\Representation_relationship.rep_2.items |&#10;    'PARAMETERIZATION_AND_VARIATIONAL_REPRESENTATION_ARM.VARIATIONAL_REPRESENTATION_ITEM' &#10;    IN TYPEOF(q))) = 0" label="WR3"/>
         <where expression="current_result :=: SELF\Representation_relationship.rep_2" label="WR4"/>
      </entity>
      <entity name="Variational_representation" supertypes="Representation">
         <inverse attribute="rep_1" entity="Variational_current_representation_relationship" name="cm_link"/>
         <where expression="SIZEOF(QUERY(q &lt;* SELF\representation.items | &#10;    'PARAMETERIZATION_AND_VARIATIONAL_REPRESENTATION_ARM.VARIATIONAL_REPRESENTATION_ITEM' &#10;    IN TYPEOF(q))) &gt; 0" label="WR1"/>
      </entity>
      <entity abstract.supertype="YES" name="Variational_representation_item" super.expression="ONEOF (Auxiliary_geometric_representation_item, Bound_variational_parameter, Unbound_variational_parameter)" supertypes="Representation_item">
         <where expression="SIZEOF(QUERY(q &lt;* using_representations(SELF) |&#10;    NOT ('PARAMETERIZATION_AND_VARIATIONAL_REPRESENTATION_ARM.VARIATIONAL_REPRESENTATION'  &#10;    IN TYPEOF(q)))) = 0" label="WR1"/>
         <where expression="SIZEOF(QUERY(q &lt;* using_representations(SELF) |&#10;    NOT (SELF IN q.items))) = 0" label="WR2"/>
      </entity>
      <function name="make_numeric_set">
         <parameter name="start">
            <builtintype type="NUMBER"/>
         </parameter>
         <parameter name="delta">
            <builtintype type="NUMBER"/>
         </parameter>
         <parameter name="incs">
            <typename name="maths_integer"/>
         </parameter>
         <aggregate lower="2" type="SET" upper="?"/>
         <builtintype type="NUMBER"/>
         <algorithm>LOCAL
    i : INTEGER;
    numeric_set : SET[2:?] OF NUMBER := [start, (start + delta)];
  END_LOCAL;

  IF incs &gt; 1 THEN REPEAT i := 2 TO incs;
                     numeric_set := numeric_set + (start + (i*delta));
                   END_REPEAT;
  END_IF;
  RETURN(numeric_set);</algorithm>
      </function>
      <function name="validate_attribute_id">
         <parameter name="attid">
            <typename name="attribute_identifier"/>
         </parameter>
         <builtintype type="BOOLEAN"/>
         <algorithm>CONSTANT
    letters      : SET[52:52] OF STRING := 
      ['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p',
       'q','r','s','t','u','v','w','x','y','z','A','B','C','D','E','F',
       'G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V',
       'W','X','Y','Z'];
    numbers_etc  : SET[15:15] OF STRING := 
      ['0','1','2','3','4','5','6','7','8','9','_','[',']','.','\'];
    valid_chars  : SET[67:67] OF STRING := letters + numbers_etc;
  END_CONSTANT;

  LOCAL
    id_length : INTEGER := LENGTH(attid);
    id_valid  : BOOLEAN := TRUE;
    i         : INTEGER;
  END_LOCAL;

  -- check that indentifier starts with a letter

  IF NOT (attid[1] IN letters) THEN 
    id_valid := FALSE; 
  END_IF;
  
  -- check that no invalid characters occur subsequently

  REPEAT i := 2 TO id_length
   WHILE id_valid = TRUE;
    IF NOT (attid[i] IN valid_chars) THEN 
      id_valid := FALSE;
    END_IF;
  END_REPEAT;
  RETURN(id_valid);</algorithm>
      </function>
   </schema>
</express>
