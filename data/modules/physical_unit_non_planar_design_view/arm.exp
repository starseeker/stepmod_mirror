(*
   $Id: arm.exp,v 1.16 2005/12/02 12:46:27 liutkus Exp $
   ISO TC184/SC4/WG12 N3834 - ISO/TS 10303-1613 Physical unit non planar design view - EXPRESS ARM
   Supersedes ISO TC184/SC4/WG12 N3573
*)

SCHEMA Physical_unit_non_planar_design_view_arm;
  
	USE FROM Manifold_subsurface_arm;	-- ISO/TS 10303-1702
	USE FROM Physical_unit_design_view_arm;	-- ISO/TS 10303-1728

  ENTITY Assembly_component_non_planar_shape_model
    SUBTYPE OF (Manifold_subsurface_model);
      shape_characterized_component : SET[1:?] OF Assembly_component;
  WHERE
    WR1 : NOT EXISTS(SELF\Representation.description);
  END_ENTITY;


  RULE unique_assembly_component_non_planar_shape_model FOR (Assembly_component_non_planar_shape_model);
   LOCAL
     ac : BAG OF Assembly_component := [];
   END_LOCAL;
   REPEAT i := 1 to SIZEOF(Assembly_component_non_planar_shape_model) by 1;
     ac  := ac + Assembly_component_non_planar_shape_model[i].shape_characterized_component;
   END_REPEAT;  
  WHERE
   WR1 : SIZEOF(ac) = SIZEOF(bag_to_set(ac));
  END_RULE;

  FUNCTION bag_to_set(
    the_bag : BAG OF GENERIC : intype
  ) : SET OF GENERIC : intype;

    LOCAL
      the_set : SET OF GENERIC : intype := [];
      i       : INTEGER;
    END_LOCAL;

    IF SIZEOF(the_bag) > 0 THEN
      REPEAT i := 1 TO HIINDEX(the_bag);
        the_set := the_set + the_bag[i];
      END_REPEAT;
    END_IF;
    RETURN(the_set);
  END_FUNCTION;

END_SCHEMA;
