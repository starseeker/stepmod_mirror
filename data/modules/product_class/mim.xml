<?xml version="1.0"?>
<!-- $Id: express2xml.js,v 1.22 2002/08/14 06:43:41 goset1 Exp $ -->
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">
<express
  language_version="2"
  description.file="mim_descriptions.xml"
  rcs.date="$Date: $"
  rcs.revision="$Revision: $">

  <application
    name="express2xml.js"
    owner="Eurostep Limited"
    url="http://www.eurostep.com"
    version="1.22"
    source="../data/modules/product_class/mim.exp"/>

  <schema name="Product_class_mim">
    <interface
      kind="use"
      schema="group_schema">
      <interfaced.item
        name="group"/>
    </interface>

    <interface
      kind="use"
      schema="management_resources_schema">
      <interfaced.item
        name="group_assignment"/>
    </interface>

    <interface
      kind="use"
      schema="product_concept_schema">
      <interfaced.item
        name="product_concept"/>
    </interface>

    <interface
      kind="use"
      schema="product_property_definition_schema">
      <interfaced.item
        name="characterized_object"/>
    </interface>

    <type name="category_usage_item">
      <select
        selectitems="product_class">
      </select>

    </type>
    <type name="id_for_class">
      <select
        basedon="identification_item"
        selectitems="product_class product_concept_feature">
      </select>

    </type>
    <type name="version_for_class">
      <select
        basedon="versionable_item"
        selectitems="product_class product_concept_feature">
      </select>

    </type>
    <entity
      name="exclusive_product_concept_feature_category"
      supertypes="product_concept_feature_category">
    </entity>

    <entity
      name="product_class"
      supertypes="product_concept characterized_object">
    </entity>

    <entity
      name="product_concept_feature_category"
      supertypes="group">
      <where
        label="WR1"
        expression="SIZEOF(QUERY( aga &lt;* USEDIN( SELF, 'PRODUCT_CLASS_MIM.' + 'GROUP_ASSIGNMENT.ASSIGNED_GROUP' ) |     ( 'PRODUCT_CLASS_MIM.'+ 'APPLIED_GROUP_ASSIGNMENT' IN TYPEOF ( aga ) ) AND    ( ( aga. role.name &lt;&gt; 'specification category member' ) OR     ( SIZEOF(QUERY ( i &lt;* aga. items | ( 'PRODUCT_CLASS_MIM.'+     'PRODUCT_CONCEPT_FEATURE' IN TYPEOF ( i ) ) AND     NOT ('PRODUCT_CLASS_MIM.'+ 'CONDITIONAL_CONCEPT_FEATURE' IN TYPEOF ( i ) ) ) ) &lt;&gt; SIZEOF ( aga. items ) ) )        ) ) =0">
      </where>
    </entity>

    <entity
      name="product_concept_feature_category_usage"
      supertypes="group_assignment">
      <explicit
        name="assigned_group">
        <redeclaration
          entity-ref="group_assignment"/>
          <typename
            name="product_concept_feature_category"/>
        </explicit>
        <explicit
          name="items">
          <aggregate
            type="SET"
            lower="1"
            upper="?"/>
          <typename
            name="category_usage_item"/>
        </explicit>
        <where
          label="WR1"
          expression="SELF.role.name IN [ 'mandatory category usage', 'optional category usage' ]">
        </where>
      </entity>

      <rule
        name="restrict_concept_feature_operator"
        appliesto="concept_feature_operator">
        <algorithm>
        </algorithm>

        <where
          label="WR1"
          expression="SIZEOF( QUERY( cfo &lt;* concept_feature_operator |   NOT (cfo.name IN ['and','or','oneof','not','implication']) )) = 0">
        </where>
        <where
          label="WR2"
          expression="SIZEOF( QUERY( cfo &lt;* concept_feature_operator |   (cfo.name = 'implication') AND   (SIZEOF( QUERY( cfrwc &lt;* USEDIN(cfo, 'PRODUCT_CLASS_MIM.' + 'CONCEPT_FEATURE_RELATIONSHIP_WITH_CONDITION.CONDITIONAL_OPERATOR') |   SIZEOF( QUERY( ccf &lt;* USEDIN(cfrwc, 'PRODUCT_CLASS_MIM.' + 'CONDITIONAL_CONCEPT_FEATURE.CONDITION') |   NOT('PRODUCT_CLASS_MIM.INCLUSION_PRODUCT_CONCEPT_FEATURE' IN TYPEOF(ccf)) )) &gt; 0 )) &gt; 0 ) )) = 0">
        </where>

      </rule>

      <rule
        name="restrict_group_relationship_for_specification_category"
        appliesto="group_relationship">
        <algorithm>
        </algorithm>

        <where
          label="WR1"
          expression="SIZEOF( QUERY( gr &lt;* group_relationship |   (gr.name = 'specification category hierarchy') AND   (NOT('PRODUCT_CLASS_MIM.PRODUCT_CONCEPT_FEATURE_CATEGORY' IN TYPEOF(gr.related_group))   OR NOT('PRODUCT_CLASS_MIM.PRODUCT_CONCEPT_FEATURE_CATEGORY' IN TYPEOF(gr.relating_group))) )) = 0">
        </where>

      </rule>

      <rule
        name="product_concept_feature_requires_category"
        appliesto="product_concept_feature">
        <algorithm>
        </algorithm>

        <where
          label="WR1"
          expression="SIZEOF( QUERY( pcf &lt;* product_concept_feature |   SIZEOF( QUERY( aga &lt;* USEDIN(pcf, 'PRODUCT_CLASS_MIM.' + 'APPLIED_GROUP_ASSIGNMENT.ITEMS') |   (aga.role.name = 'specification category member') AND   ('PRODUCT_CLASS_MIM.' +'PRODUCT_CONCEPT_FEATURE_CATEGORY' IN TYPEOF(aga.assigned_group)) )) &lt;&gt; 1 )) = 0">
        </where>

      </rule>

    </schema>

  </express>
