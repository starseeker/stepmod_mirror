<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express description.file="arm_descriptions.xml" language_version="2" rcs.date="$Date$" rcs.revision="$Revision$">
   <application name="JSDAI" owner="LKSoft" source="product_data_quality_inspection_result_arm schema_instance" url="www.lksoft.com" version="4.0 beta"/>
   <schema name="Product_data_quality_inspection_result_arm">
      <interface kind="use" schema="Foundation_representation_arm"/>
      <interface kind="use" schema="Product_data_quality_criteria_arm"/>
      <interface kind="use" schema="Product_data_quality_definition_arm"/>
      <interface kind="use" schema="Product_view_definition_arm"/>
      <interface kind="reference" schema="Support_resource_arm">
         <interfaced.item name="bag_to_set"/>
      </interface>
      <type name="inspected_element_select">
         <select extensible="YES" genericentity="YES"/>
      </type>
      <type name="statistical_value_type">
         <enumeration items="number_of_inspected_instances number_of_quality_defects_detected"/>
      </type>
      <entity name="Data_quality_inspection_criterion_report" supertypes="Data_quality_inspection_report">
         <explicit name="statistical_values">
            <aggregate lower="1" type="SET" upper="2"/>
            <typename name="Data_quality_inspection_criterion_report_item"/>
         </explicit>
         <where expression="SIZEOF(QUERY(i1&lt;*bag_to_set(USEDIN(&#10;              SELF\data_quality_inspection_report.&#10;              inspection_result.criterion_inspected,&#10;              'PRODUCT_DATA_QUALITY_CRITERIA_ARM.'+&#10;              'DATA_QUALITY_REPORT_REQUEST.CRITERION_OF_REPORT_REQUEST'))|&#10;              'PRODUCT_DATA_QUALITY_CRITERIA_ARM.'+&#10;              'SUMMARY_REPORT_REQUEST'&#10;            IN TYPEOF(i1)))&gt;0" label="WR1"/>
         <where expression="(SIZEOF(SELF.statistical_values) = 1 ) OR &#10;            (SELF.statistical_values[1].value_type &lt;&gt;&#10;             SELF.statistical_values[2].value_type)" label="WR2"/>
      </entity>
      <entity name="Data_quality_inspection_criterion_report_item" supertypes="Representation_item">
         <explicit name="statistical_value">
            <builtintype type="INTEGER"/>
         </explicit>
         <explicit name="value_type">
            <typename name="statistical_value_type"/>
         </explicit>
         <where expression="SIZEOF(QUERY(q &lt;* bag_to_set( USEDIN(SELF,&#10;                            'FOUNDATION_REPRESENTATION_ARM.REPRESENTATION.ITEMS'))&#10;                          |'PRODUCT_DATA_QUALITY_CRITERIA_ARM.'+&#10;                           'DATA_QUALITY_CRITERIA_REPRESENTATION'&#10;                           IN TYPEOF(q)))=0" label="WR1"/>
      </entity>
      <entity name="Data_quality_inspection_instance_report" supertypes="Data_quality_inspection_report">
         <explicit name="inspected_instances">
            <aggregate lower="1" type="LIST" upper="?"/>
            <typename name="Data_quality_inspection_instance_report_item"/>
         </explicit>
         <where expression="SIZEOF(QUERY(i1&lt;*bag_to_set(USEDIN(&#10;              SELF\data_quality_inspection_report.&#10;              inspection_result.criterion_inspected,&#10;              'PRODUCT_DATA_QUALITY_CRITERIA_ARM.'+&#10;              'DATA_QUALITY_REPORT_REQUEST.CRITERION_OF_REPORT_REQUEST'))|&#10;              'PRODUCT_DATA_QUALITY_CRITERIA_ARM.'+&#10;              'DETAILED_REPORT_REQUEST'&#10;            IN TYPEOF(i1)))&gt;0" label="WR1"/>
      </entity>
      <entity name="Data_quality_inspection_instance_report_item" supertypes="Representation_item">
         <explicit name="inspected_elements">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="inspected_element_select"/>
         </explicit>
         <where expression="SIZEOF(QUERY(q &lt;* bag_to_set( USEDIN(SELF,&#10;                            'FOUNDATION_REPRESENTATION_ARM.REPRESENTATION.ITEMS'))&#10;                          |'PRODUCT_DATA_QUALITY_CRITERIA_ARM.'+&#10;                           'DATA_QUALITY_CRITERIA_REPRESENTATION'&#10;                           IN TYPEOF(q)))=0" label="WR1"/>
      </entity>
      <entity name="Data_quality_inspection_report" super.expression="ONEOF (Data_quality_inspection_criterion_report, Data_quality_inspection_instance_report)" supertypes="Representation_item">
         <explicit name="inspection_result">
            <typename name="Data_quality_inspection_result"/>
         </explicit>
         <where expression="SIZEOF(QUERY(q &lt;* bag_to_set( USEDIN(SELF,&#10;                            'FOUNDATION_REPRESENTATION_ARM.REPRESENTATION.ITEMS'))&#10;                          |'PRODUCT_DATA_QUALITY_CRITERIA_ARM.'+&#10;                           'DATA_QUALITY_CRITERIA_REPRESENTATION'&#10;                           IN TYPEOF(q)))=0" label="WR1"/>
      </entity>
      <entity name="Data_quality_inspection_result" supertypes="Representation_item">
         <explicit name="criterion_inspected">
            <typename name="Data_quality_criterion"/>
         </explicit>
         <where expression="SIZEOF(QUERY(q &lt;* bag_to_set( USEDIN(SELF,&#10;                            'FOUNDATION_REPRESENTATION_ARM.REPRESENTATION.ITEMS'))&#10;                          |'PRODUCT_DATA_QUALITY_CRITERIA_ARM.'+&#10;                           'DATA_QUALITY_CRITERIA_REPRESENTATION'&#10;                           IN TYPEOF(q)))=0" label="WR1"/>
      </entity>
      <entity name="Data_quality_inspection_result_representation" supertypes="Representation">
         <explicit name="criteria_inspected">
            <typename name="Data_quality_criteria_representation"/>
         </explicit>
         <where expression="SIZEOF( QUERY( q &lt;* SELF\representation.items|&#10;                                'PRODUCT_DATA_QUALITY_INSPECTION_RESULT_ARM.' +&#10;                                'DATA_QUALITY_INSPECTION_RESULT' IN TYPEOF(q))) &gt; 0" label="WR1"/>
         <where expression="SIZEOF(inspected_product_view_definition(SELF)) &gt; 0" label="WR2"/>
      </entity>
      <entity name="Data_quality_inspection_result_with_judgement" supertypes="Data_quality_inspection_result">
         <explicit name="judgement">
            <builtintype type="BOOLEAN"/>
         </explicit>
      </entity>
      <entity name="Data_quality_report_measurement_association">
         <explicit name="relating_representation_item">
            <typename name="Data_quality_measurement_requirement"/>
         </explicit>
         <explicit name="related_representation_item">
            <typename name="Data_quality_inspection_report"/>
         </explicit>
      </entity>
      <function name="inspected_product_view_definition">
         <parameter name="dqir">
            <typename name="Data_quality_inspection_result_representation"/>
         </parameter>
         <aggregate lower="0" type="BAG" upper="?"/>
         <typename name="Product_view_definition"/>
         <algorithm>LOCAL
      dqdr :BAG OF Data_quality_definition_representation_relationship:= [];
      pdqdr :BAG OF Product_data_and_data_quality_relationship:= [];
      pd   :BAG OF Product_view_definition:= [];
    END_LOCAL;
    dqdr := USEDIN(dqir,'PRODUCT_DATA_QUALITY_DEFINITION_ARM.'
                       +'DATA_QUALITY_DEFINITION_REPRESENTATION_RELATIONSHIP.'
                       +'USED_REPRESENTATION');
    REPEAT i:= 1 TO SIZEOF(dqdr);
      pdqdr := USEDIN(dqdr[i].definition,
                      'PRODUCT_DATA_QUALITY_DEFINITION_ARM.'
                     +'PRODUCT_DATA_AND_DATA_QUALITY_RELATIONSHIP.'
                     +'DATA_QUALITY');
      REPEAT j:= 1 TO SIZEOF(pdqdr);
        pd := pd + pdqdr[j].product_data; 
      END_REPEAT;
    END_REPEAT;
    RETURN(pd);</algorithm>
      </function>
   </schema>
</express>
