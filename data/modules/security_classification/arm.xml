<?xml version="1.0"?>
<!-- $Id: arm.xml,v 1.3 2002/01/16 14:25:40 robbod Exp $ -->
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">
<express
  language_version="2"
  rcs.date="$Date: 2002/01/16 14:25:40 $"
  rcs.revision="$Revision: 1.3 $">

  <application
    name="express2xml.js"
    owner="Eurostep Limited"
    url="http://www.eurostep.com"
    version="1.6"
    source="../data/modules/security_classification/arm.exp"/>

  <schema name="Security_classification_arm">
    <interface
      kind="use"
      schema="Approval_arm">
    </interface>

    <interface
      kind="use"
      schema="Date_time_assignment_arm">
    </interface>

    <interface
      kind="use"
      schema="Person_organisation_assignment_arm">
    </interface>

    <interface
      kind="use"
      schema="Alias_identification_arm">
    </interface>

    <type name="security_classification_item">
      <description>This select is a place holder for assignments of security classification to elements of product data.</description>
      <select
        extensible="YES"
        selectitems="">
      </select>

    </type>
    <type name="security_classification_organisation_or_person_in_organisation_item">
      <description>This select extends the assignments of an organization or a person in an organization to Security_classification.</description>
      <select
        basedon="organisation_or_person_in_organisation_item"
        selectitems="Security_classification">
      </select>

    </type>
    <type name="security_classification_date_or_date_time_item">
      <description>This select is a extends the assignments of a date or a date and time to <b>Security_classification</b>.</description>
      <select
        basedon="date_or_date_time_item"
        selectitems="Security_classification">
      </select>

    </type>
    <type name="security_classification_approval_item">
      <description>This select extends an <b>Approval_assignment</b> to apply to <b>Security_classification</b> instances.</description>
      <select
        basedon="approval_item"
        selectitems="Security_classification">
      </select>

    </type>
    <type name="security_classification_alias_identification_item">
      <description>This select extends the assignments of identification for aliasing to security classifications.</description>
      <select
        extensible="YES"
        basedon="alias_identification_item"
        selectitems="Security_classification">
      </select>

    </type>
    <entity
      name="Security_classification">
      <description>A <b>Security_classification</b> specifies information about the sensitivity of product data.</description>
      <explicit
        name="classification">
        <description>the identification the <b>Security_classification</b>.</description>
        <builtintype
          type="STRING"/>
      </explicit>
      <explicit
        name="description"
        optional="YES">
        <description>the optional text which defines the <b>Security_classification</b>. This is provided when the classification is not generally understood.</description>
        <builtintype
          type="STRING"/>
      </explicit>
      <inverse
        name="classifier"
        entity="Organisation_or_person_in_organisation_assignment"
        attribute="items">
        <description>the optional organization or person in organization that defines or owns the classification.</description>
        <inverse.aggregate
          type="SET"
          lower="0"
          upper="1"/>
      </inverse>
      <inverse
        name="classification_dates"
        entity="Date_or_date_time_assignment"
        attribute="items">
        <description>the optional dates or dates and times related to the classification.</description>
        <inverse.aggregate
          type="SET"
          lower="0"
          upper="2"/>
      </inverse>
      <inverse
        name="approval"
        entity="Approval_assignment"
        attribute="items">
        <description>the organization or person in organization that approved the classification.</description>
        <inverse.aggregate
          type="SET"
          lower="0"
          upper="1"/>
      </inverse>
      <inverse
        name="idalias"
        entity="Alias_identification"
        attribute="items">
        <description>An optional alternate identifier.</description>
        <inverse.aggregate
          type="SET"
          lower="0"
          upper="1"/>
      </inverse>
      <where
        label="WR1"
        expression="(SELF.classification IN ['unclassified', 'confidential',        'secret', 'top secret', 'proprietary'] OR EXISTS(SELF.description))">
        <description>Either the <b>classification</b> is 'unclassified', 'confidential', 'secret', 'top secret', 'proprietary' or the <b>description</b> value exists.</description>
      </where>
      <where
        label="WR2"
        expression="NOT (SELF.classification = 'classified' AND (NOT EXISTS(SELF.description)))">
        <description>If the <b>classification</b> is 'classified', the <b>description</b> value shall exist.</description>
      </where>
      <where
        label="WR3"
        expression="SELF.classifier.role = 'classification officer'">
        <description>The <b>classifier</b> role shall be 'classification officer'.</description>
      </where>
      <where
        label="WR4"
        expression="SELF.classification_dates.role IN ['classification date','declassification date']">
        <description>The <b>classification_dates</b> role shall be either 'classification date' or 'declassification date'.</description>
      </where>
      <where
        label="WR5"
        expression="SIZEOF(QUERY(cdr &lt;* USEDIN(SELF,'SECURITY_CLASSIFICATION_MIM.' + 'DATE_OR_DATE_TIME_ASSIGNMENT.ITEMS') | ((SELF.role.name=&quot;classification date&quot; ))) &lt;=&quot;1&quot;">
        <description>At most 1 <b>classification_dates</b> role may be 'classification date'.</description>
      </where>
      <where
        label="WR6"
        expression="SIZEOF(QUERY(cdr &lt;* USEDIN(SELF,'SECURITY_CLASSIFICATION_MIM.' + 'DATE_OR_DATE_TIME_ASSIGNMENT.ITEMS') | ((SELF.role.name=&quot;declassification date&quot; ))) &lt;=&quot;1&quot;">
        <description>At most 1 <b>classification_dates</b> role may be 'declassification date'.</description>
      </where>
    </entity>

    <entity
      name="Security_classification_assignment">
      <description><p>A <b>Security_classification_assignment</b> assigns a <b>Security_classification</b> to product data.</p></description>
      <explicit
        name="classification">
        <description>the <b>Security_classification</b> to be assigned to product data.</description>
        <typename
          name="Security_classification"/>
      </explicit>
      <explicit
        name="items">
        <description>the product data to which the <b>Security_classification</b> is assigned.</description>
        <aggregate
          type="SET"
          lower="1"
          upper="?"/>
        <typename
          name="security_classification_item"/>
      </explicit>
    </entity>

  </schema>

</express>
