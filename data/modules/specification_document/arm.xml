<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express description.file="arm_descriptions.xml" language_version="2" rcs.date="$Date$" rcs.revision="$Revision$" reference="ISO/TS 10303-1747">
   <application name="JSDAI" owner="LKSoft" source="specification_document_arm schema_instance" url="www.lksoft.com" version="4.0 beta"/>
   <schema name="Specification_document_arm">
      <interface kind="use" schema="Characteristic_arm"/>
      <interface kind="use" schema="Configuration_item_arm"/>
      <interface kind="use" schema="Tagged_text_representation_arm"/>
      <interface kind="reference" schema="Support_resource_arm">
         <interfaced.item name="bag_to_set"/>
      </interface>
      <type name="sd_documented_element_select">
         <select basedon="documented_element_select" selectitems="Product_configuration Product_view_definition Product_version Product"/>
      </type>
      <type name="sd_organization_or_person_in_organization_item">
         <select basedon="organization_or_person_in_organization_item" selectitems="Specification_definition"/>
      </type>
      <entity name="Design_specification" super.expression="Interface_specification_document_definition" supertypes="Specification_definition">
         <where expression="NOT EXISTS(SELF\Product_view_definition.additional_characterization)" label="WR1"/>
      </entity>
      <entity name="Fabrication_technology_specification" supertypes="Process_specification"/>
      <entity name="Interface_specification_document_definition" supertypes="Design_specification"/>
      <entity name="Language_reference_manual" supertypes="Specification_definition">
         <where expression="NOT EXISTS(SELF\Product_view_definition.additional_characterization)" label="WR1"/>
      </entity>
      <entity name="Material_specification" supertypes="Specification_definition">
         <where expression="NOT EXISTS(SELF\Product_view_definition.additional_characterization)" label="WR1"/>
      </entity>
      <entity name="Partial_document_with_structured_text_representation_assignment" supertypes="Partial_document_assignment">
         <explicit name="structured_portion">
            <typename name="string_representation_item_select"/>
         </explicit>
         <unique label="UR1">
            <unique.attribute attribute="SELF\Partial_document_assignment.document_portion"/>
            <unique.attribute attribute="SELF\Document_assignment.assigned_document"/>
         </unique>
      </entity>
      <entity name="Process_specification" supertypes="Specification_definition">
         <where expression="NOT EXISTS(SELF\Product_view_definition.additional_characterization)" label="WR1"/>
      </entity>
      <entity name="Specification_allocation" supertypes="Document_assignment">
         <explicit name="allocated_specification">
            <typename name="Specification_definition"/>
            <redeclaration entity-ref="Document_assignment" old_name="assigned_document"/>
         </explicit>
      </entity>
      <entity name="Specification_definition" super.expression="ONEOF (Design_specification, Process_specification, Material_specification, Test_specification, Language_reference_manual)" supertypes="Document_definition">
         <derived expression="bag_to_set(QUERY(temp &lt;* USEDIN(SELF,'PERSON_ORGANIZATION_ASSIGNMENT_ARM.'+&#10;         'ORGANIZATION_OR_PERSON_IN_ORGANIZATION_ASSIGNMENT.ITEMS') |&#10;                         (temp.role = 'document source') ))" name="source">
            <aggregate lower="0" type="SET" upper="?"/>
            <typename name="Organization_or_person_in_organization_assignment"/>
         </derived>
         <where expression="EXISTS (source) AND (SIZEOF(source) = 1)" label="WR1"/>
      </entity>
      <entity name="Surface_finish_specification" supertypes="Material_specification"/>
      <entity name="Test_specification" supertypes="Specification_definition">
         <where expression="NOT EXISTS(SELF\Product_view_definition.additional_characterization)" label="WR1"/>
      </entity>
      <function name="get_document_definition">
         <parameter name="input">
            <typename name="documented_element_select"/>
         </parameter>
         <parameter name="role">
            <builtintype type="STRING"/>
         </parameter>
         <parameter name="type_name">
            <builtintype type="STRING"/>
         </parameter>
         <aggregate lower="0" type="SET" upper="?"/>
         <typename name="Document_definition"/>
         <algorithm>LOCAL
      dd : SET[0:?] OF Document_definition := [];  --this gives us access to the information base
      da : SET[0:?] OF Document_assignment :=[];
    END_LOCAL;
    da := bag_to_set(QUERY(dr &lt;* USEDIN (input, 'DOCUMENT_ASSIGNMENT_ARM.'+
	  'DOCUMENT_ASSIGNMENT.IS_ASSIGNED_TO') | (dr.role = role)));
    -- iterate over da
    REPEAT i := 1 to SIZEOF(da) by 1;
      IF(type_name IN TYPEOF (da[i].assigned_document))THEN
        dd := dd + da[i].assigned_document;
      END_IF;
    END_REPEAT;
    RETURN(dd);</algorithm>
      </function>
   </schema>
</express>
