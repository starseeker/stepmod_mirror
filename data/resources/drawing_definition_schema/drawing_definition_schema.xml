<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?xml-stylesheet type="text/xsl" href="../../../xsl/express.xsl"?>
<!DOCTYPE express SYSTEM "../../../dtd/express.dtd">

<express description.file="descriptions.xml" language_version="2" rcs.date="$Date$" rcs.revision="$Revision$" reference="ISO 10303-101">
   <application name="JSDAI" owner="LKSoft" source="drawing_definition_schema schema_instance" url="www.lksoft.com" version="4.0 beta"/>
   <schema name="drawing_definition_schema">
      <interface kind="reference" schema="support_resource_schema">
         <interfaced.item name="label"/>
         <interfaced.item name="text"/>
         <interfaced.item name="identifier"/>
         <interfaced.item name="bag_to_set"/>
      </interface>
      <interface kind="reference" schema="representation_schema">
         <interfaced.item name="mapped_item"/>
         <interfaced.item name="representation_relationship"/>
         <interfaced.item name="representation"/>
      </interface>
      <interface kind="reference" schema="presentation_organization_schema">
         <interfaced.item name="area_in_set"/>
         <interfaced.item name="presentation_area"/>
         <interfaced.item name="presentation_set"/>
         <interfaced.item name="presentation_representation_relationship"/>
      </interface>
      <type name="draughting_titled_item">
         <select selectitems="drawing_revision drawing_sheet_revision"/>
      </type>
      <entity name="draughting_title">
         <explicit name="items">
            <aggregate lower="1" type="SET" upper="?"/>
            <typename name="draughting_titled_item"/>
         </explicit>
         <explicit name="language">
            <typename name="label"/>
         </explicit>
         <explicit name="contents">
            <typename name="text"/>
         </explicit>
      </entity>
      <entity name="drawing_definition">
         <explicit name="drawing_number">
            <typename name="identifier"/>
         </explicit>
         <explicit name="drawing_type" optional="YES">
            <typename name="label"/>
         </explicit>
      </entity>
      <entity name="drawing_revision" supertypes="presentation_set">
         <explicit name="revision_identifier">
            <typename name="identifier"/>
         </explicit>
         <explicit name="drawing_identifier">
            <typename name="drawing_definition"/>
         </explicit>
         <explicit name="intended_scale" optional="YES">
            <typename name="text"/>
         </explicit>
         <unique label="UR1">
            <unique.attribute attribute="revision_identifier"/>
            <unique.attribute attribute="drawing_identifier"/>
         </unique>
      </entity>
      <entity name="drawing_revision_sequence">
         <explicit name="predecessor">
            <typename name="drawing_revision"/>
         </explicit>
         <explicit name="successor">
            <typename name="drawing_revision"/>
         </explicit>
         <where expression="predecessor :&lt;&gt;: successor" label="WR1"/>
      </entity>
      <entity name="drawing_sheet_revision" supertypes="presentation_area">
         <explicit name="revision_identifier">
            <typename name="identifier"/>
         </explicit>
         <where expression="SIZEOF( QUERY(item &lt;* SELF\representation.items |&#10;       ('REPRESENTATION_SCHEMA.MAPPED_ITEM' IN (TYPEOF(item)))&#10;       AND&#10;       ('DRAWING_DEFINITION_SCHEMA.DRAWING_SHEET_REVISION' IN&#10;       (TYPEOF(item\mapped_item.mapping_source.mapped_representation)))))=0" label="WR1"/>
      </entity>
      <entity name="drawing_sheet_revision_sequence" supertypes="representation_relationship">
         <where expression="SELF\representation_relationship.rep_1 :&lt;&gt;:                            &#10;       SELF\representation_relationship.rep_2" label="WR1"/>
         <where expression="'DRAWING_DEFINITION_SCHEMA.DRAWING_SHEET_REVISION'&#10;       IN TYPEOF (SELF\representation_relationship.rep_1)" label="WR2"/>
         <where expression="'DRAWING_DEFINITION_SCHEMA.DRAWING_SHEET_REVISION'&#10;       IN TYPEOF (SELF\representation_relationship.rep_2)" label="WR3"/>
      </entity>
      <entity name="drawing_sheet_revision_usage" supertypes="area_in_set">
         <explicit name="sheet_number">
            <typename name="identifier"/>
         </explicit>
         <unique label="UR1">
            <unique.attribute attribute="sheet_number"/>
            <unique.attribute attribute="SELF\area_in_set.in_set"/>
         </unique>
         <where expression="('DRAWING_DEFINITION_SCHEMA.DRAWING_SHEET_REVISION' IN &#10;                  TYPEOF(SELF\area_in_set.area)) &#10;              AND&#10;              ('DRAWING_DEFINITION_SCHEMA.DRAWING_REVISION' &#10;               IN TYPEOF (SELF\area_in_set.in_set))" label="WR1"/>
      </entity>
      <rule appliesto="presentation_representation_relationship" name="drawing_sheets_not_nested">
         <where expression="SIZEOF( QUERY(p_r_r &lt;* presentation_representation_relationship |      &#10;         ('DRAWING_DEFINITION_SCHEMA.DRAWING_SHEET_REVISION' &#10;        IN (TYPEOF(p_r_r.rep_1))) AND&#10;        ('DRAWING_DEFINITION_SCHEMA.DRAWING_SHEET_REVISION'&#10;        IN (TYPEOF( p_r_r.rep_2))))) = 0" label="WR1"/>
      </rule>
   </schema>
</express>
