<!-- $Id: build.xml,v 1.3 2004/10/05 20:38:01 joshualubell Exp $ -->

<!-- ================================================================

build.xml for STEPmod EXPRESS model specification

written by Josh Lubell, NIST                      
lubell@nist.gov                                   

For use with the Ant build tool, version 1.6.1 or higher
(http://ant.apache.org)

================================================================ -->

<project name="spec" default="html" basedir=".">

  <description>$Date: 2004/10/05 20:38:01 $</description>

  <target name="init" description="initialize variables">
    <tstamp/>
    <property name="TRANG" value="..\..\..\..\..\rng\trang.jar" />
    <property name="ROOTELEMENT" value="express" />
    <property name="OUTPUT" value="index"/>
    <property name="TEMPDOC" value="schemadoc"/>
  </target>

  <target name="antschema" depends="init" 
description="generate DTD and RELAX NG schema for editing Ant build file">
    <antstructure output="ant.dtd"/>
    <java jar="${TRANG}" fork="true">
      <arg line="ant.dtd ant.rnc"/>
    </java>
  </target>

  <target name="clean" depends="init" description="delete generated files">
    <delete>
      <fileset dir="." includes="*.rng, ${OUTPUT}.*, ${TEMPDOC}.xml"/>
    </delete>
  </target>

  <target name="rnc2rng" depends="init" description=
"generate XML syntax from EXPRESS model compact syntax RELAX NG schema">
    <java jar="${TRANG}" fork="true">
      <arg line="express_model.rnc express_model.rng"/>
    </java>
  </target>

  <target name="rng2docbook" depends="rnc2rng" 
	  description="generate DocBook section from RELAX NG">
    <xslt extension=".xml" in="express_model.rng" out="${TEMPDOC}.xml"
	  style="rngdoc.xsl">
      <param name="root" expression="${ROOTELEMENT}"/>
    </xslt>
  </target>

  <target name="merge" depends="rng2docbook" description=
	  "merge non-generated DocBook with generated DocBook section">
    <java classname="nu.xom.samples.XIncludeDriver" output="${OUTPUT}.xml">
      <arg value="express_model.xml"/>
    </java>
  </target>

  <target name="html" depends="merge" 
	  description="generate HTML from DocBook XML">
    <xslt extension=".html" in="${OUTPUT}.xml" out="${OUTPUT}.html"
	  style="express_model.xsl"/>
  </target>

</project>
