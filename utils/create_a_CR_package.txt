$Id: create_a_CR_package.txt,v 1.13 2015/06/03 16:17:21 thomasrthurman Exp $
provides detailed step by step instructions to build a CR and evaluate it.
[[!!do not commit any directory with "isopub" in the path!!]]
T. Thurman
--note that this process does NOT product pretty-printed EXPRESS because there is no AP publication involved.
--For the CR that is intended to product long forms that are pretty-printed additional steps are involved.

Step one:
Create a CR publication package
--update bugzilla for each bug that is addressed by this CR to change the bug
(a)- status/resolution to "resolved/fixed" and assign to hunten (use Gmail account!)
(b)- target milestone to this CR identifier

- execute make_CR.wsf
--that creates stepmod/publication/part1000/CR<NNN> and contents that includes
publication_index.xml
commit publication_index.xml
check out publication_index.xml

build.log
commit build.log
check out build.log

-add content to publication_index.xml.
<module number="1232" name="design_material_aspects" team="ap242" version="1" collector_bug="0000" />
	We have (description?, contacts, resource_docs?, deleted.resource_docs?, modules?, deleted.modules?, business_object_models?, deleted.business_object_models?)>
	see the dtd referenced by publication_index.xml for required format and sequence.
commit publication_index.xml to sourceforge.

-commit the source files for the JSDAI EXPRESS-G editor that was used to create this change request.
-a new directory has been created for this purpose:
-stepmod/data/tools/change_requests/JSDAI/CR12.
-A new directory based on change requests was chosen because it is impossible to disambiguate the JSDAI dictionary and EXPRESS-G files to an individual
-module or resource as the tool is currently used.

-for the initial trial, Kevin is to create and populate needed subdirectories under 
-stepmod/data/tools/change_requests/JSDAI/CR12
to validate that all required data including property files is committed to stepmod.

-ensure all your mods are committed to stepmod and you have tagged your mods with the right CR tag!
-to avoid conflicts, only tag data directories that are specified in the publication_index.xml
-update stepmod/repository_index.xml for new modules (tag with CR #)
stepmod/repository_index.xml
<resources>
<resource name="<schema_name>" part="<part_number>"/>
</resources>

<resource_docs>
    
    <resource_doc name="<resource name>"/>
    
  </resource_docs>
  
<modules>
<!-- bug nnnn -->
     <module name="scan_3d_data_shape" part="<part number value from convener>" project="AP242" status="in-development"/>
...
-Add 409, 410, 442 to CR
-get all meta-data numbers from convener (including 409, 410, 442)
-initialize local stepmod repo with "switch to another version" with latest published SMRL tag
-update each module or resource doc or resource directory that is included in the CR so as to include the changes proposed.
-(that is switch those specific directories to be updated with the CR with "switch to another version" with "your" CR tag!
<example: only one schema in part 42 is being updated so only one schema directory would be switched,
in addition to the part42 resource doc directory.>

-update bug #3347 Maintain record CVS tags used
====================================

Step two:
Create ARM/MIM EXPRESS and XML longforms for 409, 410, 442
--note that this process does NOT product pretty-printed EXPRESS because there is no AP publication involved.
--For the CR that is intended to product long forms that are pretty-printed additional steps are involved.
-use longform.jar, longform_arm.prop, longform_mim.prop, longform_edms.bat, longform.EDMscript (tailored to local environment and particular 4xx module).
-update concatenated_arm.exp, concatenated_mim.exp for 409, 410, 442
--409 concatenated_arm.exp, concatenated_mim.exp are in stepmod/data/modules/ap209.../dvlp
--410 concatenated_arm.exp, concatenated_mim.exp are in stepmod/data/modules/ap210_el*/dvlp/pmi
--442 concatenated_arm.exp, concatenated_mim.exp are in stepmod/data/modules/ap242_m*/dvlp/express/pmi
-execute shtolo using usual longform.EDMscript
-note that the diagnostic file in the example is the diagnostic for the concatenated file!!!! so the endings are not the same for the diagnostic and for the output .exp file
<example>:
Schemata>MakeLongForm(
"n:\concatenated_arm.exp",
"n:\electronic_assembly_interconnect_and_packaging_design_arm_sf.exp.dia",
Ap210_electronic_assembly_interconnect_and_packaging_design_arm,
"n:\electronic_assembly_interconnect_and_packaging_design_arm_lf.exp",
"REPLACE_SCHEMA_NAMES,REPLACE_SCHEMA_NAMES_REPORT,DIAGNOSTICS_FOR_ROOT_ONLY,DIAGNOSTICS_FOR_INTERFACED_ONLY,EXPRESS_EDITION_2,TC2,EDITION_1_LONGFORM")
'n:' is the location of the concatenated files.
</example>
-evaluate concatenated_arm.exp, concatenated_mim.exp for errors using the EDMS diagnostic report
-execute patches for bugs 
#4619, 
#4662 (content in #4661), 
#4665, 
#4667, 
#4668, 
#4820, 
#4904 comment #0, 
#4904 comment #2, 
#4978, 
#4988, 
#4992, 
#4994, 
#5004, 
#5018, 
#5019, 
#5023, 
#5048, 
#5051, 
#5052,  (is this still required? If not CR team should get Keith to mark the bug VERIFIED.)
#5053, (is this fix published? If so Keith shall mark the bug VERIFIED.)
#5054,
#5056,
#5057,
#5539.
-Commit concatenated_arm.exp, concatenated_mim.exp for 409, 410, 442
-Commit the six diagnostic files "n:\<schema_name>_sf.exp.dia": 
-execute longform EXPRESS evaluation using longform.EDMscript 'DefineSchema' command.
<example>:
Schemata>DefineSchema(
"n:\electronic_assembly_interconnect_and_packaging_design_arm_lf.exp",
"n:\electronic_assembly_interconnect_and_packaging_design_arm_lf.exp.dia",
Ap210_electronic_assembly_interconnect_and_packaging_design_arm, "STORING_SOURCE,DELETING_EXISTING_SCHEMAS,TC2")
'n:' is the location of the concatenated files.
</end_example>

-evaluate error report from longform.EDMscript
-Commit the six diagnostic files "n:\<schema_name>_lf.exp.dia": 
-copy and rename e.g., "n:\electronic_assembly_interconnect_and_packaging_design_arm_lf.exp" to stepmod/data/modules/ap210_el*/arm_lf.exp"
-do same for five other longform files.
-Commit arm_lf.exp, mim_lf.exp for 409, 410, 442.
-Create arm_lf.xml for 409, 410, 442.
-Create mim_lf.xml for 409, 410, 442.
====================================

Step three:
–Requires ANT and Java and Saxon 6.5.5
–Run: stepmod\utils\mkpart1000CR.wsf
fill in: "CR00NNN" to create a directory
-read the stepmod\publication\part1000\<CR00NNN>\readme.txt for some instructions.
•Add the docs to the publication
–Edit: stepmod\publication\part1000\<CR00NNN>\publication_index.xml
--get appropriate N numbers from Convener.
-reference stepmod\publication\part1000\CR00009\publication_index.xml for examples.
<for each module in the publication_index.xml>
 execute xslt against 
stepmod/data/modules/<module>/nav/mapping_view.xml
-replace mapping_view_with_test.xml with mapping_view.xml 5/28/2015 tt
-look for red marks.
-fix red marks.
</for>
-note: look to the XSLT in WG12 N8496 14.1 to extract the list of modules.
-note that now we should be able to include modules and resources in a CR build.
-create an empty log file: log.txt in stepmod\publication\part1000\<CR00NNN>\log.txt
•Build the ANT file
–Run: ant –buildfilebuildbuild
•Generate the HTML
–Run: ant all
–Generates: stepmod\publication\isopub\<CR00NNN>
-review the contents of the log.txt file for real errors due to missing modules in publication_index.xml
-or other errors
-commit the contents of stepmod\publication\part1000\<CR00NNN> to CVS.
[[!!do not commit any directory with "isopub" in the path!!]]
-review the content of stepmod\publication\isopub\<CR00NNN> for errors.
-fix errors until none.

retrieve last SMRL and put it somewhere.
copy the stepmod\publication\isopub\<CR00NNN> over the top of previous SMRL
====================================


Step four:
<for> each design ap build an ap publication package.
Run:stepmod\utils\mkpublication.wsf
fill in: "APNNN" to create a directory
–Edit: stepmod\publication\<APNNN>\publication_index.xml
-create an empty log file
stepmod\publication\<APNNN>\log.txt
•Build the ANT file
–Run: ant –buildfilebuildbuild
•Generate the HTML
<for each design AP>
–Run: ant all
–Generates: stepmod\publication\isopub\<APNNN>
commit the directory stepmod\publication\<APNNN>\ to CVS.
[[!!do not commit any directory with "isopub" in the path!!]]
-examine the log file for errors that need fixing.
-fix errors
merge the stepmod\publication\isopub\<APNNN> into the previous SMRL
(look to AP242 ed1 directory structure for details)
run linkcheck against the APNNN/index.htm
(I think it is ok to merge multiple APs for testing into one SMRL as they have isolated names)
verify the missing links are only ones related to old link for sc4 directory.
</for each design AP>.
====================================

Step five:
upload the modified multiple AP / SMRL directory as a zip file to WG12 drop-in box. Check with Convener for zip file name to use.
====================================

Step six:
Mark all related bugs as RESOLVED/FIXED and assign to Keith (ensure correct milestone!!).
====================================

Step seven:
Update bug #3361 update tag index with the tag for this CR.

